{"version":3,"file":"neep.core.js","sources":["../src/constant.ts","../src/EventEmitter.ts","../src/Error.ts","../src/install.ts","../src/register.ts","../src/symbols.ts","../src/create.ts","../src/components/lazy.ts","../src/auxiliary/tags.ts","../src/helper/current.ts","../src/helper/context.ts","../src/hook.ts","../src/auxiliary/life.ts","../src/auxiliary/element.ts","../src/helper/label.ts","../src/auxiliary/dev.ts","../src/auxiliary/index.ts","../src/render/id.ts","../src/render/recursive.ts","../src/render/draw.ts","../src/render/slot.ts","../src/render/props.ts","../src/render/normalize.ts","../src/render/refresh.ts","../src/render/Object.ts","../src/render/Entity.ts","../src/render/convert.ts","../src/render/Container.ts","../src/render/index.ts","../src/browser.ts"],"sourcesContent":["/**\n * Global constant\n *\n * Will be replaced by the 'rollup-plugin-replace' plug-in\n */\n\n /**\n * Neep code version\n */\nexport const version = '__VERSION__' as string;\n/**\n * Current mode\n * @enum production\n * @enum development\n */\nexport const mode = '__MODE__' as any as 'production' | 'development';\n/**\n * Is the current mode production mode\n * @description Support tree shaking\n */\nexport const isProduction = mode === 'production';\n","import { monitorable } from './install';\nimport { Emit, On } from './type';\n\nfunction getEventName(k: string): string {\n\tif (k[0] === '@') { return k.substr(1); }\n\tif (/^on[:-]/.test(k)) { return k.substr(3); }\n\tif (/^n([:-])on(\\1|:)/.test(k)) { return k.substr(5); }\n\treturn '';\n}\ninterface AddEvent<T extends Record<string, any[]>> {\n\t<N extends keyof T>(\n\t\tentName: N,\n\t\tlistener: (...p: T[N]) => void,\n\t): void\n}\n\nfunction addEventFromCollection(\n\taddEvent:(entName: string, listener: (...p: any) => void) => void,\n\tevents: any,\n) {\n\tif (!events) { return; }\n\tif (typeof events === 'function') {\n\t\tconst { names } = events as Emit;\n\t\tif (!Array.isArray(names)) { return; }\n\t\tfor (const n of names) {\n\t\t\tif (!n) { continue; }\n\t\t\taddEvent(n, (...p) => events(n, ...p));\n\t\t}\n\t\treturn;\n\t}\n\tif (typeof events !== 'object') { return; }\n\tfor (const k of Object.keys(events)) {\n\t\tconst f = events[k];\n\t\tif (typeof f !== 'function') { continue; }\n\t\taddEvent(k, f);\n\t}\n\n}\n\nexport default class EventEmitter<\n\tT extends Record<string, any[]> = Record<string, any[]>\n> {\n\tstatic update<T extends Record<string, any[]>>(\n\t\temitter: EventEmitter<T>,\n\t\tevents: any,\n\t): (() => void)[] {\n\t\tif (!events) { return []; }\n\t\tconst newHandles: (() => void)[] = [];\n\t\tif (events && typeof events === 'object') {\n\t\t\tfor (const n of Object.keys(events)) {\n\t\t\t\tif (!n) { continue; }\n\t\t\t\tconst fn = events[n];\n\t\t\t\tif (typeof fn !== 'function') { continue; }\n\t\t\t\tnewHandles.push(emitter.on(n, fn));\n\t\t\t}\n\t\t}\n\t\treturn newHandles;\n\t}\n\tstatic updateInProps<T extends Record<string, any[]>>(\n\t\temitter: EventEmitter<T>,\n\t\tprops: any,\n\t\tcustom?: (addEvent: AddEvent<T>) => void,\n\t): (() => void)[] {\n\t\tif (!props) { return []; }\n\t\n\t\tconst newHandles: (() => void)[] = [];\n\n\t\tfunction addEvent<N extends keyof T>(\n\t\t\tentName: N,\n\t\t\tlistener: (...p: T[N]) => void,\n\t\t): void {\n\t\t\tnewHandles.push(emitter.on(entName, listener));\n\t\t}\n\t\tfor (const k of Object.keys(props)) {\n\t\t\tconst fn = props[k];\n\t\t\tif (typeof fn !== 'function') { continue; }\n\t\t\tconst entName = getEventName(k);\n\t\t\tif (!entName) { continue; }\n\t\t\taddEvent(entName, fn);\n\t\t}\n\t\taddEventFromCollection(addEvent, props['@']);\n\t\taddEventFromCollection(addEvent, props['n:on']);\n\t\taddEventFromCollection(addEvent, props['n-on']);\n\t\tif (typeof custom === 'function') {\n\t\t\tcustom(addEvent);\n\t\t}\n\t\tnewHandles.push(...EventEmitter.update(emitter, props['@']));\n\t\treturn newHandles;\n\t}\n\n\tprivate _names: (keyof T)[] = [];\n\tprivate readonly _cancelHandles = new Set<() => void>();\n\tget names(): (keyof T)[] {\n\t\treturn this._names;\n\t}\n\treadonly emit: Emit<T>;\n\treadonly on: On<T>;\n\tconstructor() {\n\t\tconst events: Record<keyof T, Set<Function>> = Object.create(null);\n\t\tconst names = this._names;\n\n\t\tfunction createEmit(\n\t\t\t...omitNames: (string | number | symbol)[]\n\t\t): Emit<T> {\n\t\t\tfunction emit<N extends keyof T>(name: N, ...p: T[N]): void {\n\t\t\t\tconst event = events[name];\n\t\t\t\tif (!event) { return; }\n\t\t\t\tfor (const fn of [...event]) { \n\t\t\t\t\tfn(...p);\n\t\t\t\t}\n\t\t\t}\n\t\t\temit.omit = (...names: string[]) =>\n\t\t\t\tcreateEmit(...omitNames, ...names);\n\t\t\tReflect.defineProperty(emit, 'names', {\n\t\t\t\tget:() => {\n\t\t\t\t\tmonitorable.markRead(createEmit, 'names');\n\t\t\t\t\treturn names.filter(t => !omitNames.includes(t));\n\t\t\t\t},\n\t\t\t\tconfigurable: true,\n\t\t\t});\n\t\t\treturn emit as any as Emit<T>;\n\t\t};\n\t\tconst on: On<T> = (name, listener) => {\n\t\t\tconst fn = monitorable.safeify(listener);\n\t\t\tlet event = events[name];\n\t\t\tif (!event) {\n\t\t\t\tevent = new Set();\n\t\t\t\tevents[name] = event;\n\t\t\t\tmonitorable.markChange(createEmit, 'names');\n\t\t\t\tthis._names = [...this._names, name];\n\t\t\t}\n\t\t\tevent.add(fn);\n\t\t\tlet removed = false;\n\t\t\treturn () => {\n\t\t\t\tif (removed) { return; }\n\t\t\t\tremoved = true;\n\t\t\t\tevent.delete(fn);\n\t\t\t\tif (event.size) { return; }\n\t\t\t\tmonitorable.markChange(createEmit, 'names');\n\t\t\t\tthis._names = this._names.filter(n => n !== name);\n\t\t\t};\n\t\t};\n\t\tthis.emit = createEmit();\n\t\tthis.on = on;\n\t}\n\tupdateHandles(newHandles: (() => void)[]): (() => void)[] {\n\t\tconst eventCancelHandles = this._cancelHandles;\n\t\tconst oldHandles = [...eventCancelHandles];\n\t\teventCancelHandles.clear();\n\t\tfor (const fn of oldHandles) { fn(); }\n\t\tnewHandles.forEach(f => eventCancelHandles.add(f));\n\t\treturn newHandles;\n\t}\n\tupdate(list: any): (() => void)[] {\n\t\tconst handles = EventEmitter.update(this, list);\n\t\treturn this.updateHandles(handles);\n\t}\n\tupdateInProps(\n\t\tlist: any,\n\t\tcustom?: (addEvent: AddEvent<T>) => void,\n\t): (() => void)[] {\n\t\tconst handles = EventEmitter.updateInProps(this, list, custom);\n\t\treturn this.updateHandles(handles);\n\t}\n}\n","export default class NeepError extends Error {\n\treadonly tag: string;\n\tconstructor(message: string, tag: string = '') {\n\t\tsuper(tag ? `[${tag}] ${message}` : message);\n\t\tthis.tag = tag;\n\t}\n}\nexport function assert(v: any, message: string, tag?: string) {\n\tif (v) { return; }\n\tthrow new NeepError(message, tag);\n}\n","import * as monitorableApi from 'monitorable';\nimport { IRender } from './type';\nimport { isProduction } from './constant';\nimport EventEmitter from './EventEmitter';\nimport NeepError, { assert } from './Error';\n\nimport { Devtools } from '../../devtools/src/type';\n\nexport let monitorable: typeof monitorableApi;\n\nexport let value: typeof monitorableApi.value;\nexport let computed: typeof monitorableApi.computed;\nexport let isValue: typeof monitorableApi.isValue;\nexport let encase: typeof monitorableApi.encase;\nexport let recover: typeof monitorableApi.recover;\n\nfunction installMonitorable(api?: typeof monitorableApi) {\n\tif (!api) { return; }\n\tmonitorable = api;\n\tvalue = monitorable.value;\n\tcomputed = monitorable.computed;\n\tisValue = monitorable.isValue;\n\tencase = monitorable.encase;\n\trecover = monitorable.recover;\n}\n\nexport interface InstallOptions {\n\tmonitorable?: typeof monitorableApi;\n\trender?: IRender;\n\trenders?: IRender[];\n\tdevtools?: any;\n}\n\n\nlet nextFrameApi: undefined | ((fn: () => void) => void);\nexport function nextFrame(fn: () => void): void {\n\tassert(nextFrameApi, 'The basic renderer is not installed', 'install');\n\tnextFrameApi!(fn);\n}\n\nexport const renders: Record<string, IRender>\n\t= Object.create(null);\n\nexport function getRender(\n\ttype: string | number | IRender = ''\n\t): IRender {\n\tif (typeof type === 'object') { return type; }\n\treturn renders[type] || renders.default;\n}\n\nfunction addRender(render?: IRender): void {\n\tif (!render) { return; }\n\tif (render.install) {\n\t\trender.install({\n\t\t\tget isValue() { return isValue; },\n\t\t\tEventEmitter,\n\t\t\tError: NeepError,\n\t\t});\n\t}\n\trenders[render.type] = render;\n\tif (nextFrameApi) { return; }\n\tif (!renders.default) {\n\t\trenders.default = render;\n\t}\n\tif (!nextFrameApi && render.nextFrame) {\n\t\trenders.default = render;\n\t\tnextFrameApi = render.nextFrame;\n\t}\n\n}\nfunction installRender({ render, renders}: InstallOptions) {\n\taddRender(render);\n\tif (!Array.isArray(renders)) { return; }\n\tfor (const render of renders) {\n\t\taddRender(render);\n\t}\n}\n\n\nexport const devtools: Devtools = {\n\trenderHook(){},\n};\n\nfunction installDevtools(tools?: Partial<Devtools>) {\n\tif (!tools) { return; }\n\tif (typeof tools !== 'object') { return; }\n\tconst { renderHook } = tools;\n\tif (typeof renderHook === 'function') {\n\t\tdevtools.renderHook = renderHook;\n\t}\n}\n\n\nexport default function install(apis: InstallOptions) {\n\tinstallMonitorable(apis.monitorable);\n\tinstallRender(apis);\n\tif (!isProduction) {\n\t\tinstallDevtools(apis.devtools);\n\t}\n}\n","import { Component } from './type';\n\nexport const components: Record<string, Component> = Object.create(null);\n\nexport function register(name: string, component: Component) {\n\tcomponents[name] = component;\n}\n","export const isElementSymbol = Symbol.for('isNeepElement');\nexport const typeSymbol = Symbol.for('type');\nexport const nameSymbol = Symbol.for('name');\nexport const renderSymbol = Symbol.for('render');\nexport const componentsSymbol = Symbol.for('components');\nexport const configSymbol = Symbol.for('config');\n","import { Component, Render, Marks } from './type';\nimport { nameSymbol, typeSymbol, renderSymbol, componentsSymbol, configSymbol } from './symbols';\n\n/** 组件标记函数 */\nexport interface Mark {\n\t<N extends Component<any, any>>(component: N): N;\n}\n\n/** 创建组件标记函数 */\nfunction Mark<S extends keyof Marks>(\n\tsymbol: S,\n\tvalue: Component[S],\n): Mark {\n\treturn component => {\n\t\tcomponent[symbol] = value as any;\n\t\treturn component;\n\t};\n}\n/** 创建组件标记函数 */\nfunction MarkValue<S extends typeof componentsSymbol | typeof configSymbol>(\n\tsymbol: S,\n\tkey: keyof (NonNullable<Marks[typeof configSymbol]>),\n\tvalue: NonNullable<Marks[typeof componentsSymbol]>[typeof key],\n): Mark {\n\treturn component => {\n\t\tlet obj = component[symbol] as any;\n\t\tif (!obj) {\n\t\t\tobj = Object.create(null);\n\t\t\tcomponent[symbol] = obj;\n\t\t}\n\t\tobj[key] = value;\n\t\treturn component;\n\t};\n}\n\n\n/** 标记组件名称 */\nexport function mName(name: string): Mark;\nexport function mName<N extends Component<any, any>>(\n\tname: string,\n\tcomponent: N,\n): N;\nexport function mName<N extends Component<any, any>>(\n\tname: string,\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(nameSymbol, name); }\n\tcomponent[nameSymbol] = name;\n\treturn component;\n}\n\n/** 标记组件类型 */\nexport function mType(type?: 'native' | 'simple' | 'standard'): Mark;\nexport function mType<N extends Component<any, any>>(\n\ttype: 'native' | 'simple' | 'standard',\n\tcomponent: N,\n): N;\nexport function mType<N extends Component<any, any>>(\n\ttype?: 'native' | 'simple' | 'standard',\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(typeSymbol, type); }\n\tcomponent[typeSymbol] = type;\n\treturn component;\n}\n/** 标记为简单组件 */\nexport function mSimple(): Mark;\nexport function mSimple<N extends Component<any, any>>(\n\tcomponent: N,\n): N;\nexport function mSimple<N extends Component<any, any>>(\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(typeSymbol, 'simple'); }\n\tcomponent[typeSymbol] = 'simple';\n\treturn component;\n}\n/** 标记为原生组件 */\nexport function mNative(): Mark;\nexport function mNative<N extends Component<any, any>>(\n\tcomponent: N,\n): N;\nexport function mNative<N extends Component<any, any>>(\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(typeSymbol, 'native'); }\n\tcomponent[typeSymbol] = 'native';\n\treturn component;\n}\n\n/** 标记独立的渲染函数 */\nexport function mRender(fn?: Marks[typeof renderSymbol]): Mark;\nexport function mRender<N extends Component<any, any>>(\n\tfn: Marks[typeof renderSymbol] | undefined,\n\tcomponent: N,\n): N;\nexport function mRender<N extends Component<any, any>>(\n\tfn?: Marks[typeof renderSymbol] | undefined,\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(renderSymbol, fn); }\n\tcomponent[renderSymbol] = fn;\n\treturn component;\n}\n\n/** 标记组件类型 */\nexport function mConfig(name: string, config: any): Mark;\nexport function mConfig<N extends Component<any, any>>(\n\tname: string, config: any,\n\tcomponent: N,\n): N;\nexport function mConfig<N extends Component<any, any>>(\n\tname: string, config: any,\n\tcomponent?: N,\n): Mark | N {\n\tconst mark = MarkValue(configSymbol, name, config);\n\tif (!component) { return mark; }\n\treturn mark(component);\n}\n/** 标记组件类型 */\nexport function mComponent(name: string, item: Component): Mark;\nexport function mComponent<N extends Component<any, any>>(\n\tname: string, item: Component,\n\tcomponent: N,\n): N;\nexport function mComponent<N extends Component<any, any>>(\n\tname: string, item: Component,\n\tcomponent?: N,\n): Mark | N {\n\tconst mark = MarkValue(componentsSymbol, name, item);\n\tif (!component) { return mark; }\n\treturn mark(component);\n}\n\nexport function create<P extends object>(\n\tc: Component<P, never>,\n): Component<P, never>;\nexport function create<\n\tP extends object = object,\n\tR extends object = object,\n>(c: Component<P, R>, r: Render<R>): Component<P, R>;\nexport function create<T extends Component<any, any>>(\n\tc: T,\n\tr?: Render,\n): T {\n\tif (typeof r === 'function') {\n\t\tc[renderSymbol] = r;\n\t}\n\treturn c;\n}\n\nexport function mark<N extends Component<any, any>>(\n\tcomponent: N,\n\t...marks: Mark[]\n): N {\n\tfor (const m of marks) { m(component); }\n\treturn component;\n}\n","import { Component, Context } from '../type';\nimport { value } from '../install';\nimport { mSimple, mark, mName } from '../create';\nimport { Auxiliary } from '../auxiliary';\n\nexport default function lazy<\n\tP extends object = object,\n\tC extends Component<P, any> = Component<P, any>\n>(\n\tcomponent: () => Promise<C | { default: C }>,\n\tPlaceholder?: Component<{ loading: boolean }, any>,\n): Component<P> {\n\tconst reslut = value<0 | 1 | -1>(0);\n\tconst Component = value<undefined | C>(undefined);\n\tasync function load() {\n\t\tif (reslut()) { return; }\n\t\treslut(1);\n\t\ttry {\n\t\t\tconst c = await component();\n\t\t\tif (typeof c === 'function') {\n\t\t\t\tComponent(c);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!c) {\n\t\t\t\treslut(-1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (typeof c.default === 'function') {\n\t\t\t\tComponent(c.default);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treslut(-1);\n\t\t} catch {\n\t\t\treslut(-1);\n\t\t}\n\t}\n\tfunction Lazy(\n\t\tprops: P,\n\t\t{ childNodes }: Context,\n\t\t{ createElement }: Auxiliary,\n\t) {\n\t\tconst com = Component();\n\t\tif (com) { return createElement(com, props, ...childNodes); }\n\t\tload();\n\t\tif (!Placeholder) { return null; }\n\t\treturn createElement(Placeholder, { loading: reslut() > 0});\n\t}\n\treturn mark(Lazy, mSimple, mName('Lazy'));\n}\n","export const ScopeSlot = 'Neep:ScopeSlot';\nexport const SlotRender = 'Neep:SlotRender';\nexport const Slot = 'Neep:Slot';\nexport const Value = 'Neep:Value';\nexport const Container = 'Neep:Container';\nexport const Deliver = 'Neep:Deliver';\nexport const Template = 'template';\nexport const Fragment = Template;\n","import NeepError from '../Error';\nimport { Entity } from '../type';\n\n/** 当前正在执行的对象 */\nexport let current: Entity | undefined;\nexport function setCurrent<T>(\n\tfn: () => T,\n\tentity: Entity,\n): T {\n\tconst oldEntity = current;\n\tcurrent = entity;\n\ttry {\n\t\tcurrent.$_valueIndex = 0;\n\t\tconst ret = fn();\n\t\tif (current.$_valueIndex !== current.$_values.length) {\n\t\t\tthrow new NeepError(\n\t\t\t\t'Inconsistent number of useValue executions',\n\t\t\t\t'life',\n\t\t\t);\n\t\t}\n\t\treturn ret;\n\t} finally {\n\t\tcurrent = oldEntity;\n\t}\n}\n\nexport function checkCurrent(\n\tname: string,\n\tinitOnly = false,\n): Entity {\n\tif (!current) {\n\t\tthrow new NeepError(\n\t\t\t`Function \\`${name}\\` can only be called within a cycle.`,\n\t\t\t'life',\n\t\t);\n\t}\n\tif (!initOnly) {\n\t\treturn current;\n\t}\n\tif (!current.created) {\n\t\treturn current;\n\t}\n\tthrow new NeepError(\n\t\t`Function \\`${name}\\` can only be called at initialization time.`,\n\t\t'life',\n\t);\n}\n","import { Context, ContextConstructor, Exposed } from '../type';\nimport { monitorable } from '../install';\n\nconst constructors: ContextConstructor[] = [];\nexport function initContext(\n\tcontext: Context,\n\texposed?: Exposed,\n): Context {\n\tfor (const constructor of constructors) {\n\t\tconstructor(context, exposed);\n\t}\n\treturn context;\n}\nexport function addContextConstructor(\n\tconstructor: ContextConstructor\n): void {\n\tconstructors.push(monitorable.safeify(constructor));\n}\n","import { monitorable } from './install';\nimport { Hook, Hooks, Entity } from './type';\nconst hooks: Record<string, Set<Hook>> = Object.create(null);\n\nexport function setHook<H extends Hooks>(\n\tid: H,\n\thook: Hook,\n\tentity?: Entity,\n):() => void;\nexport function setHook(\n\tid: string,\n\thook: Hook,\n\tentity?: Entity,\n): () => void;\n\nexport function setHook(\n\tid: string,\n\thook: Hook,\n\tentity?: Entity,\n):() => void {\n\tlet list = entity?.$_hooks || hooks;\n\tif (!list) { return () => {}; }\n\thook = monitorable.safeify(hook);\n\tlet set = list[id];\n\tif (!set) {\n\t\tset = new Set();\n\t\tlist[id] = set;\n\t}\n\tset.add(hook);\n\treturn () => set.delete(hook);\n}\n\nexport function callHook<H extends Hooks>(\n\tid: H,\n\texposed: Entity,\n): void;\nexport function callHook(id: string, exposed: Entity): void;\nexport function callHook(id: string, exposed: Entity): void {\n\tif (!exposed) { return; }\n\tfor (const hook of exposed.$_hooks[id] || []) {\n\t\thook(exposed);\n\t}\n\tfor (const hook of hooks[id] || []) {\n\t\thook(exposed);\n\t}\n}\n","/**********************************\n * 组件上下文环境专用 API\n * @description 简单组件不支持\n **********************************/\nimport { Value, WatchCallback } from 'monitorable';\nimport { Hooks } from '../type';\nimport { checkCurrent } from '../helper';\nimport NeepError from '../Error';\nimport { setHook } from '../hook';\nimport { isValue, value, computed } from './state';\n\n\n/**********************************\n * 状态管理类 API\n **********************************/\n/**\n * 监听指定值的变化\n * @description 本质是调用 Value 对象的 watch 方法\n * @description 但是通过此方法进行的观察，会在组件生命周期结束时自动停止观察\n * @description 此函数只有在初始化调用时有效\n * @param value 被监听的值\n * @param cb    当监听的值发送变化时调用的函数\n */\nexport function watch<T>(\n\tvalue: Value<T>,\n\tcb: WatchCallback<T>,\n): () => void;\n/**\n * 监听指定值的变化\n * @description 本质是创建调用 Value 对象的 watch 方法\n * @description 但是通过此方法进行的观察，会在组件生命周期结束时自动停止观察\n * @description 此函数只有在初始化调用时有效\n * @param value 用于计算观测值的函数\n * @param cb    当监听的值发送变化时调用的函数\n */\nexport function watch<T>(\n\tvalue: () => T,\n\tcb: (v: T, stopped: boolean) => void,\n): () => void;\n\nexport function watch<T>(\n\tvalue: Value<T> | (() => T),\n\tcb: (v: Value<T> | T, stopped: boolean) => void\n): () => void {\n\tconst entity = checkCurrent('watch');\n\tif (typeof value !== 'function') { return () => {}; }\n\tconst stop = isValue(value)\n\t\t? value.watch(cb)\n\t\t: computed(value).watch((v, s) => cb(v(), s));\n\tsetHook('beforeDestroy', () => stop(), entity);\n\treturn stop;\n}\n\nexport function useValue(): Value<any>;\nexport function useValue<T>(fn: () => T, name?: string): T;\nexport function useValue<T>(fn?: () => T, name?: string): T | Value<any>;\nexport function useValue<T>(fn?: () => T, name = 'useValue'): T | Value<any> {\n\tconst entity = checkCurrent(name);\n\tconst index = entity.$_valueIndex++;\n\tconst values = entity.$_values;\n\tif (!entity.created) {\n\t\tvalues[index] = undefined;\n\t\tconst v = typeof fn === 'function' ? fn() : value(undefined);\n\t\treturn values[index] = v;\n\t}\n\tif (index >= values.length) {\n\t\tthrow new NeepError(\n\t\t\t'Inconsistent number of useValue executions',\n\t\t\t'life',\n\t\t);\n\t}\n\treturn values[index];\n\n}\n\n/**********************************\n * 钩子类 API\n **********************************/\n/**\n * 为当前组件注册钩子\n * @param name 钩子名称\n * @param hook 钩子\n * @param initOnly 是否仅在初始化时有效\n */\nexport function hook<H extends Hooks>(\n\tname: H,\n\thook: () => void,\n\tinitOnly?: boolean,\n): undefined | (() => void);\nexport function hook(\n\tname: string,\n\thook: () => void,\n\tinitOnly?: boolean,\n): undefined | (() => void);\nexport function hook(\n\tname: string,\n\thook: () => void,\n\tinitOnly?: boolean,\n): undefined | (() => void) {\n\tconst entity = checkCurrent('setHook');\n\tif (initOnly && entity.created) { return undefined; }\n\treturn setHook(name, () => hook(), entity);\n}\n\n/**********************************\n * 配置 API\n **********************************/\n\nfunction setValue<T>(\n\tobj: any,\n\tname: string | number | symbol,\n\tvalue: T | Value<T> | (() => T),\n\topt?: boolean | ((value: T) => void),\n): void {\n\tif (\n\t\ttypeof name === 'string'\n\t\t&& ['$', '_'].includes(name[0])\n\t) {\n\t\treturn;\n\t}\n\tif (isValue(value) && opt) {\n\t\tReflect.defineProperty(obj, name, {\n\t\t\tget() { return value(); },\n\t\t\tset(v) { value(v); },\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t});\n\t\treturn;\n\t}\n\tif (typeof value === 'function' && opt) {\n\t\tReflect.defineProperty(obj, name, {\n\t\t\tget: value as () => T,\n\t\t\tset: typeof opt === 'function' ? opt : undefined,\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t});\n\t\treturn;\n\t}\n\tReflect.defineProperty(obj, name, {\n\t\tget() { return value; },\n\t\tconfigurable: true,\n\t\tenumerable: true,\n\t});\n}\n\n\n/**\n * 将 Value 导出\n * @param name 导出用的名称\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tvalue: Value<T>,\n\tmix?: boolean,\n): void;\n/**\n * 将普通值导出\n * @param name\n * @param value\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tvalue: T,\n): void;\n/**\n * 设置基于 getter 的导出\n * @param name\n * @param getter\n * @param nonModifiable\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tnonModifiable: true,\n): void;\n/**\n * 设置基于 getter/setter 的导出\n * @param name\n * @param getter\n * @param setter\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tsetter: (value: T) => void,\n): void;\nexport function expose<T>(\n\tname: string | number | symbol,\n\tvalue: T | Value<T> | (() => T),\n\topt?: boolean | ((value: T) => void),\n): void {\n\tsetValue(checkCurrent('expose', true).exposed, name, value, opt);\n}\n\n\n/**\n * 将 Value 传递给子组件\n * @param name 导出用的名称\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tvalue: Value<T>,\n\tmix?: boolean,\n): void;\n/**\n * 将普通值导出\n * @param name\n * @param value\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tvalue: T,\n): void;\n/**\n * 设置基于 getter 的传递\n * @param name\n * @param getter\n * @param nonModifiable\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tnonModifiable: true,\n): void;\n/**\n * 设置基于 getter/setter 的传递\n * @param name\n * @param getter\n * @param setter\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tsetter: (value: T) => void,\n): void;\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tvalue: T | Value<T> | (() => T),\n\topt?: boolean | ((value: T) => void),\n): void {\n\tsetValue(checkCurrent('deliver', true).delivered, name, value, opt);\n}\n","import { Tag, NeepElement, Component } from '../type';\nimport { isElementSymbol, typeSymbol } from '../symbols';\nimport * as Tags from './tags';\n\n/**\n * 判读是否为元素\n */\nexport function isElement(v: any): v is NeepElement {\n\tif (!v) { return false; }\n\tif (typeof v !== 'object') { return false; }\n\treturn v[isElementSymbol] === true;\n}\n\nexport function createElement(\n\ttag: Tag,\n\tattrs?: {[key:string]: any},\n\t...children: any[]\n): NeepElement {\n\tattrs = attrs ? {...attrs} : {};\n\tconst node: NeepElement = {\n\t\t[isElementSymbol]: true,\n\t\ttag,\n\t\tchildren: [],\n\t};\n\tif ('key' in attrs) { node.key = attrs.key; }\n\tif ('slot' in attrs) { node.slot = attrs.slot; }\n\tif (typeof attrs.ref === 'function') { node.ref = attrs.ref; }\n\tif (tag === Tags.Value) {\n\t\tnode.value = attrs.value;\n\t\treturn node;\n\t}\n\tnode.children = children;\n\tif (tag === Tags.Template) { return node; }\n\tif (tag === Tags.SlotRender) {\n\t\tnode.render = attrs.render;\n\t\treturn node;\n\t}\n\tif (tag === Tags.ScopeSlot || tag === Tags.Slot) {\n\t\tconst { render, argv, args, name } = attrs;\n\t\tnode.render = render;\n\t\tnode.args = argv && [argv]\n\t\t\t|| Array.isArray(args) && args.length && args\n\t\t\t|| [{}];\n\n\t\tif (tag === Tags.ScopeSlot) {\n\t\t\tnode.props = { name };\n\t\t\treturn node;\n\t\t}\n\t}\n\tnode.props = {};\n\tfor (let k in attrs) {\n\t\tnode.props[k] = attrs[k];\n\t}\n\treturn node;\n}\n\nexport interface elementIteratorOptions {\n\tsimple?: boolean | Component[] | ((c: Component) => boolean);\n}\n\nexport function elements(\n\tnode: any,\n\topt: elementIteratorOptions = {},\n): any[] {\n\tif (Array.isArray(node)) {\n\t\tconst list: any[][] = [];\n\t\tfor (let n of node) {\n\t\t\tlist.push(elements(n, opt));\n\t\t}\n\t\treturn ([] as any[]).concat(...list);\n\t}\n\tif (!isElement(node)) { return [node]; }\n\tlet { tag } = node;\n\tif (!tag) { return []; }\n\n\tif (([Tags.Template, Tags.ScopeSlot] as Tag[]).includes(tag)) {\n\t\treturn elements(node.children, opt);\n\t}\n\tif (typeof tag !== 'function') { return [node]; }\n\tif (tag[typeSymbol] !== 'simple') { return [node]; }\n\tconst { simple } = opt;\n\tif (!simple) { return [node]; }\n\tif (Array.isArray(simple)) {\n\t\tif (simple.includes(tag)) { return [node]; }\n\t} else if (typeof simple === 'function') {\n\t\tif (!simple(tag)) { return [node]; }\n\t}\n\treturn elements(node.children, opt);\n}\n","let label: [string, string] | undefined;\nexport function setLabel(l: [string, string]) {\n\tlabel = l;\n}\n\nexport function getLabel() {\n\tconst l = label;\n\tlabel = undefined;\n\treturn l;\n}\n","import { isProduction } from '../constant';\nimport { current } from '../helper';\nimport { setLabel } from '../helper/label';\n\nexport function label(text: string, color = ''): void {\n\tif (!isProduction) {\n\t\tif (!current) {\n\t\t\tsetLabel([text, color]);\n\t\t\treturn;\n\t\t}\n\t\tReflect.defineProperty(current.exposed, '$label', {\n\t\t\tvalue: [text, color],\n\t\t\tconfigurable: true,\n\t\t});\n\t}\n}\n","import * as Constant from '../constant';\nimport * as Tags from './tags';\nimport * as State from './state';\nimport * as Life from './life';\nimport * as Element from './element';\nimport * as Dev from './dev';\n\nexport * from './tags';\nexport * from './state';\nexport * from './life';\nexport * from './element';\nexport * from './dev';\n\nexport { Tags };\n\n/** 辅助 */\nexport interface Auxiliary extends\n\tReadonly<typeof Tags>,\n\tReadonly<typeof State>,\n\tReadonly<typeof Life>,\n\tReadonly<typeof Element>,\n\tReadonly<typeof Dev>,\n\tReadonly<typeof Constant>\n{}\n\nconst auxiliary: Auxiliary = {\n\t...Tags,\n\t...Life,\n\t...Element,\n\t...Dev,\n\t...Constant,\n\tget value() { return State.value; },\n\tget computed() { return State.computed; },\n\tget isValue() { return State.isValue; },\n\tget encase() { return State.encase; },\n\tget recover() { return State.recover; },\n};\n\nexport function setAuxiliary<T>(\n\tname: string,\n\tvalue: T,\n): void {\n\tReflect.defineProperty(auxiliary, name, {\n\t\tvalue,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n}\nexport function defineAuxiliary<T>(\n\tname: string,\n\tget: (this: Auxiliary) => T,\n): void {\n\tReflect.defineProperty(auxiliary, name, {\n\t\tget,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n}\nexport default auxiliary;\n","import { NativeNode } from '../type';\nimport { isProduction } from '../constant';\nimport { MountedNode } from './draw';\n\nlet ids = 0;\nconst Nodes: {[key: number]: MountedNode} = {};\nlet IdMap: undefined | Map<NativeNode, number>;\nif (!isProduction) {\n\tIdMap = new Map();\n}\nexport function createMountedNode(\n\tn: Omit<MountedNode, 'id'>,\n\tid?: number,\n): MountedNode {\n\tif (!isProduction) {\n\t\tid = id || ++ids;\n\t\tconst { node } = n;\n\t\tif (node && IdMap) { IdMap.set(node, id); }\n\t\treturn Nodes[id] = {...n, id};\n\t}\n\treturn {...n, id: 0};\n}\n\nexport function recoveryMountedNode(node: MountedNode): void {\n\tif (!isProduction) {\n\t\tdelete Nodes[node.id];\n\t}\n}\n\nexport function getNode(\n\tid: number | NativeNode,\n): MountedNode | undefined {\n\tif (!isProduction) {\n\t\tif (typeof id !== 'number') {\n\t\t\tid = IdMap?.get(id) || -1;\n\t\t}\n\t\treturn Nodes[id];\n\t}\n\treturn undefined;\n}\n","export interface RecursiveArray<T> extends Array<RecursiveItem<T>>{};\nexport type RecursiveItem<T> = T | RecursiveArray<T>;\n\nexport function *recursive2iterable<T>(\n\tlist: RecursiveItem<T>,\n): Iterable<T> {\n\tif (!Array.isArray(list)) {\n\t\tyield list;\n\t\treturn;\n\t}\n\tfor (const it of list) {\n\t\tyield* recursive2iterable(it);\n\t}\n}\n","import { Tags, Template, isValue } from '../auxiliary';\nimport { IRender, NativeNode, NativeElement, Exposed, Ref } from '../type';\nimport { createMountedNode, recoveryMountedNode } from './id';\nimport { TreeNode } from './convert';\n\n/**\n * @description node / component / children 至少一个有效\n */\nexport interface MountedNode extends TreeNode {\n\tid: number;\n\tparent?: this;\n\tnode: undefined | NativeNode;\n}\n\nlet refList: (() => void)[] | undefined;\nexport function setRefList(list?: (() => void)[]) {\n\trefList = list;\n}\nfunction setRef(\n\tref?: Ref,\n\tnode?: Exposed | NativeNode,\n\tisRemove?: boolean,\n) {\n\tif (typeof ref !== 'function') { return; }\n\tif (!node) { return; }\n\tif (!refList) {\n\t\tref(node, isRemove);\n\t} else {\n\t\trefList.push(() => ref(node, isRemove));\n\t}\n}\n\ntype MountedNodes = MountedNode | MountedNode[]\n\t| (MountedNode | MountedNode[])[];\n\nfunction getLastNode(tree: MountedNodes): NativeNode {\n\tif (Array.isArray(tree)) {\n\t\treturn getLastNode(tree[tree.length - 1]);\n\t}\n\tconst { component, children, node } = tree;\n\tif (node) { return node; }\n\tif (component) { return getLastNode(component.tree); }\n\treturn getLastNode(children);\n}\n\nfunction getFirstNode(tree: MountedNodes): NativeNode {\n\tif (Array.isArray(tree)) { return getFirstNode(tree[0]); }\n\tconst { component, children, node } = tree;\n\tif (node) { return node; }\n\tif (component) { return getFirstNode(component.tree); }\n\treturn getFirstNode(children[0]);\n}\n\nexport function *getNodes(tree: MountedNodes): Iterable<NativeNode> {\n\tif (Array.isArray(tree)) {\n\t\tfor (const it of tree) {\n\t\t\tyield* getNodes(it);\n\t\t}\n\t\treturn;\n\t}\n\tconst { children, node, component } = tree;\n\tif (node) {\n\t\tyield node;\n\t\treturn;\n\t}\n\tif (component) {\n\t\tyield* getNodes(component.tree);\n\t\treturn;\n\t}\n\tyield* getNodes(children);\n}\n\nexport function unmount(iRender: IRender, tree: MountedNodes): void {\n\tif (Array.isArray(tree)) {\n\t\ttree.forEach(e => unmount(iRender, e));\n\t\treturn;\n\t}\n\tconst { component, children, node, ref } = tree;\n\trecoveryMountedNode(tree);\n\tif (node) {\n\t\tsetRef(ref, node, true);\n\t\tiRender.remove(node);\n\t\treturn;\n\t}\n\tif (component) {\n\t\tsetRef(ref, component.exposed, true);\n\t\tcomponent.unmount();\n\t\treturn;\n\t}\n\tunmount(iRender, children);\n}\n\n\nfunction replace<T extends MountedNode | MountedNode[]>(\n\tiRender: IRender,\n\tnewTree: T,\n\toldTree: MountedNode | MountedNode[],\n): T {\n\tconst next = getFirstNode(oldTree);\n\tif (!next) { return newTree; }\n\tconst parent = iRender.parent(next);\n\tif (!parent) { return newTree; }\n\tfor (const it of getNodes(newTree)) {\n\t\tiRender.insert(parent, it, next);\n\t}\n\tunmount(iRender, oldTree);\n\treturn newTree;\n}\n\nfunction updateList(\n\tiRender: IRender,\n\tsource: TreeNode[],\n\ttree: MountedNode | MountedNode[],\n): MountedNode[] {\n\tif (!source.length) {\n\t\tconst node = createItem(iRender, {tag: null, children: []});\n\t\treturn [replace(iRender, node, tree)];\n\t}\n\tif (!Array.isArray(tree)) { tree = [tree]; }\n\tconst newList: MountedNode[] = [];\n\tconst list = [...tree];\n\tconst mountedMap = new Map<MountedNode, MountedNode>();\n\tfor (const src of source) {\n\t\tconst index = list.findIndex(it =>\n\t\t\tit.tag === src.tag && it.key === src.key\n\t\t);\n\t\tif (index >= 0) {\n\t\t\tconst old = list[index];\n\t\t\tconst item = updateItem(iRender, src, old);\n\t\t\tmountedMap.set(old, item);\n\t\t\tnewList.push(item);\n\t\t\tlist.splice(index, 1);\n\t\t} else {\n\t\t\tconst item = createItem(iRender, src);\n\t\t\tnewList.push(item);\n\t\t}\n\t}\n\tif (!mountedMap.size) {\n\t\treturn replace(iRender, newList, list);\n\t}\n\tunmount(iRender, list);\n\ttree = tree.filter(t => mountedMap.has(t));\n\tconst last = getLastNode(tree[tree.length - 1]);\n\tconst parent = iRender.parent(last);\n\tif (!parent) { return newList; }\n\tlet next = iRender.next(last);\n\t// 调整次序\n\tfor(let i = newList.length - 1; i >= 0; i--) {\n\t\tconst item = newList[i];\n\t\tconst index = tree.findIndex(o => mountedMap.get(o) === item);\n\t\tif (index >= 0) {\n\t\t\tfor (const it of tree.splice(index)) {\n\t\t\t\tmountedMap.delete(it);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const it of getNodes(item)) {\n\t\t\t\tiRender.insert(parent, it, next);\n\t\t\t}\n\t\t}\n\t\tnext = getFirstNode(item) || next;\n\t}\n\treturn newList;\n}\n/**\n * 更新树\n * @param tree 已有树\n * @param source 用于替换的源\n * @param iRender Neep 对象\n */\nfunction updateAll(\n\tiRender: IRender,\n\tsource: (TreeNode | TreeNode[])[],\n\ttree: (MountedNode | MountedNode[])[],\n): (MountedNode | MountedNode[])[] {\n\tlet index = 0;\n\tlet length = Math.min(source.length, source.length || 1);\n\tconst list: (MountedNode | MountedNode[])[] = [];\n\tfor (; index < length; index++) {\n\t\tconst src = source[index];\n\t\tif (Array.isArray(src)) {\n\t\t\tlist.push(updateList(iRender, src, tree[index]));\n\t\t} else {\n\t\t\tlist.push(updateItem(iRender, src, tree[index]));\n\t\t}\n\t}\n\tlength = Math.max(source.length, tree.length);\n\tif (tree.length > length) {\n\t\t\t// 销毁多余项\n\t\t\tfor (; index < length; index++) {\n\t\t\tunmount(iRender, tree[index]);\n\t\t}\n\t}\n\tif (source.length > length) {\n\t\t// 创建多余项\n\t\tconst last = getLastNode(list[list.length - 1]);\n\t\tconst parent = iRender.parent(last);\n\t\tconst next = iRender.next(last);\n\t\tfor (; index < length; index++) {\n\t\t\tconst src = source[index];\n\t\t\tconst item = Array.isArray(src)\n\t\t\t\t? createList(iRender, src)\n\t\t\t\t: createItem(iRender, src);\n\t\t\tlist.push(item);\n\t\t\tif (!parent) { continue; }\n\t\t\tfor (const it of getNodes(item)) {\n\t\t\t\tiRender.insert(parent, it, next);\n\t\t\t}\n\t\t}\n\t}\n\treturn list;\n}\n\n/**\n * 更新树节点\n * @param iRender Neep 对象\n * @param tree 已有树\n * @param source 用于替换的源\n */\nfunction updateItem(\n\tiRender: IRender,\n\tsource: TreeNode,\n\ttree: MountedNode | MountedNode[],\n): MountedNode {\n\tif (Array.isArray(tree)) {\n\t\tconst index = tree.findIndex(it =>\n\t\t\tit.tag === source.tag && it.component === source.component\n\t\t);\n\t\tif (index < 0) {\n\t\t\treturn replace(iRender, createItem(iRender, source), tree);\n\t\t}\n\t\tconst all = tree;\n\t\t[tree] = tree.splice(index, 1);\n\t\tunmount(iRender, all);\n\t}\n\tconst { tag, component } = source;\n\tconst ref = source.ref !== tree.ref && source.ref || undefined;\n\tif (tag !== tree.tag || component !== tree.component) {\n\t\treturn replace(iRender, createItem(iRender, source), tree);\n\t}\n\tif (!tag) { return tree; }\n\tif (typeof tag !== 'string' || tag === Tags.Container) {\n\t\tif (!component) {\n\t\t\t// TODO: ref\n\t\t\treturn createMountedNode({\n\t\t\t\t...source,\n\t\t\t\tnode: undefined,\n\t\t\t\tcomponent: undefined,\n\t\t\t\tchildren: draw(\n\t\t\t\t\tiRender,\n\t\t\t\t\tsource.children,\n\t\t\t\t\ttree.children,\n\t\t\t\t),\n\t\t\t}, tree.id);\n\t\t}\n\t\tsetRef(ref, component.exposed);\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent,\n\t\t\tchildren: [],\n\t\t}, tree.id);\n\t}\n\tif (tag === Tags.Value) {\n\t\tlet value = source.value;\n\t\tif (isValue(value)) { value = value(); }\n\t\tif(tree.value === value) {\n\t\t\tsetRef(ref, tree.node);\n\t\t\treturn createMountedNode({\n\t\t\t\t...tree,\n\t\t\t\t...source,\n\t\t\t\tvalue,\n\t\t\t\tchildren: [],\n\t\t\t}, tree.id);\n\t\t}\n\t\treturn replace(iRender, createValue(iRender, source, value), tree);\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\t// TODO: ref\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent: undefined,\n\t\t\tchildren: updateAll(\n\t\t\t\tiRender,\n\t\t\t\tsource.children,\n\t\t\t\ttree.children,\n\t\t\t),\n\t\t}, tree.id);\n\t}\n\tconst { node } = tree;\n\tiRender.update(\n\t\tnode as NativeElement,\n\t\tsource.props || {},\n\t);\n\tsetRef(ref, node);\n\tif (!source.children.length && !tree.children.length) {\n\t\treturn createMountedNode(\n\t\t\t{\n\t\t\t\t...tree,\n\t\t\t\t...source,\n\t\t\t\tchildren: [],\n\t\t\t},\n\t\t\ttree.id);\n\t}\n\tif (!source.children.length && tree.children.length) {\n\t\tunmount(iRender, tree.children);\n\t}\n\tif (source.children.length && !tree.children.length) {\n\t\tconst children = createAll(iRender, source.children);\n\t\tfor (const it of getNodes(children)) {\n\t\t\tiRender.insert(node as NativeElement, it);\n\t\t}\n\t\treturn createMountedNode({\n\t\t\t...tree,\n\t\t\t...source,\n\t\t\tchildren,\n\t\t}, tree.id);\n\t}\n\treturn createMountedNode({\n\t\t...tree, ...source,\n\t\tchildren: updateAll(\n\t\t\tiRender,\n\t\t\tsource.children,\n\t\t\ttree.children,\n\t\t),\n\t}, tree.id);\n}\n\nfunction createValue(\n\tiRender: IRender,\n\tsource: TreeNode,\n\tvalue: any,\n): MountedNode {\n\tlet { ref } = source;\n\tif (iRender.isNode(value)) {\n\t\tsetRef(ref, value);\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tvalue,\n\t\t\tnode: value,\n\t\t\tchildren: [],\n\t\t\tcomponent: undefined,\n\t\t});\n\t}\n\tconst type = typeof value;\n\tlet node: NativeNode | undefined;\n\tif (\n\t\ttype === 'bigint'\n\t\t|| type === 'boolean'\n\t\t|| type === 'number'\n\t\t|| type === 'string'\n\t\t|| type === 'symbol'\n\t\t|| value instanceof RegExp\n\t) {\n\t\tnode = iRender.text(String(value));\n\t} else if (value instanceof Date) {\n\t\tnode = iRender.text(value.toISOString());\n\t} else if (type === 'object' && value) {\n\t\tnode = iRender.text(String(value));\n\t\t// TODO: 对象处理\n\t}\n\tif (!node) { node = iRender.placeholder(); }\n\tsetRef(ref, node);\n\treturn createMountedNode({\n\t\t...source,\n\t\tvalue,\n\t\tnode,\n\t\tcomponent: undefined,\n\t\tchildren: [],\n\t});\n}\n\nfunction createAll(\n\tiRender: IRender,\n\tsource: (TreeNode | TreeNode[])[],\n): (MountedNode | MountedNode[])[] {\n\tif (!source.length) {\n\t\treturn [createMountedNode({\n\t\t\ttag: null,\n\t\t\tnode: iRender.placeholder(),\n\t\t\tcomponent: undefined,\n\t\t\tchildren: [],\n\t\t})];\n\t}\n\n\treturn source.map(item =>\n\t\tArray.isArray(item)\n\t\t\t? createList(iRender, item)\n\t\t\t: createItem(iRender, item)\n\t);\n}\n\nfunction createList(\n\tiRender: IRender,\n\tsource: TreeNode[],\n): MountedNode[] {\n\tif (source.length) {\n\t\treturn source.map(it => createItem(iRender, it));\n\t}\n\treturn [createMountedNode({\n\t\ttag: null,\n\t\tnode: iRender.placeholder(),\n\t\tcomponent: undefined,\n\t\tchildren: [],\n\t})];\n}\n\nfunction createItem(\n\tiRender: IRender,\n\tsource: TreeNode,\n): MountedNode {\n\tconst { tag, ref, component } = source;\n\tif (!tag) {\n\t\tconst node = iRender.placeholder();\n\t\tsetRef(ref, node);\n\t\treturn createMountedNode({\n\t\t\ttag: null,\n\t\t\tnode,\n\t\t\tcomponent: undefined,\n\t\t\tchildren: [],\n\t\t});\n\t}\n\tif (typeof tag !== 'string' || tag === Tags.Container) {\n\t\tif (!component) {\n\t\t\t// TODO: ref\n\t\t\treturn createMountedNode({\n\t\t\t\t...source,\n\t\t\t\tnode: undefined,\n\t\t\t\tcomponent: undefined,\n\t\t\t\tchildren: draw(iRender, source.children),\n\t\t\t});\n\t\t}\n\t\tcomponent.mount();\n\t\tsetRef(ref, component.exposed);\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent, children: [],\n\t\t});\n\t}\n\tif (tag === Tags.Value) {\n\t\tlet value = source.value;\n\t\tif (isValue(value)) { value = value(); }\n\t\treturn createValue(iRender, source, value);\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\t// TODO: ref\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent: undefined,\n\t\t\tchildren: createAll(iRender, source.children),\n\t\t});\n\t}\n\tconst node = iRender.create(tag, source.props || {});\n\tsetRef(ref, node);\n\tlet children: (MountedNode | MountedNode[])[] = [];\n\tif (source.children?.length) {\n\t\tchildren = createAll(iRender, source.children);\n\t\tfor (const it of getNodes(children)) {\n\t\t\tiRender.insert(node, it);\n\t\t}\n\t}\n\treturn createMountedNode({\n\t\t...source,\n\t\tnode,\n\t\tcomponent: undefined,\n\t\tchildren,\n\t});\n}\n\nexport default function draw(\n\tiRender: IRender,\n\tsource: (TreeNode | TreeNode[])[],\n\ttree?: (MountedNode | MountedNode[])[],\n): (MountedNode | MountedNode[])[] {\n\tif (tree) {\n\t\treturn updateAll(iRender, source, tree);\n\t}\n\treturn createAll(iRender, source);\n}\n","import { NeepElement, SlotFn, Slots, IRender } from '../type';\nimport { isElement, SlotRender, ScopeSlot } from '../auxiliary';\nimport { isElementSymbol } from '../symbols';\nimport { isProduction } from '../constant';\n\n\nexport function getSlots(\n\tiRender: IRender,\n\tchildren: any[],\n\tslots: Record<string | symbol, any[]>,\n\tnative = false,\n): any[] {\n\t/** 原始对象 */\n\tconst nativeList: any[] = [];\n\tfor (const it of children) {\n\t\tif (Array.isArray(it)) {\n\t\t\tconst list: Record<string | symbol, any[]>\n\t\t\t\t= Object.create(null);\n\t\t\tnativeList.push(getSlots(iRender, it, list, native));\n\t\t\tfor (const k of Reflect.ownKeys(list) as string[]) {\n\t\t\t\tif (k in slots) {\n\t\t\t\t\tslots[k].push(list[k]);\n\t\t\t\t} else {\n\t\t\t\t\tslots[k] = [list[k]];\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (native) {\n\t\t\tif (iRender.isNode(it)) {\n\t\t\t\tnativeList.push(it);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!isElement(it)) {\n\t\t\t\tnativeList.push(it);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (it.tag !== SlotRender) {\n\t\t\t\tnativeList.push(it);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tconst slot = isElement(it) && it.slot || 'default';\n\t\tconst el = isElement(it) ? {\n\t\t\t...it, slot: undefined,\n\t\t\tprops: {...it.props, slot: undefined },\n\t\t} : it;\n\t\tif (slot in slots) {\n\t\t\tslots[slot].push(el);\n\t\t} else {\n\t\t\tslots[slot] = [el];\n\t\t}\n\t}\n\treturn nativeList;\n}\nfunction renderSlots(\n\tlist: any[],\n\t...props: any\n): any[] {\n\treturn list.map(it => {\n\t\tif (Array.isArray(it)) {\n\t\t\treturn renderSlots(it, ...props);\n\t\t}\n\t\tif (!isElement(it)) { return it; }\n\t\tif (it.tag !== SlotRender) {\n\t\t\treturn {\n\t\t\t\t...it,\n\t\t\t\tslot: undefined,\n\t\t\t} as NeepElement;\n\t\t}\n\t\tif (typeof it.render === 'function') {\n\t\t\treturn it.render(...props);\n\t\t}\n\t\treturn it.children;\n\t});\n}\nfunction createSlots(\n\tname: string,\n\tlist: any[],\n): SlotFn {\n\tconst slot = (...props: any) => ({\n\t\t[isElementSymbol]: true,\n\t\ttag: ScopeSlot,\n\t\tchildren: renderSlots(list, ...props),\n\t\tinserted: true,\n\t\tlabel: isProduction ? undefined : [`[${name}]`, '#00F'],\n\t} as NeepElement);\n\tslot.children = list;\n\treturn slot;\n}\nexport function setSlots(\n\tchildren: {[key: string]: any[]},\n\tslots: Slots = Object.create(null),\n) {\n\tfor (const k of Reflect.ownKeys(slots)) {\n\t\tif (!(k in children)) {\n\t\t\tdelete slots[k as string];\n\t\t}\n\t}\n\tfor (const k of Reflect.ownKeys(children) as string[]) {\n\t\tslots[k] = createSlots(k, children[k]);\n\t}\n\treturn slots;\n}\n","import { isValue } from '../auxiliary';\nconst disabledKey = new Set([\n\t':', '@', '#', '*',\n\t'!', '%', '^', '~',\n\t'&', '=', '+', '.',\n\t'(', ')', '[', ']', '{', '}', '<', '>',\n]);\nfunction filter(k: string | number | symbol) {\n\tif (typeof k !== 'string') { return true; }\n\tif (disabledKey.has(k[0])) { return false; }\n\tif (/^n[:-]/.test(k)) { return false; }\n\tif (/^on[:-]/.test(k)) { return false; }\n\treturn true;\n}\nexport function updateProps(\n\tobj: any,\n\tprops: any,\n\toldProps: any = {},\n\tdefine = false,\n\tisProps = false,\n) {\n\tconst keys = Reflect.ownKeys(props);\n\tconst newKeys = new Set(isProps ? keys.filter(filter) : keys);\n\tfor (const k of Reflect.ownKeys(obj)) {\n\t\tif (!newKeys.has(k)) {\n\t\t\tdelete obj[k];\n\t\t}\n\t}\n\tif (!define) {\n\t\tfor (const k of newKeys) {\n\t\t\tobj[k] = props[k];\n\t\t}\n\t\treturn obj;\n\t}\n\tfor (const k of newKeys) {\n\t\tconst value = props[k];\n\t\tif (k in oldProps && oldProps[k] === value) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (isValue(value)) {\n\t\t\tReflect.defineProperty(obj, k, {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tget() { return value(); },\n\t\t\t\tset(v) { value(v); },\n\t\t\t});\n\t\t\tcontinue;\n\t\t}\n\t\tReflect.defineProperty(obj, k, {\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t\tvalue,\n\t\t});\n\t}\n\treturn obj;\n}\n","import {\n\tNeepElement, Exposed, Delivered,\n\tRender, NeepNode, Slots, Context, IRender, Component,\n} from '../type';\nimport { typeSymbol, componentsSymbol } from '../symbols';\nimport { isProduction } from '../constant';\nimport auxiliary, { isElement, Tags } from '../auxiliary';\nimport { renderSymbol, isElementSymbol } from '../symbols';\nimport { getLabel } from '../helper/label';\nimport Entity from './Entity';\nimport { getSlots, setSlots } from './slot';\nimport { initContext } from '../helper/context';\nimport { updateProps } from './props';\nimport EventEmitter from '../EventEmitter';\nimport { components as globalComponents } from '../register';\n\n\nfunction getComponents(\n\t...components: (Record<string, Component> | undefined)[]\n) {\n\treturn components.filter(Boolean) as Record<string, Component>[];\n}\n\nfunction execSimple(\n\tnObject: Entity,\n\tdelivered: Delivered,\n\tnode: NeepElement,\n\ttag: Component,\n\tcomponents: Record<string, Component>[],\n\tchildren: any[],\n) {\n\tconst { iRender } = nObject;\n\tconst slotMap = Object.create(null);\n\tgetSlots(iRender, children, slotMap);\n\tconst slots = setSlots(slotMap);\n\tconst event = new EventEmitter();\n\tevent.updateInProps(node.props);\n\tconst context: Context = initContext({\n\t\tslots,\n\t\tcreated: false,\n\t\tparent: nObject.exposed,\n\t\tdelivered,\n\t\tchildren: new Set<Exposed>(),\n\t\tchildNodes: children,\n\t\trefresh(f) { nObject.refresh(f); },\n\t\temit: event.emit,\n\t});\n\tif (!isProduction) { getLabel(); }\n\tconst result = tag({...node.props}, context, auxiliary);\n\tlet label: [string, string] | undefined;\n\tif (!isProduction) { label = getLabel(); }\n\tconst nodes = exec(nObject, delivered, renderNode(\n\t\tiRender,\n\t\tresult,\n\t\tcontext,\n\t\ttag[renderSymbol],\n\t), slots, getComponents(...components, tag[componentsSymbol]));\n\n\treturn {\n\t\t...node,\n\t\ttag,\n\t\tchildren: Array.isArray(nodes) ? nodes : [nodes],\n\t\tlabel,\n\t} as NeepElement;\n}\n\nfunction execSlot(\n\tnObject: Entity,\n\tdelivered: Delivered,\n\tnode: NeepElement,\n\tslots: Slots,\n\tcomponents: Record<string, Component>[],\n\tchildren: any[],\n\targs: any[] = [{}],\n\tnative: boolean,\n): NeepElement {\n\tconst slotName = node.props?.name || 'default';\n\tconst slot = slots[slotName];\n\tif (typeof slot === 'function') {\n\t\treturn {\n\t\t\t...node,\n\t\t\t...slot(...args),\n\t\t};\n\t}\n\tconst { render } = node;\n\tconst label: [string, string] | undefined = isProduction\n\t\t? undefined\n\t\t: [`[${ slotName }]`, '#00F'];\n\treturn {\n\t\t...node,\n\t\ttag: Tags.ScopeSlot,\n\t\tlabel,\n\t\tchildren: exec(\n\t\t\tnObject,\n\t\t\tdelivered,\n\t\t\ttypeof render !== 'function' ? children : render(...args),\n\t\t\tslots,\n\t\t\tcomponents,\n\t\t\tnative,\n\t\t),\n\t};\n}\n\nfunction findComponent(\n\ttag: any,\n\tcomponents: Record<string, Component>[],\n): Component | string | null {\n\tif (!tag) { return null; }\n\tif (typeof tag !== 'string') { return tag; }\n\tif (tag === 'template') { return tag; }\n\tif (/^neep:.+/i.test(tag)) { return tag; }\n\tfor (const list of components) {\n\t\tconst component = list[tag];\n\t\tif (component) { return component; }\n\t}\n\treturn globalComponents[tag] || tag;\n}\n\nfunction exec(\n\tnObject: Entity,\n\tdelivered: Delivered,\n\tnode: any,\n\tslots: Slots,\n\tcomponents: Record<string, Component>[],\n\tnative = false,\n): any {\n\tif (Array.isArray(node)) {\n\t\treturn node.map(n =>\n\t\t\texec(nObject, delivered, n, slots, components, native)\n\t\t);\n\t}\n\tif (!isElement(node)) { return node; }\n\tconst { inserted, args = [{}] } = node;\n\tlet tag = findComponent(node.tag, components);\n\tif (tag === Tags.Deliver) {\n\t\tconst props = { ...node.props };\n\t\tdelete props.ref;\n\t\tdelete props.slot;\n\t\tdelete props.key;\n\t\tconst newDelivered = Object.create(delivered);\n\t\tupdateProps(newDelivered, props || {}, {}, true);\n\t\treturn {\n\t\t\t...node,\n\t\t\ttag,\n\t\t\t$__neep__delivered: newDelivered,\n\t\t\tchildren: node.children.map(n => exec(\n\t\t\t\tnObject,\n\t\t\t\tnewDelivered,\n\t\t\t\tn,\n\t\t\t\tslots,\n\t\t\t\tcomponents,\n\t\t\t\tnative,\n\t\t\t)),\n\t\t};\n\t}\n\n\tconst children = node.children\n\t\t.map(n => exec(nObject, delivered, n, slots, components, native));\n\n\tif (typeof tag === 'function') {\n\t\tif (tag[typeSymbol] === 'simple') {\n\t\t\treturn execSimple(\n\t\t\t\tnObject,\n\t\t\t\tdelivered,\n\t\t\t\tnode,\n\t\t\t\ttag,\n\t\t\t\tcomponents,\n\t\t\t\texec(\n\t\t\t\t\tnObject,\n\t\t\t\t\tdelivered,\n\t\t\t\t\tchildren,\n\t\t\t\t\tslots,\n\t\t\t\t\tcomponents,\n\t\t\t\t\tnative,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t\treturn { ...node, $__neep__delivered: delivered, children, tag };\n\n\t}\n\tif (tag === Tags.Slot) {\n\t\ttag = native ? 'slot' : Tags.ScopeSlot;\n\t}\n\tif (tag !== Tags.ScopeSlot || inserted) {\n\t\treturn { ...node, children, tag };\n\t}\n\treturn execSlot(\n\t\tnObject,\n\t\tdelivered,\n\t\t{ ...node, tag },\n\t\tslots,\n\t\tcomponents,\n\t\tchildren,\n\t\targs,\n\t\tnative,\n\t);\n}\n\n\nfunction renderNode<R extends object = object>(\n\tiRender: IRender,\n\tnode: R | NeepNode | NeepNode[] | undefined | null,\n\tcontext: Context,\n\trender?: Render,\n): NeepNode[] {\n\tif (Array.isArray(node)) { return node; }\n\tif (isElement(node)) { return [node]; }\n\tif (node === undefined || node === null) {\n\t\treturn [{ [isElementSymbol]: true, tag: null, children: [] }];\n\t}\n\tif (!iRender.isNode(node)\n\t\t&& node && typeof node === 'object' && render\n\t) {\n\t\tnode = render(node, context, auxiliary);\n\t}\n\tif (isElement(node)) { return [node]; }\n\tif (node === undefined || node === null) {\n\t\treturn [{ [isElementSymbol]: true, tag: null, children: [] }];\n\t}\n\treturn [{\n\t\t[isElementSymbol]: true,\n\t\ttag: Tags.Value,\n\t\tvalue: node,\n\t\tchildren: [],\n\t}];\n}\n\nexport default function normalize(\n\tnObject: Entity,\n\tresult: any,\n) {\n\tconst { component } = nObject;\n\treturn exec(\n\t\tnObject,\n\t\tnObject.delivered,\n\t\trenderNode(\n\t\t\tnObject.iRender,\n\t\t\tresult,\n\t\t\tnObject.context,\n\t\t\tcomponent[renderSymbol],\n\t\t),\n\t\tnObject.context.slots,\n\t\tgetComponents(component[componentsSymbol]),\n\t\tBoolean(nObject.native),\n\t);\n}\n","import NeepObject from './Object';\n\nlet delayedRefresh = 0;\nconst objectSet = new Set<NeepObject>();\nexport function wait(obj: NeepObject) {\n\tif (delayedRefresh <= 0) { return false; }\n\tobjectSet.add(obj);\n\treturn true;\n}\nfunction run() {\n\tif (delayedRefresh > 0) { return; }\n\tconst list = [...objectSet];\n\tobjectSet.clear();\n\tlist.forEach(o => o.refresh());\n}\nasync function asyncRefresh<T>(f: () => PromiseLike<T> | T): Promise<T> {\n\ttry {\n\t\tdelayedRefresh++;\n\t\treturn await f();\n\t} finally {\n\t\tdelayedRefresh--;\n\t\trun();\n\t}\n}\nexport default function refresh<T>(f: () => T, async?: false): T;\nexport default function refresh<T>(\n\tf: () => PromiseLike<T> | T,\n\tasync: true,\n): Promise<T>;\nexport default function refresh<T>(\n\tf: () => PromiseLike<T> | T,\n\tasync?: boolean,\n): PromiseLike<T> | T;\nexport default function refresh<T>(\n\tf: () => PromiseLike<T> | T,\n\tasync?: boolean,\n): PromiseLike<T> | T {\n\tif (async) { return asyncRefresh(f); }\n\ttry {\n\t\tdelayedRefresh++;\n\t\treturn f();\n\t} finally {\n\t\tdelayedRefresh--;\n\t\trun();\n\t}\n}\n","import {\n\tExposed, Delivered,\n\tEntity as ComponentEntity,\n\tNativeComponent,\n\tHook, Hooks, NeepNode, IRender, Component,\n} from '../type';\nimport { callHook, setHook } from '../hook';\nimport { MountedNode } from './draw';\nimport Container from './Container';\nimport convert, { TreeNode } from './convert';\nimport { wait } from './refresh';\nimport { monitorable } from '../install';\nimport EventEmitter from '../EventEmitter';\n\nfunction createExposed(obj: NeepObject): Exposed {\n\tconst cfg: { [K in Exclude<keyof Exposed, '$label'>]-?:\n\t\t{ configurable: true, value: Exposed[K] }\n\t\t| { configurable: true, get(): Exposed[K] }\n\t} = {\n\t\t$parent: { configurable: true, get: () => obj.parent?.exposed },\n\t\t$component: { configurable: true, value: null },\n\t\t$isContainer: { configurable: true, value: false },\n\t\t$created: { configurable: true, get: () => obj.created },\n\t\t$destroyed: { configurable: true, get: () => obj.destroyed },\n\t\t$mounted: { configurable: true, get: () => obj.mounted },\n\t\t$unmounted: { configurable: true, get: () => obj.unmounted },\n\t};\n\tconst exposed: Exposed = Object.create(null, cfg);\n\treturn exposed;\n}\n\nlet completeList: (() => void)[] | undefined;\nexport function setCompleteList(list?: (() => void)[]) {\n\tcompleteList = list;\n}\nexport function complete(it: () => void) {\n\tif (!completeList) {\n\t\tit();\n\t} else {\n\t\tcompleteList.push(it);\n\t}\n}\n\nfunction createEntity(obj: NeepObject): ComponentEntity {\n\tconst cfg: { [K in keyof ComponentEntity]-?:\n\t\t{ configurable: true, value: ComponentEntity[K], writable?: boolean }\n\t\t| { configurable: true, get(): ComponentEntity[K] }\n\t} = {\n\t\texposed: { configurable: true, get: () => obj.exposed },\n\t\tdelivered: { configurable: true, get: () => obj.delivered },\n\t\tparent: { configurable: true, get: () => obj.parent?.entity },\n\t\tcomponent: { configurable: true, value: null },\n\t\tisContainer: { configurable: true, value: false },\n\t\tcreated: { configurable: true, get: () => obj.created },\n\t\tdestroyed: { configurable: true, get: () => obj.destroyed },\n\t\tmounted: { configurable: true, get: () => obj.mounted },\n\t\tunmounted: { configurable: true, get: () => obj.unmounted },\n\t\t$_hooks: { configurable: true, value: Object.create(null) },\n\t\t$_valueIndex: { configurable: true, value: 0, writable: true },\n\t\t$_values: { configurable: true, value: [] },\n\t\tcallHook: {\n\t\t\tconfigurable: true,\n\t\t\tvalue(h: string) { callHook(h, entity); },\n\t\t},\n\t\tsetHook: {\n\t\t\tconfigurable: true,\n\t\t\tvalue(id: string, hook: Hook) {\n\t\t\t\treturn setHook(id, hook, entity);\n\t\t\t},\n\t\t},\n\t\trefresh: { configurable: true, value: obj.refresh.bind(obj) },\n\t\ton: { configurable: true, value: obj.on },\n\t\temit: { configurable: true, value: obj.emit },\n\t\tconfig: { configurable: true, value: obj.config },\n\t};\n\tconst entity: ComponentEntity = Object.create(null, cfg);\n\treturn entity;\n}\n\nexport default class NeepObject {\n\treadonly events = new EventEmitter();\n\treadonly emit = this.events.emit;\n\treadonly on = this.events.on;\n\treadonly eventCancelHandles = new Set<() => void>();\n\treadonly iRender: IRender;\n\treadonly components: Record<string, Component> = Object.create(null);\n\treadonly config: Record<string, any> = Object.create(null);\n\t/** 接受到的呈递值 */\n\treadonly parentDelivered: Delivered;\n\t/** 向后代呈递的值 */\n\treadonly delivered: Delivered;\n\t/** 组件暴露值 */\n\treadonly exposed: Exposed = createExposed(this);\n\t/** 组件实体 */\n\treadonly entity: ComponentEntity = createEntity(this);\n\t/** 父组件 */\n\tparent?: NeepObject;\n\t/** 原生组件 */\n\tnative: NativeComponent | undefined;\n\t/** 状态 */\n\tcreated: boolean = false;\n\tdestroyed: boolean = false;\n\tmounted: boolean = false;\n\tunmounted: boolean = false;\n\t/**  子组件的暴露值 */\n\treadonly children: Set<Exposed> = new Set();\n\t/** The subtree mounted on the parent node */\n\ttree: (MountedNode | MountedNode[])[] = [];\n\treadonly container: Container;\n\tconstructor(\n\t\tiRender: IRender,\n\t\tparent?: NeepObject,\n\t\tdelivered: Delivered = parent?.delivered || Object.create(null),\n\t\tcontainer?: Container,\n\t) {\n\t\tthis.iRender = iRender;\n\t\tthis.parentDelivered = delivered;\n\t\tthis.delivered = Object.create(delivered);\n\t\tif (parent) {\n\t\t\tthis.parent = parent;\n\t\t}\n\t\tthis.container = container || this as any as Container;\n\t}\n\t/** 结果渲染函数 */\n\tprotected _render: () => NeepNode[] = () => [];\n\n\tget canRefresh(): boolean {\n\t\tif (wait(this)) { return false; }\n\t\treturn !this._delayedRefresh;\n\t}\n\tprotected get needRefresh(): boolean {\n\t\tif (wait(this)) { return false; }\n\t\tif (this._delayedRefresh) { return false; }\n\t\tconst needRefresh = this._needRefresh;\n\t\tthis._needRefresh = false;\n\t\treturn needRefresh;\n\t}\n\t/** 是否需要继续刷新 */\n\tprotected _needRefresh = false;\n\tprivate _delayedRefresh = 0;\n\t/** 是否为刷新中 */\n\tprivate _refreshing = false;\n\t/** 渲染结果 */\n\tprotected _nodes: (TreeNode | TreeNode[])[] = [];\n\tprotected requestDraw() { }\n\tasync asyncRefresh<T>(f: () => PromiseLike<T> | T): Promise<T> {\n\t\ttry {\n\t\t\tthis._delayedRefresh++;\n\t\t\treturn await f();\n\t\t} finally {\n\t\t\tthis._delayedRefresh--;\n\t\t\tthis.refresh();\n\t\t}\n\t}\n\trefresh(): void;\n\trefresh<T>(f: () => T, async?: false): T;\n\trefresh<T>(f: () => PromiseLike<T> | T, async: true): Promise<T>;\n\trefresh<T>(\n\t\tf: () => PromiseLike<T> | T,\n\t\tasync?: boolean,\n\t): PromiseLike<T> | T;\n\trefresh<T>(\n\t\tf?: () => PromiseLike<T> | T,\n\t\tasync?: boolean,\n\t): PromiseLike<T> | T | undefined;\n\trefresh<T>(\n\t\tf?: () => PromiseLike<T> | T,\n\t\tasync?: boolean,\n\t): PromiseLike<T> | T | undefined {\n\t\tif (typeof f === 'function') {\n\t\t\tif (async) { return this.asyncRefresh(f); }\n\t\t\ttry {\n\t\t\t\tthis._delayedRefresh++;\n\t\t\t\treturn f();\n\t\t\t} finally {\n\t\t\t\tthis._delayedRefresh--;\n\t\t\t\tif (this._delayedRefresh <= 0) {\n\t\t\t\t\tthis.refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.destroyed) { return; }\n\t\tthis._needRefresh = true;\n\t\tif (!this.created) { return; }\n\n\t\tif (this._refreshing) { return; }\n\t\tthis._refreshing = true;\n\n\t\tlet nodes: NeepNode[] | undefined;\n\t\twhile(this.needRefresh) {\n\t\t\tnodes = this._render();\n\t\t\tif (this.destroyed) { return; }\n\t\t}\n\t\tthis._refreshing = false;\n\t\tif (!this.canRefresh) { return; }\n\t\tif (!nodes) { return; }\n\n\t\tthis._nodes = convert(this, nodes, this._nodes);\n\t\tif (!this.mounted) { return; }\n\t\tif (this.destroyed) { return; }\n\t\tif (this.unmounted) { return; }\n\t\tthis.requestDraw();\n\t}\n\tcallHook<H extends Hooks>(id: H): void;\n\tcallHook(id: string): void;\n\tcallHook(id: string): void {\n\t\tcallHook(id, this.entity);\n\t}\n\n\tchildNodes: any[] = [];\n\t/** 更新属性及子代 */\n\tprotected _update(props: object, children: any[]): void {\n\t\tthis.childNodes = children;\n\t}\n\t/** 更新属性及子代 */\n\tupdate(props: object, children: any[]): void {\n\t\tthis._update(props, children);\n\t}\n\n\n\tprivate __executed_destroy = false;\n\tprivate __executed_mount = false;\n\tprivate __executed_mounted = false;\n\tprotected _destroy() { }\n\tdestroy() {\n\t\tif (this.__executed_destroy) { return; }\n\t\tthis.__executed_destroy = true;\n\t\tthis.callHook('beforeDestroy');\n\t\tthis._destroy();\n\t\tthis.callHook('destroyed');\n\t\tthis.destroyed = true;\n\t}\n\tprotected _mount() { }\n\tmount() {\n\t\tif (this.__executed_destroy) { return; }\n\t\tif (this.__executed_mount) { return; }\n\t\tthis.__executed_mount = true;\n\t\tthis.callHook('beforeMount');\n\t\tconst result = monitorable.exec(\n\t\t\tc => c && this.requestDraw(),\n\t\t\t() => {\n\t\t\t\tthis._mount();\n\t\t\t\tthis.mounted = true;\n\t\t\t},\n\t\t);\n\t\tthis._cancelDrawMonitor = result.stop;\n\t\tcomplete(() => this.callHook('mounted'));\n\t}\n\tprotected _unmount() { }\n\tunmount() {\n\t\tif (!this.mounted) { return; }\n\t\tif (this.__executed_mounted) { return; }\n\t\tthis.__executed_mounted = true;\n\t\tthis.callHook('beforeUnmount');\n\t\tthis._unmount();\n\t\tthis.callHook('unmounted');\n\t\tthis.unmounted = true;\n\t}\n\t_draw() {}\n\t_cancelDrawMonitor?: () => void;\n\tdraw() {\n\t\tif (this.__executed_destroy) { return; }\n\t\tthis._cancelDrawMonitor?.();\n\t\tthis.callHook('beforeUpdate');\n\t\tconst result = monitorable.exec(\n\t\t\tc => c && this.requestDraw(),\n\t\t\t() => this._draw(),\n\t\t);\n\t\tthis._cancelDrawMonitor = result.stop;\n\t\tcomplete(() => this.callHook('updated'));\n\t}\n}\n","import { Component, NeepNode, Slots, Context, Delivered, NativeShadow } from '../type';\nimport auxiliary from '../auxiliary';\nimport { monitorable } from '../install';\nimport { setCurrent } from '../helper/current';\nimport convert, { destroy, TreeNode } from './convert';\nimport draw, { unmount, MountedNode, getNodes } from './draw';\nimport normalize from './normalize';\nimport { getSlots, setSlots } from './slot';\nimport NeepObject from './Object';\nimport { initContext } from '../helper/context';\nimport { updateProps } from './props';\nimport { typeSymbol, configSymbol, componentsSymbol } from '../symbols';\nimport refresh from './refresh';\n\nfunction update(\n\tnObject: Entity<any, any>,\n\tprops: any,\n\tchildren:any[],\n) {\n\tupdateProps(nObject.props, props, {}, false, true);\n\tnObject.events.updateInProps(props);\n\tconst slots = Object.create(null);\n\tconst { native } = nObject;\n\tconst childNodes = getSlots(\n\t\tnObject.iRender,\n\t\tchildren,\n\t\tslots,\n\t\tBoolean(native),\n\t);\n\tsetSlots(slots, nObject.slots);\n\tif (!native) { return; }\n\tnObject.nativeNodes\n\t\t= convert(nObject, childNodes, nObject.nativeNodes);\n\tif (!nObject.mounted) { return; }\n\tnObject.requestDraw();\n}\n\nfunction createContext<\n\tP extends object = object,\n\tR extends object = object\n>(nObject: Entity<P, R>): Context {\n\treturn initContext({\n\t\tslots: nObject.slots,\n\t\tget created() { return nObject.created; },\n\t\tget parent() { return nObject.parent.exposed; },\n\t\tget delivered() { return nObject.parentDelivered; },\n\t\tget children() { return nObject.children; },\n\t\tget childNodes() { return nObject.childNodes; },\n\t\tget emit() { return nObject.emit; },\n\t\trefresh(f) { nObject.refresh(f); },\n\t}, nObject.exposed);\n}\n\n/** 初始化渲染 */\nfunction initRender<R extends object = object>(\n\tnObject: Entity<any, R>\n): { render(): any, nodes: any, stopRender(): void } {\n\tconst {\n\t\tcomponent,\n\t\tprops,\n\t\tcontext,\n\t\tentity,\n\t} = nObject;\n\tconst refresh = (changed: boolean) => changed && nObject.refresh();\n\t// 初始化执行\n\tconst result = monitorable.exec(refresh, () => setCurrent(\n\t\t() => component(props, context, auxiliary),\n\t\tentity,\n\t), { resultOnly: true });\n\tif (typeof result === 'function') {\n\t\t// 响应式\n\t\tconst render = monitorable.createExecutable(\n\t\t\trefresh,\n\t\t\t() => normalize(nObject, (result as () => NeepNode)()),\n\t\t);\n\t\treturn {\n\t\t\tnodes: render(),\n\t\t\trender,\n\t\t\tstopRender: () => render.stop(),\n\t\t};\n\t}\n\n\tconst render = monitorable.createExecutable(\n\t\trefresh,\n\t\t() => normalize(nObject, setCurrent(\n\t\t\t() => component(props, context, auxiliary),\n\t\t\tentity,\n\t\t)),\n\t);\n\treturn {\n\t\tnodes: monitorable.exec(\n\t\t\trefresh,\n\t\t\t() => normalize(nObject, result),\n\t\t\t{ resultOnly: true },\n\t\t),\n\t\trender,\n\t\tstopRender: () => render.stop(),\n\t};\n}\n\n\nexport default class Entity<\n\tP extends object = object,\n\tR extends object = object\n> extends NeepObject {\n\t/** 组件函数 */\n\treadonly component: Component<P, R>;\n\t/** 组件属性 */\n\treadonly props: P = monitorable.encase(Object.create(null));\n\t/** 组件槽 */\n\treadonly slots: Slots = monitorable.encase(Object.create(null));\n\t/** 结果渲染函数 */\n\tprivate readonly _stopRender:() => void;\n\t/** 原生子代 */\n\tnativeNodes: (TreeNode | TreeNode[])[] | undefined;\n\tshadowTree: (MountedNode | MountedNode[])[] = [];\n\tnativeTree: (MountedNode | MountedNode[])[] = [];\n\tprivate readonly _shadow: NativeShadow | undefined;\n\t/** 组件上下文 */\n\treadonly context: Context;\n\treadonly parent: NeepObject;\n\t/** 结果渲染函数 */\n\tconstructor(\n\t\tcomponent: Component<P, R>,\n\t\tprops: object,\n\t\tchildren: any[],\n\t\tparent: NeepObject,\n\t\tdelivered?: Delivered,\n\t) {\n\t\tsuper(parent.iRender, parent, delivered, parent.container);\n\t\tthis.component = component;\n\t\tObject.assign(this.config, component[configSymbol]);\n\t\tObject.assign(this.components, component[componentsSymbol]);\n\t\tReflect.defineProperty(\n\t\t\tthis.exposed,\n\t\t\t'$component',\n\t\t\t{ value: component, enumerable: true, configurable: true },\n\t\t);\n\t\t// 原生组件\n\t\t[this.native, this._shadow] =\n\t\t\tcomponent[typeSymbol] === 'native' &&\n\t\t\tthis.iRender.component?.() || [];\n\t\t// 父子关系\n\t\tthis.parent = parent;\n\t\tparent.children.add(this.exposed);\n\t\t// 上下文属性\n\t\tconst context = createContext(this);\n\t\tthis.context = context;\n\t\t// 初始化钩子\n\t\tthis.callHook('beforeCreate');\n\t\t// 更新属性\n\t\tthis.childNodes = children;\n\t\trefresh(() => update(this, props, children));\n\t\t// 获取渲染函数及初始渲染\n\t\tconst { render, nodes, stopRender } = initRender(this);\n\t\tthis._render = render;\n\t\tthis._stopRender = stopRender;\n\t\tthis._nodes = convert(this, nodes);\n\t\t// 初始化钩子\n\t\tthis.callHook('created');\n\t\tthis.created = true;\n\t\tif (this._needRefresh) { this.refresh(); }\n\t}\n\t/** 更新属性及子代 */\n\t_update(props: object, children: any[]): void {\n\t\tif (this.destroyed) { return; }\n\t\tthis.childNodes = children;\n\t\trefresh(() => update(this, props, children));\n\t}\n\t_destroy() {\n\t\tif (this._stopRender) {\n\t\t\tthis._stopRender();\n\t\t}\n\t\tthis.parent.children.delete(this.exposed);\n\t\tdestroy(this._nodes);\n\t}\n\n\t/** 刷新 */\n\trequestDraw() {\n\t\tthis.container.markDraw(this);\n\t}\n\t_draw() {\n\t\tconst {nativeNodes, iRender, _shadow, native} = this;\n\t\tif (!native || !nativeNodes || !_shadow) {\n\t\t\tthis.tree = draw(\n\t\t\t\tiRender,\n\t\t\t\tthis._nodes,\n\t\t\t\tthis.tree,\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tthis.shadowTree = draw(\n\t\t\tiRender,\n\t\t\tthis._nodes,\n\t\t\tthis.shadowTree,\n\t\t);\n\t\tthis.nativeTree = draw(\n\t\t\tiRender,\n\t\t\tnativeNodes,\n\t\t\tthis.nativeTree,\n\t\t);\n\t}\n\t_mount() {\n\t\tconst {nativeNodes, iRender, _shadow, native, _nodes} = this;\n\t\tif (!native || !nativeNodes || !_shadow) {\n\t\t\tthis.tree = draw(iRender, _nodes);\n\t\t\treturn;\n\t\t}\n\t\tthis.tree = draw(iRender, convert(this, native));\n\t\tthis.shadowTree = draw(iRender, _nodes);\n\t\tfor (const it of getNodes(this.shadowTree)) {\n\t\t\tiRender.insert(_shadow, it);\n\t\t}\n\t\tthis.nativeTree = draw(iRender, nativeNodes);\n\t\tfor (const it of getNodes(this.nativeTree)) {\n\t\t\tiRender.insert(native, it);\n\t\t}\n\t}\n\t_unmount() {\n\t\tconst {iRender, nativeTree} = this;\n\t\tunmount(iRender, this.tree);\n\t\tif (!nativeTree) { return; }\n\t\tunmount(iRender, nativeTree);\n\t}\n}\n","import { getRender } from '../install';\nimport { NeepNode, NeepElement, Tag } from '../type';\nimport { Tags, isElement, Value, Template } from '../auxiliary';\nimport { isElementSymbol, typeSymbol } from '../symbols';\nimport { recursive2iterable } from './recursive';\nimport Entity from './Entity';\nimport NeepObject from './Object';\nimport Container from './Container';\nimport { updateProps } from './props';\n\nexport interface TreeNode\n\textends Omit<\n\t\tNeepElement,\n\t\t'children' | 'tag' | typeof isElementSymbol\n\t>\n{\n\t/** 标签名 */\n\ttag: Tag;\n\tchildren: (this | this[])[];\n\tmounted?: boolean;\n\tcomponent?: NeepObject;\n}\n/** 强制转换为 NeepElement */\nfunction toElement(t: any): null | NeepElement {\n\tif (t === false || t === null || t === undefined) {\n\t\treturn null;\n\t}\n\tif (isElement(t)) {\n\t\treturn t;\n\t}\n\treturn {\n\t\t[isElementSymbol]: true,\n\t\ttag: Value,\n\t\tkey: t,\n\t\tvalue: t,\n\t\tchildren: [],\n\t};\n}\n\nexport function destroy(\n\ttree: TreeNode | TreeNode[] | (TreeNode | TreeNode[])[]\n) {\n\tif (Array.isArray(tree)) {\n\t\ttree.forEach(t => destroy(t));\n\t\treturn;\n\t}\n\tconst { component } = tree;\n\tif (component) { component.destroy(); }\n}\n\nfunction createItem(\n\tnObject: NeepObject,\n\tsource: NeepNode,\n): TreeNode {\n\tif (!source) { return { tag: null, children: [] }; }\n\tconst { tag } = source;\n\tif (!tag) { return { tag: null, children: [] }; }\n\tif (typeof tag !== 'string') {\n\t\tif (tag[typeSymbol] === 'simple') {\n\t\t\treturn {\n\t\t\t\t...source,\n\t\t\t\tchildren: convert(nObject, source.children),\n\t\t\t\tcomponent: undefined,\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\t...source, children: [],\n\t\t\tcomponent: new Entity(\n\t\t\t\ttag,\n\t\t\t\tsource.props || {},\n\t\t\t\tsource.children,\n\t\t\t\tnObject,\n\t\t\t\tsource.$__neep__delivered,\n\t\t\t),\n\t\t};\n\t}\n\tif (tag === Tags.Container) {\n\t\tconst type = source?.props?.type;\n\t\tconst iRender = type ? getRender(type) : nObject.iRender;\n\t\treturn {\n\t\t\t...source, children: [],\n\t\t\tcomponent: new Container(\n\t\t\t\tiRender,\n\t\t\t\tsource.props || {},\n\t\t\t\tsource.children,\n\t\t\t\tnObject,\n\t\t\t\tsource.$__neep__delivered,\n\t\t\t),\n\t\t};\n\t}\n\tif (tag === Tags.Value) {\n\t\treturn { ...source, children: [] };\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\treturn {\n\t\t\t...source,\n\t\t\tchildren: convert(nObject, source.children),\n\t\t};\n\t}\n\treturn {...source, children: convert(nObject, source.children) };\n}\n\n/**\n * 更新树节点\n * @param nObject Neep 对象\n * @param source 用于替换的源\n * @param tree 已有树\n */\nfunction updateList(\n\tnObject: NeepObject,\n\tsource: any[],\n\ttree: TreeNode | TreeNode[],\n): TreeNode[] {\n\tif (!Array.isArray(tree)) { tree = [tree]; }\n\tconst newList: TreeNode[] = [];\n\tfor (const src of recursive2iterable(source)) {\n\t\tconst node = toElement(src);\n\t\tif (!node) { continue; }\n\t\tconst index = tree.findIndex(it =>\n\t\t\tit.tag === node.tag && it.key === node.key\n\t\t);\n\t\tif (index >= 0) {\n\t\t\tnewList.push(updateItem(nObject, node, tree[index]));\n\t\t\ttree.splice(index, 1);\n\t\t} else {\n\t\t\tnewList.push(createItem(nObject, node));\n\t\t}\n\t}\n\tdestroy(tree);\n\treturn newList;\n}\n\n/**\n * 更新树节点\n * @param tree 已有树\n * @param source 用于替换的源\n * @param nObject Neep 对象\n */\nfunction updateItem(\n\tnObject: NeepObject,\n\tsource: NeepNode,\n\ttree?: TreeNode | TreeNode[],\n): TreeNode {\n\tif (!tree) {\n\t\treturn createItem(nObject, source);\n\t}\n\tif (!source) {\n\t\tdestroy(tree);\n\t\treturn { tag: null, children: [] };\n\t}\n\tif (Array.isArray(tree)) {\n\t\tif (!tree.length) { return createItem(nObject, source); }\n\t\tconst index = tree.findIndex(it => it.tag === source.tag);\n\t\tif (index < 0) {\n\t\t\tdestroy(tree);\n\t\t\treturn createItem(nObject, source);\n\t\t}\n\t\tconst all = tree;\n\t\t[tree] = tree.splice(index, 1);\n\t\tdestroy(all);\n\t}\n\tconst { tag } = source;\n\tif (tag !== tree.tag) {\n\t\tdestroy(tree);\n\t\treturn createItem(nObject, source);\n\t}\n\tif (!tag) { return { tag: null, children: [] }; }\n\tif (typeof tag !== 'string') {\n\t\tif (tag[typeSymbol] === 'simple') {\n\t\t\treturn {\n\t\t\t\t...source,\n\t\t\t\tchildren: convert(\n\t\t\t\t\tnObject,\n\t\t\t\t\tsource.children,\n\t\t\t\t\ttree.children,\n\t\t\t\t),\n\t\t\t\tcomponent: undefined,\n\t\t\t};\n\t\t}\n\t\tconst { component } = tree;\n\t\tif (!component) { return createItem(nObject, source); }\n\t\tcomponent.update(source.props || {}, source.children);\n\t\treturn { ...source, children: [], component };\n\t}\n\tif (tag === Tags.Container) {\n\t\tconst { component } = tree;\n\t\tif (!component) { return createItem(nObject, source); }\n\t\tconst type = source?.props?.type;\n\t\tconst iRender = type ? getRender(type) : nObject.iRender;\n\t\tif (iRender !== component.iRender) {\n\t\t\treturn createItem(nObject, source);\n\t\t}\n\t\tcomponent.update(source.props || {}, source.children);\n\t\treturn { ...source, children: [], component };\n\t}\n\tif (tag === Tags.Value) {\n\t\treturn { ...source, children: [] };\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\tlet delivered: any;\n\t\tif (Tags.Deliver === tag) {\n\t\t\tconst props = { ...source.props };\n\t\t\tdelete props.ref;\n\t\t\tdelete props.slot;\n\t\t\tdelete props.key;\n\t\t\tdelivered = updateProps(\n\t\t\t\ttree.$__neep__delivered,\n\t\t\t\tprops,\n\t\t\t\ttree.props,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\t\treturn {\n\t\t\t...source,\n\t\t\t$__neep__delivered: delivered,\n\t\t\tchildren: convert(\n\t\t\t\tnObject,\n\t\t\t\tsource.children,\n\t\t\t\ttree.children,\n\t\t\t),\n\t\t};\n\t}\n\treturn {\n\t\t...source,\n\t\tchildren: convert(nObject, source.children, tree.children),\n\t};\n}\n\n\nfunction createAll(\n\tnObject: NeepObject,\n\tsource: any[],\n): (TreeNode | TreeNode[])[] {\n\tif (!source.length) { return []; }\n\treturn (source as any[]).map(item => {\n\t\tif (!Array.isArray(item)) {\n\t\t\treturn createItem(nObject, toElement(item));\n\t\t}\n\t\treturn [...recursive2iterable(item)]\n\t\t\t.map(it => createItem(nObject, toElement(it)));\n\t});\n}\nfunction *updateAll(\n\tnObject: NeepObject,\n\tsource: any[],\n\ttree: (TreeNode | TreeNode[])[],\n): Iterable<TreeNode | TreeNode[]> {\n\tlet index = 0;\n\tlet length = Math.min(source.length, source.length);\n\tfor (; index < length; index++) {\n\t\tconst src = source[index];\n\t\tif (Array.isArray(src)) {\n\t\t\tyield updateList(nObject, src, tree[index]);\n\t\t} else {\n\t\t\tyield updateItem(nObject, toElement(src), tree[index]);\n\t\t}\n\t}\n\tlength = Math.max(source.length, source.length);\n\tif (tree.length > length) {\n\t\t\t// 销毁多余项\n\t\t\tfor (; index < length; index++) {\n\t\t\t\tdestroy(tree[index]);\n\t\t\t}\n\t}\n\tif (source.length > length) {\n\t\t// 创建多余项\n\t\tfor (; index < length; index++) {\n\t\t\tconst src = toElement(source[index]);\n\t\t\tif (Array.isArray(src)) {\n\t\t\t\tyield [...recursive2iterable(src)]\n\t\t\t\t\t.map(it => createItem(nObject, it));\n\t\t\t} else {\n\t\t\t\tyield createItem(nObject, src);\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * 更新树\n * @param source 用于替换的源\n * @param nObject Neep 对象\n * @param tree 已有树\n */\nfunction convert(\n\tnObject: NeepObject,\n\tsource: any,\n\ttree?: (TreeNode | TreeNode[])[],\n): (TreeNode | TreeNode[])[] {\n\tif (!Array.isArray(source)) { source = [source]; }\n\tif (!tree) {\n\t\treturn createAll(nObject, source);\n\t}\n\treturn [...updateAll(nObject, source, tree)];\n}\n\n\nexport default convert;\n","import {\n\tIRender,\n\tMountProps,\n\tNativeNode,\n\tNativeContainer,\n\tDelivered,\n} from '../type';\nimport { Tags } from '../auxiliary';\nimport { createMountedNode } from './id';\nimport convert, { destroy } from './convert';\nimport draw, { unmount, getNodes, MountedNode, setRefList } from './draw';\nimport NeepObject, { setCompleteList, complete } from './Object';\nimport { nextFrame, monitorable } from '../install';\n\n\nlet awaitDraw = new Set<Container>();\nlet requested = false;\nfunction markDraw(c: Container) {\n\tawaitDraw.add(c);\n\tif (requested) { return; }\n\trequested = true;\n\tnextFrame(() => {\n\t\trequested = false;\n\t\tconst list = [...awaitDraw];\n\t\tawaitDraw.clear();\n\t\tlist.map(c => c.drawAll());\n\t});\n}\n\nexport default class Container extends NeepObject {\n\tprops: MountProps;\n\t/** 组件树结构 */\n\tcontent: (MountedNode | MountedNode[])[] = [];\n\t_node: NativeNode | null = null;\n\t_container: NativeContainer | null = null;\n\treadonly rootContainer: Container = this;\n\tconstructor(\n\t\tiRender: IRender,\n\t\tprops: MountProps,\n\t\tchildren: any[],\n\t\tparent?: NeepObject,\n\t\tdelivered?: Delivered,\n\t) {\n\t\tsuper(iRender, parent, delivered);\n\t\tthis.props = props;\n\t\tthis.parent = parent;\n\t\tif (parent) {\n\t\t\tthis.rootContainer = parent.container.rootContainer;\n\t\t}\n\t\tthis.callHook('beforeCreate');\n\t\tthis._render = () => children;\n\t\tthis._nodes = convert(this, children);\n\t\tthis.callHook('created');\n\t\tthis.created = true;\n\t}\n\t_drawChildren = false;\n\t_drawContainer = false;\n\tsetChildren(children: any[]): void {\n\t\tif (this.destroyed) { return; }\n\t\tthis.childNodes = children;\n\t\tthis._render = () => children;\n\t\tthis._drawChildren = true;\n\t\tthis.refresh();\n\t}\n\tsetProps(props: MountProps): void {\n\t\tif (this.destroyed) { return; }\n\t\tthis.props = props;\n\t\tthis._drawContainer = true;\n\t\tthis.refresh();\n\t}\n\t/** 更新属性及子代 */\n\tupdate(props: MountProps, children: any[]): void {\n\t\tthis.refresh(() => {\n\t\t\tthis.setProps(props);\n\t\t\tthis.setChildren(children);\n\t\t});\n\t}\n\trequestDraw() {\n\t\tthis.markDraw(this);\n\t}\n\t_mount() {\n\t\tconst { props, parent, iRender } = this;\n\t\tconst content = draw(this.container.iRender, this._nodes);\n\t\tthis.content = content;\n\t\tconst [container, node]\n\t\t\t= iRender.mount(props, parent?.iRender);\n\t\tfor (const it of getNodes(content)) {\n\t\t\tiRender.insert(container, it);\n\t\t}\n\t\tthis.tree = [createMountedNode({\n\t\t\ttag: Tags.Value,\n\t\t\tcomponent: undefined,\n\t\t\tnode,\n\t\t\tvalue: node,\n\t\t\tchildren: [],\n\t\t})];\n\t\tthis._node = node;\n\t\tthis._container = container;\n\t}\n\t_destroy() {\n\t\tdestroy(this.content);\n\t}\n\t_unmount() {\n\t\tconst { parent, iRender } = this;\n\t\tif (parent) {\n\t\t\tunmount(parent.iRender, this.tree);\n\t\t}\n\t\tiRender.unmount(\n\t\t\tthis._container!,\n\t\t\tthis._node!,\n\t\t\tBoolean(parent),\n\t\t);\n\t\tunmount(this.iRender, this.content);\n\t}\n\t_draw() {\n\t\tconst {\n\t\t\t_drawChildren: drawChildren,\n\t\t\t_drawContainer: drawContainer,\n\t\t} = this;\n\t\tthis._drawContainer = false;\n\t\tif (drawContainer) {\n\t\t\tthis.iRender.drawContainer(\n\t\t\t\tthis._container!,\n\t\t\t\tthis._node!,\n\t\t\t\tthis.props,\n\t\t\t\tthis.parent?.iRender,\n\t\t\t);\n\t\t}\n\t\tif (this.parent && this.parent.iRender !== this.iRender) {\n\t\t\treturn;\n\t\t}\n\t\tthis._drawChildren = false;\n\t\tif (drawChildren) {\n\t\t\tthis.content = draw(\n\t\t\t\tthis.iRender,\n\t\t\t\tthis._nodes,\n\t\t\t\tthis.content,\n\t\t\t);\n\t\t}\n\t}\n\t_drawSelf() {\n\t\tconst {\n\t\t\t_drawChildren: drawChildren,\n\t\t\t_drawContainer: drawContainer,\n\t\t} = this;\n\t\tthis._needDraw = false;\n\t\tthis._drawChildren = false;\n\t\tthis._drawContainer = false;\n\t\tif (drawContainer) {\n\t\t\tthis.iRender.drawContainer(\n\t\t\t\tthis._container!,\n\t\t\t\tthis._node!,\n\t\t\t\tthis.props,\n\t\t\t\tthis.parent?.iRender,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\t\tif (drawChildren) {\n\t\t\tthis.content = draw(\n\t\t\t\tthis.iRender,\n\t\t\t\tthis._nodes,\n\t\t\t\tthis.content,\n\t\t\t);\n\t\t}\n\t}\n\tdrawSelf() {\n\t\tif (!this.mounted) { return; }\n\t\tif (this.destroyed) { return; }\n\t\tthis.callHook('beforeUpdate');\n\t\tmonitorable.exec(\n\t\t\tc => c && this.markDraw(this),\n\t\t\t() => this._drawSelf(),\n\t\t);\n\t\tcomplete(() => this.callHook('updated'));\n\t}\n\t/** 等待重画的项目 */\n\tprivate _awaitDraw = new Set<NeepObject>();\n\t/** 自身是否需要重绘 */\n\tprivate _needDraw = false;\n\t/** 标记需要绘制的元素 */\n\tmarkDraw(\n\t\tnObject: NeepObject,\n\t\tremove = false,\n\t) {\n\t\tif (this.parent?.iRender === this.iRender) {\n\t\t\tthis.parent.container.markDraw(nObject, remove);\n\t\t\treturn;\n\t\t}\n\t\tif (nObject === this && this.parent) {\n\t\t\tthis.parent.container.markDraw(this, remove);\n\t\t\tthis._needDraw = !remove;\n\t\t} else if (remove) {\n\t\t\tthis._awaitDraw.delete(nObject);\n\t\t} else {\n\t\t\tthis._awaitDraw.add(nObject);\n\t\t}\n\t\tthis.rootContainer.markDrawContainer(\n\t\t\tthis,\n\t\t\t!this._needDraw && !this._awaitDraw.size || this.destroyed,\n\t\t);\n\t}\n\tdrawContainer() {\n\t\tconst {\n\t\t\t_node: node,\n\t\t\t_container: container,\n\t\t\t_awaitDraw: awaitDraw,\n\t\t} = this;\n\t\tif (!node || !container) { return; }\n\t\tthis.callHook('beforeDraw');\n\t\tconst needDraw = this._needDraw;\n\t\tthis._needDraw = false;\n\t\tconst list = [...awaitDraw];\n\t\tawaitDraw.clear();\n\t\tif (needDraw) { this.drawSelf(); }\n\t\tlist.map(c => c.draw());\n\t\tthis.iRender.draw(container, node);\n\t\tcomplete(() => this.callHook('drawn'));\n\t}\n\tprivate _containers = new Set<Container>();\n\tmarkDrawContainer(\n\t\tcontainer: Container,\n\t\tremove = false,\n\t) {\n\t\tif (remove) {\n\t\t\tthis._containers.delete(container);\n\t\t} else {\n\t\t\tthis._containers.add(container);\n\t\t}\n\t\tmarkDraw(this);\n\t}\n\tdrawAll() {\n\t\tconst containers = this._containers;\n\t\tif (!containers.size) { return; }\n\t\tthis.callHook('beforeDrawAll');\n\t\tconst refs: (() => void)[] = [];\n\t\tconst completeList: (() => void)[] = [];\n\t\tsetCompleteList(completeList);\n\t\tsetRefList(refs);\n\t\tconst list = [...containers];\n\t\tcontainers.clear();\n\t\tlist.forEach(c => c.drawContainer());\n\t\tsetRefList();\n\t\trefs.forEach(r => r());\n\t\tcompleteList.forEach(r => r());\n\t\tthis.callHook('drawnAll');\n\t}\n}\n","import {\n\tMountProps,\n\tNeepElement,\n\tComponent,\n\tRootExposed,\n} from '../type';\nimport { isElement, createElement } from '../auxiliary';\nimport { isProduction } from '../constant';\nimport { devtools, getRender } from '../install';\nimport Container from './Container';\n\nexport function render(\n\te?: NeepElement | Component,\n\tp: MountProps = {},\n): RootExposed {\n\tlet params = {...p};\n\tconst container =  new Container(\n\t\tgetRender(p.type),\n\t\tparams,\n\t\te === undefined ? [] : isElement(e) ? [e] : [createElement(e)],\n\t);\n\tif (!isProduction) {\n\t\tdevtools.renderHook(container);\n\t}\n\tconst { exposed } = container;\n\tReflect.defineProperty(exposed, '$update', {\n\t\tvalue(c?: NeepElement | Component) {\n\t\t\tcontainer.setChildren(c === undefined ? []\n\t\t\t\t: isElement(c) ? [c] : [createElement(c)]);\n\t\t\treturn exposed;\n\t\t},\n\t\tconfigurable: true,\n\t});\n\tReflect.defineProperty(exposed, '$mount', {\n\t\tvalue(target?: any) {\n\t\t\tif (exposed.$mounted) { return exposed; }\n\t\t\tif (target) {\n\t\t\t\tparams.target = target;\n\t\t\t\tcontainer.setProps(params);\n\t\t\t}\n\t\t\tcontainer.mount();\n\t\t\treturn exposed;\n\t\t},\n\t\tconfigurable: true,\n\t});\n\tReflect.defineProperty(exposed, '$unmount', {\n\t\tvalue() {\n\t\t\tif (!exposed.$mounted) { return; }\n\t\t\tif (exposed.$unmounted) { return; }\n\t\t\tif (exposed.$destroyed) { return container.destroy(); }\n\t\t\tcontainer.unmount();\n\t\t\treturn;\n\t\t},\n\t\tconfigurable: true,\n\t});\n\tif (params.target) {\n\t\tcontainer.mount();\n\t}\n\treturn exposed as any as RootExposed;\n}\nexport { default as refresh } from './refresh';\n","import { install } from '.';\nimport * as monitorable from 'monitorable';\n\ninstall({ monitorable });\n\nexport * from '.';\n"],"names":["version","mode","isProduction","getEventName","k","substr","test","addEventFromCollection","addEvent","events","names","Array","isArray","n","p","Object","keys","f","EventEmitter","update","emitter","newHandles","fn","push","on","updateInProps","props","custom","entName","listener","_names","constructor","Set","create","createEmit","omitNames","emit","name","event","omit","Reflect","defineProperty","get","monitorable","markRead","filter","t","includes","configurable","safeify","markChange","add","removed","delete","size","updateHandles","eventCancelHandles","_cancelHandles","oldHandles","clear","forEach","list","handles","NeepError","Error","message","tag","assert","v","installMonitorable","api","value","computed","isValue","encase","recover","nextFrameApi","nextFrame","renders","getRender","type","default","addRender","render","install","installRender","devtools","renderHook","installDevtools","tools","apis","components","register","component","isElementSymbol","Symbol","for","typeSymbol","nameSymbol","renderSymbol","componentsSymbol","configSymbol","Mark","symbol","MarkValue","key","obj","mName","mType","mSimple","mNative","mRender","mConfig","config","mark","mComponent","item","c","r","marks","m","lazy","Placeholder","reslut","Component","undefined","load","Lazy","childNodes","createElement","com","loading","ScopeSlot","SlotRender","Slot","Value","Container","Deliver","Template","Fragment","setCurrent","entity","oldEntity","current","$_valueIndex","ret","$_values","length","checkCurrent","initOnly","created","constructors","initContext","context","exposed","addContextConstructor","hooks","setHook","id","hook","$_hooks","set","callHook","watch","cb","stop","s","useValue","index","values","setValue","opt","enumerable","expose","deliver","delivered","isElement","attrs","children","node","slot","ref","Tags","argv","args","elements","concat","simple","label","setLabel","l","getLabel","text","color","auxiliary","Life","Element","Dev","Constant","State","setAuxiliary","defineAuxiliary","ids","Nodes","IdMap","Map","createMountedNode","recoveryMountedNode","recursive2iterable","it","refList","setRefList","setRef","isRemove","getLastNode","tree","getFirstNode","getNodes","unmount","iRender","e","remove","replace","newTree","oldTree","next","parent","insert","updateList","source","createItem","newList","mountedMap","src","findIndex","old","updateItem","splice","has","last","i","o","updateAll","Math","min","max","createList","all","draw","createValue","createAll","isNode","RegExp","String","Date","toISOString","placeholder","map","mount","getSlots","slots","native","nativeList","ownKeys","el","renderSlots","createSlots","inserted","setSlots","disabledKey","updateProps","oldProps","define","isProps","newKeys","getComponents","Boolean","execSimple","nObject","slotMap","refresh","result","nodes","exec","renderNode","execSlot","slotName","findComponent","globalComponents","newDelivered","$__neep__delivered","normalize","delayedRefresh","objectSet","wait","run","asyncRefresh","async","createExposed","cfg","$parent","$component","$isContainer","$created","$destroyed","destroyed","$mounted","mounted","$unmounted","unmounted","completeList","setCompleteList","complete","createEntity","isContainer","writable","h","bind","NeepObject","container","parentDelivered","canRefresh","_delayedRefresh","needRefresh","_needRefresh","requestDraw","_refreshing","_render","_nodes","convert","_update","_destroy","destroy","__executed_destroy","_mount","__executed_mount","_cancelDrawMonitor","_unmount","__executed_mounted","_draw","nativeNodes","createContext","initRender","changed","resultOnly","createExecutable","stopRender","Entity","assign","_shadow","_stopRender","markDraw","shadowTree","nativeTree","toElement","awaitDraw","requested","drawAll","rootContainer","setChildren","_drawChildren","setProps","_drawContainer","content","_node","_container","drawChildren","drawContainer","_drawSelf","_needDraw","drawSelf","_awaitDraw","markDrawContainer","needDraw","_containers","containers","refs","params","target"],"mappings":"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"}