{"version":3,"file":"neep.core.js","sources":["../src/constant.ts","../src/Error.ts","../src/install.ts","../src/auxiliary/tags.ts","../src/auxiliary/state.ts","../src/helper/current.ts","../src/helper/context.ts","../src/hook.ts","../src/auxiliary/life.ts","../src/symbols.ts","../src/auxiliary/element.ts","../src/helper/label.ts","../src/auxiliary/dev.ts","../src/auxiliary/index.ts","../src/render/id.ts","../src/render/recursive.ts","../src/render/draw.ts","../src/render/slot.ts","../src/render/props.ts","../src/render/normalize.ts","../src/render/refresh.ts","../src/render/Object.ts","../src/render/Entity.ts","../src/render/convert.ts","../src/render/Container.ts","../src/render/index.ts","../src/create.ts","../src/browser.ts"],"sourcesContent":["/**\n * Global constant\n *\n * Will be replaced by the 'rollup-plugin-replace' plug-in\n */\n\n /**\n * Neep code version\n */\nexport const version = '__VERSION__' as string;\n/**\n * Current mode\n * @enum production\n * @enum development\n */\nexport const mode = '__MODE__' as any as 'production' | 'development';\n/**\n * Is the current mode production mode\n * @description Support tree shaking\n */\nexport const isProduction = mode === 'production';\n","export default class NeepError extends Error {\n\treadonly tag: string;\n\tconstructor(message: string, tag: string = '') {\n\t\tsuper(tag ? `[${tag}] ${message}` : message);\n\t\tthis.tag = tag;\n\t}\n}\nexport function assert(v: any, message: string, tag?: string) {\n\tif (v) { return; }\n\tthrow new NeepError(message, tag);\n}","import * as monitorableApi from 'monitorable';\nimport { IRender } from './type';\nimport { isProduction } from './constant';\n\nimport { Devtools } from '../../devtools/src/type';\nimport { assert } from './Error';\n\nexport let monitorable: typeof monitorableApi;\n\nexport interface InstallOptions {\n\tmonitorable?: typeof monitorableApi;\n\trender?: IRender;\n\trenders?: IRender[];\n\tdevtools?: any;\n}\n\n\nlet nextFrameApi: undefined | ((fn: () => void) => void);\nexport function nextFrame(fn: () => void): void {\n\tassert(nextFrameApi, 'The basic renderer is not installed', 'install');\n\tnextFrameApi!(fn);\n}\n\nexport const renders: Record<string, IRender>\n\t= Object.create(null);\n\nexport function getRender(\n\ttype: string | number | IRender = ''\n\t): IRender {\n\tif (typeof type === 'object') { return type; }\n\treturn renders[type] || renders.default;\n}\n\nfunction addRender(render?: IRender): void {\n\tif (!render) { return; }\n\trenders[render.type] = render;\n\tif (nextFrameApi) { return; }\n\tif (!renders.default) {\n\t\trenders.default = render;\n\t}\n\tif (!nextFrameApi && render.nextFrame) {\n\t\trenders.default = render;\n\t\tnextFrameApi = render.nextFrame;\n\t}\n\n}\nfunction installRender({ render, renders}: InstallOptions) {\n\taddRender(render);\n\tif (!Array.isArray(renders)) { return; }\n\tfor (const render of renders) {\n\t\taddRender(render);\n\t}\n}\n\n\nexport const devtools: Devtools = {\n\trenderHook(){},\n};\n\nfunction installDevtools(tools?: Partial<Devtools>) {\n\tif (!tools) { return; }\n\tif (typeof tools !== 'object') { return; }\n\tconst { renderHook } = tools;\n\tif (typeof renderHook === 'function') {\n\t\tdevtools.renderHook = renderHook;\n\t}\n}\n\n\nexport default function install(apis: InstallOptions) {\n\tif (apis.monitorable) {\n\t\tmonitorable = apis.monitorable;\n\t}\n\tinstallRender(apis);\n\tif (!isProduction) {\n\t\tinstallDevtools(apis.devtools);\n\t}\n}\n","export const ScopeSlot = 'Neep:ScopeSlot';\nexport const SlotRender = 'Neep:SlotRender';\nexport const Slot = 'Neep:Slot';\nexport const Value = 'Neep:Value';\nexport const Container = 'Neep:Container';\nexport const Deliver = 'Neep:Deliver';\nexport const Template = 'template';\nexport const Fragment = Template;\n","/**\n * 状态管理类 API\n */\nimport { Value, Options } from 'monitorable';\nimport { monitorable } from '../install';\n\nexport function value<T>(\n\tvalue: T,\n\toptions?: boolean | Options,\n): Value<T>\nexport function value(...v: [any]) {\n\treturn monitorable.value(...v);\n}\nexport function computed<T>(\n\tgetter: () => T,\n\toptions?: boolean | Options,\n): Value<T>;\nexport function computed<T>(...v: [any]) {\n\treturn monitorable.computed(...v);\n}\nexport function isValue(v: any): v is Value<any>;\nexport function isValue(...v: [any]) {\n\treturn monitorable.isValue(...v);\n}\nexport function encase<T>(value: T, nest?: number | boolean): T;\nexport function encase<T>(...v: [any]): T {\n\treturn monitorable.encase(...v);\n}\nexport function recover<T>(v: T): T;\nexport function recover<T>(...v: [any]): T {\n\treturn monitorable.recover(...v);\n}\n","import NeepError from '../Error';\nimport { Entity } from '../type';\n\n/** 当前正在执行的对象 */\nexport let current: Entity | undefined;\nexport function setCurrent<T>(\n\tfn: () => T,\n\tentity: Entity,\n): T {\n\tconst oldEntity = current;\n\tcurrent = entity;\n\ttry {\n\t\tcurrent.$_valueIndex = 0;\n\t\tconst ret = fn();\n\t\tif (current.$_valueIndex !== current.$_values.length) {\n\t\t\tthrow new NeepError(\n\t\t\t\t'Inconsistent number of useValue executions',\n\t\t\t\t'life',\n\t\t\t);\n\t\t}\n\t\treturn ret;\n\t} finally {\n\t\tcurrent = oldEntity;\n\t}\n}\n\nexport function checkCurrent(\n\tname: string,\n\tinitOnly = false,\n): Entity {\n\tif (!current) {\n\t\tthrow new NeepError(\n\t\t\t`Function \\`${name}\\` can only be called within a cycle.`,\n\t\t\t'life',\n\t\t);\n\t}\n\tif (!initOnly) {\n\t\treturn current;\n\t}\n\tif (!current.created) {\n\t\treturn current;\n\t}\n\tthrow new NeepError(\n\t\t`Function \\`${name}\\` can only be called at initialization time.`,\n\t\t'life',\n\t);\n}\n","import { Context, ContextConstructor, Exposed } from '../type';\nimport { monitorable } from '../install';\n\nconst constructors: ContextConstructor[] = [];\nexport function initContext(\n\tcontext: Context,\n\texposed?: Exposed,\n): Context {\n\tfor (const constructor of constructors) {\n\t\tconstructor(context, exposed);\n\t}\n\treturn context;\n}\nexport function addContextConstructor(\n\tconstructor: ContextConstructor\n): void {\n\tconstructors.push(monitorable.safeify(constructor));\n}","import { monitorable } from './install';\nimport { Hook, Hooks, Entity } from './type';\nconst hooks: Record<string, Set<Hook>> = Object.create(null);\n\nexport function setHook<H extends Hooks>(\n\tid: H,\n\thook: Hook,\n\tentity?: Entity,\n):() => void;\nexport function setHook(\n\tid: string,\n\thook: Hook,\n\tentity?: Entity,\n): () => void;\n\nexport function setHook(\n\tid: string,\n\thook: Hook,\n\tentity?: Entity,\n):() => void {\n\tlet list = entity?.$_hooks || hooks;\n\tif (!list) { return () => {}; }\n\thook = monitorable.safeify(hook);\n\tlet set = list[id];\n\tif (!set) {\n\t\tset = new Set();\n\t\tlist[id] = set;\n\t}\n\tset.add(hook);\n\treturn () => set.delete(hook);\n}\n\nexport function callHook<H extends Hooks>(\n\tid: H,\n\texposed: Entity,\n): void;\nexport function callHook(id: string, exposed: Entity): void;\nexport function callHook(id: string, exposed: Entity): void {\n\tif (!exposed) { return; }\n\tfor (const hook of exposed.$_hooks[id] || []) {\n\t\thook(exposed);\n\t}\n\tfor (const hook of hooks[id] || []) {\n\t\thook(exposed);\n\t}\n}\n","/**********************************\n * 组件上下文环境专用 API\n * @description 简单组件不支持\n **********************************/\nimport { Value, WatchCallback } from 'monitorable';\nimport { Hooks, Hook } from '../type';\nimport { checkCurrent } from '../helper';\nimport { monitorable } from '../install';\nimport NeepError from '../Error';\nimport { setHook } from '../hook';\nimport { isValue } from './state';\n\n\n/**********************************\n * 状态管理类 API\n **********************************/\n/**\n * 监听指定值的变化\n * @description 本质是调用 Value 对象的 watch 方法\n * @description 但是通过此方法进行的观察，会在组件生命周期结束时自动停止观察\n * @description 此函数只有在初始化调用时有效\n * @param value 被监听的值\n * @param cb    当监听的值发送变化时调用的函数\n */\nexport function watch<T>(\n\tvalue: Value<T>,\n\tcb: WatchCallback<T>,\n): () => void;\n/**\n * 监听指定值的变化\n * @description 本质是创建调用 Value 对象的 watch 方法\n * @description 但是通过此方法进行的观察，会在组件生命周期结束时自动停止观察\n * @description 此函数只有在初始化调用时有效\n * @param value 用于计算观测值的函数\n * @param cb    当监听的值发送变化时调用的函数\n */\nexport function watch<T>(\n\tvalue: () => T,\n\tcb: (v: T, stopped: boolean) => void,\n): () => void;\n\nexport function watch<T>(\n\tvalue: Value<T> | (() => T),\n\tcb: (v: Value<T> | T, stopped: boolean) => void\n): () => void {\n\tconst entity = checkCurrent('watch');\n\tif (typeof value !== 'function') { return () => {}; }\n\tconst stop = isValue(value)\n\t\t? value.watch(cb)\n\t\t: monitorable.computed(value).watch((v, s) => cb(v(), s));\n\tsetHook('beforeDestroy', () => stop(), entity);\n\treturn stop;\n}\n\nexport function useValue<T>(f: () => T, name = 'useValue'): T {\n\tconst entity = checkCurrent(name);\n\tconst index = entity.$_valueIndex++;\n\tconst values = entity.$_values;\n\tif (!entity.created) {\n\t\tvalues[index] = undefined;\n\t\treturn values[index] = f();\n\t}\n\tif (index >= values.length) {\n\t\tthrow new NeepError(\n\t\t\t'Inconsistent number of useValue executions',\n\t\t\t'life',\n\t\t);\n\t}\n\treturn values[index];\n\n}\n\n/**********************************\n * 钩子类 API\n **********************************/\n/**\n * 为当前组件注册钩子\n * @param name 钩子名称\n * @param hook 钩子\n * @param initOnly 是否仅在初始化时有效\n */\nexport function hook<H extends Hooks>(\n\tname: H,\n\thook: () => void,\n\tinitOnly?: boolean,\n): undefined | (() => void);\nexport function hook(\n\tname: string,\n\thook: () => void,\n\tinitOnly?: boolean,\n): undefined | (() => void);\nexport function hook(\n\tname: string,\n\thook: () => void,\n\tinitOnly?: boolean,\n): undefined | (() => void) {\n\tconst entity = checkCurrent('setHook');\n\tif (initOnly && entity.created) { return undefined; }\n\treturn setHook(name, () => hook(), entity);\n}\n\n/**********************************\n * 配置 API\n **********************************/\n\nexport function setValue<T>(\n\tobj: any,\n\tname: string | number | symbol,\n\tvalue: T | Value<T> | (() => T),\n\topt?: boolean | ((value: T) => void),\n): void {\n\tif (\n\t\ttypeof name === 'string'\n\t\t&& ['$', '_'].includes(name[0])\n\t) {\n\t\treturn;\n\t}\n\tif (isValue(value) && opt) {\n\t\tReflect.defineProperty(obj, name, {\n\t\t\tget() { return value(); },\n\t\t\tset(v) { value(v); },\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t});\n\t\treturn;\n\t}\n\tif (typeof value === 'function' && opt) {\n\t\tReflect.defineProperty(obj, name, {\n\t\t\tget: value as () => T,\n\t\t\tset: typeof opt === 'function' ? opt : undefined,\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t});\n\t\treturn;\n\t}\n\tReflect.defineProperty(obj, name, {\n\t\tget() { return value; },\n\t\tconfigurable: true,\n\t\tenumerable: true,\n\t});\n}\n\n\n/**\n * 将 Value 导出\n * @param name 导出用的名称\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tvalue: Value<T>,\n\tmix?: boolean,\n): void;\n/**\n * 将普通值导出\n * @param name\n * @param value\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tvalue: T,\n): void;\n/**\n * 设置基于 getter 的导出\n * @param name\n * @param getter\n * @param nonModifiable\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tnonModifiable: true,\n): void;\n/**\n * 设置基于 getter/setter 的导出\n * @param name\n * @param getter\n * @param setter\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tsetter: (value: T) => void,\n): void;\nexport function expose<T>(\n\tname: string | number | symbol,\n\tvalue: T | Value<T> | (() => T),\n\topt?: boolean | ((value: T) => void),\n): void {\n\tsetValue(checkCurrent('expose', true).exposed, name, value, opt);\n}\n\n\n/**\n * 将 Value 传递给子组件\n * @param name 导出用的名称\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tvalue: Value<T>,\n\tmix?: boolean,\n): void;\n/**\n * 将普通值导出\n * @param name\n * @param value\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tvalue: T,\n): void;\n/**\n * 设置基于 getter 的传递\n * @param name\n * @param getter\n * @param nonModifiable\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tnonModifiable: true,\n): void;\n/**\n * 设置基于 getter/setter 的传递\n * @param name\n * @param getter\n * @param setter\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tsetter: (value: T) => void,\n): void;\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tvalue: T | Value<T> | (() => T),\n\topt?: boolean | ((value: T) => void),\n): void {\n\tsetValue(checkCurrent('deliver', true).delivered, name, value, opt);\n}\n","export const isElementSymbol = Symbol.for('isNeepElement');\nexport const typeSymbol = Symbol.for('type');\nexport const nameSymbol = Symbol.for('name');\nexport const renderSymbol = Symbol.for('render');\n","import { Tag, NeepElement, Component } from '../type';\nimport { isElementSymbol, typeSymbol } from '../symbols';\nimport * as Tags from './tags';\n\n/**\n * 判读是否为元素\n */\nexport function isElement(v: any): v is NeepElement {\n\tif (!v) { return false; }\n\tif (typeof v !== 'object') { return false; }\n\treturn v[isElementSymbol] === true;\n}\n\nexport function createElement(\n\ttag: Tag,\n\tattrs?: {[key:string]: any},\n\t...children: any[]\n): NeepElement {\n\tattrs = attrs ? {...attrs} : {};\n\tconst node: NeepElement = {\n\t\t[isElementSymbol]: true,\n\t\ttag,\n\t\tchildren: [],\n\t};\n\tif ('key' in attrs) { node.key = attrs.key; }\n\tif ('slot' in attrs) { node.slot = attrs.slot; }\n\tif (typeof attrs.ref === 'function') { node.ref = attrs.ref; }\n\tif (tag === Tags.Value) {\n\t\tnode.value = attrs.value;\n\t\treturn node;\n\t}\n\tnode.children = children;\n\tif (tag === Tags.Template) { return node; }\n\tif (tag === Tags.SlotRender) {\n\t\tnode.render = attrs.render;\n\t\treturn node;\n\t}\n\tif (tag === Tags.ScopeSlot || tag === Tags.Slot) {\n\t\tconst { render, argv, args, name } = attrs;\n\t\tnode.render = render;\n\t\tnode.args = argv && [argv]\n\t\t\t|| Array.isArray(args) && args.length && args\n\t\t\t|| [{}];\n\n\t\tif (tag === Tags.ScopeSlot) {\n\t\t\tnode.props = { name };\n\t\t\treturn node;\n\t\t}\n\t}\n\tnode.on = {};\n\tnode.props = {};\n\tfor (let k in attrs) {\n\t\t/** 事件 */\n\t\tconst onInfo = /^(::|@|on:)([a-zA-Z0-9].*)$/.exec(k);\n\t\tif (onInfo) {\n\t\t\tnode.on[onInfo[2]] = attrs[k];\n\t\t\tcontinue;\n\t\t}\n\t\t// TODO: data\n\t\tconst nCmd = /^n([:-])([a-zA-Z0-9]+(?:\\.[a-zA-Z0-9]+)*)$/i.exec(k);\n\t\t/** 普通属性 */\n\t\tif (!nCmd) {\n\t\t\tnode.props[k] = attrs[k];\n\t\t\tcontinue;\n\t\t}\n\t}\n\treturn node;\n}\n\nexport interface elementIteratorOptions {\n\tsimple?: boolean | Component[] | ((c: Component) => boolean);\n}\n\nexport function elements(\n\tnode: any,\n\topt: elementIteratorOptions = {},\n): any[] {\n\tif (Array.isArray(node)) {\n\t\tconst list: any[][] = [];\n\t\tfor (let n of node) {\n\t\t\tlist.push(elements(n, opt));\n\t\t}\n\t\treturn ([] as any[]).concat(...list);\n\t}\n\tif (!isElement(node)) { return [node]; }\n\tlet { tag } = node;\n\tif (!tag) { return []; }\n\n\tif (([Tags.Template, Tags.ScopeSlot] as Tag[]).includes(tag)) {\n\t\treturn elements(node.children, opt);\n\t}\n\tif (typeof tag !== 'function') { return [node]; }\n\tif (tag[typeSymbol] !== 'simple') { return [node]; }\n\tconst { simple } = opt;\n\tif (!simple) { return [node]; }\n\tif (Array.isArray(simple)) {\n\t\tif (simple.includes(tag)) { return [node]; }\n\t} else if (typeof simple === 'function') {\n\t\tif (!simple(tag)) { return [node]; }\n\t}\n\treturn elements(node.children, opt);\n}\n","let label: [string, string] | undefined;\nexport function setLabel(l: [string, string]) {\n\tlabel = l;\n}\n\nexport function getLabel() {\n\tconst l = label;\n\tlabel = undefined;\n\treturn l;\n}\n","import { isProduction } from '../constant';\nimport { current } from '../helper';\nimport { setLabel } from '../helper/label';\n\nexport function label(text: string, color = ''): void {\n\tif (!isProduction) {\n\t\tif (!current) {\n\t\t\tsetLabel([text, color]);\n\t\t\treturn;\n\t\t}\n\t\tReflect.defineProperty(current.exposed, '$label', {\n\t\t\tvalue: [text, color],\n\t\t\tconfigurable: true,\n\t\t});\n\t}\n}\n","import * as Constant from '../constant';\nimport * as Tags from './tags';\nimport * as State from './state';\nimport * as Life from './life';\nimport * as Element from './element';\nimport * as Dev from './dev';\n\nexport * from './tags';\nexport * from './state';\nexport * from './life';\nexport * from './element';\nexport * from './dev';\n\nexport { Tags };\n\n\n/** 辅助 */\nexport interface Auxiliary extends\n\tReadonly<typeof Tags>,\n\tReadonly<typeof State>,\n\tReadonly<typeof Life>,\n\tReadonly<typeof Element>,\n\tReadonly<typeof Dev>,\n\tReadonly<typeof Constant>\n{}\n\nconst auxiliary: Auxiliary = {\n\t...Tags,\n\t...State,\n\t...Life,\n\t...Element,\n\t...Dev,\n\t...Constant,\n};\n\nexport function setAuxiliary<T>(\n\tname: string,\n\tvalue: T,\n): void {\n\tReflect.defineProperty(auxiliary, name, {\n\t\tvalue,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n}\nexport function defineAuxiliary<T>(\n\tname: string,\n\tget: (this: Auxiliary) => T,\n): void {\n\tReflect.defineProperty(auxiliary, name, {\n\t\tget,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n}\nexport default auxiliary;\n","import { NativeNode } from '../type';\nimport { isProduction } from '../constant';\nimport { MountedNode } from './draw';\n\nlet ids = 0;\nconst Nodes: {[key: number]: MountedNode} = {};\nlet IdMap: undefined | Map<NativeNode, number>;\nif (!isProduction) {\n\tIdMap = new Map();\n}\nexport function createMountedNode(\n\tn: Omit<MountedNode, 'id'>,\n\tid?: number,\n): MountedNode {\n\tif (!isProduction) {\n\t\tid = id || ++ids;\n\t\tconst { node } = n;\n\t\tif (node && IdMap) { IdMap.set(node, id); }\n\t\treturn Nodes[id] = {...n, id};\n\t}\n\treturn {...n, id: 0};\n}\n\nexport function recoveryMountedNode(node: MountedNode): void {\n\tif (!isProduction) {\n\t\tdelete Nodes[node.id];\n\t}\n}\n\nexport function getNode(\n\tid: number | NativeNode,\n): MountedNode | undefined {\n\tif (!isProduction) {\n\t\tif (typeof id !== 'number') {\n\t\t\tid = IdMap?.get(id) || -1;\n\t\t}\n\t\treturn Nodes[id];\n\t}\n\treturn undefined;\n}\n","export interface RecursiveArray<T> extends Array<RecursiveItem<T>>{};\nexport type RecursiveItem<T> = T | RecursiveArray<T>;\n\nexport function *recursive2iterable<T>(\n\tlist: RecursiveItem<T>,\n): Iterable<T> {\n\tif (!Array.isArray(list)) {\n\t\tyield list;\n\t\treturn;\n\t}\n\tfor (const it of list) {\n\t\tyield* recursive2iterable(it);\n\t}\n}\n","import { Tags, Template } from '../auxiliary';\nimport { IRender, NativeNode, NativeElement } from '../type';\nimport { createMountedNode, recoveryMountedNode } from './id';\nimport { TreeNode } from './convert';\nimport NeepObject from './Object';\n\n\n/**\n * @description node / component / children 至少一个有效\n */\nexport interface MountedNode extends TreeNode {\n\tid: number;\n\tparent?: this;\n\tnode: undefined | NativeNode;\n}\n\n\ntype MountedNodes = MountedNode | MountedNode[]\n\t| (MountedNode | MountedNode[])[];\n\nfunction getLastNode(tree: MountedNodes): NativeNode {\n\tif (Array.isArray(tree)) {\n\t\treturn getLastNode(tree[tree.length - 1]);\n\t}\n\tconst { component, children, node } = tree;\n\tif (node) { return node; }\n\tif (component) { return getLastNode(component.tree); }\n\treturn getLastNode(children);\n}\n\nfunction getFirstNode(tree: MountedNodes): NativeNode {\n\tif (Array.isArray(tree)) { return getFirstNode(tree[0]); }\n\tconst { component, children, node } = tree;\n\tif (node) { return node; }\n\tif (component) { return getFirstNode(component.tree); }\n\treturn getFirstNode(children[0]);\n}\n\nexport function *getNodes(tree: MountedNodes): Iterable<NativeNode> {\n\tif (Array.isArray(tree)) {\n\t\tfor (const it of tree) {\n\t\t\tyield* getNodes(it);\n\t\t}\n\t\treturn;\n\t}\n\tconst { children, node, component } = tree;\n\tif (node) {\n\t\tyield node;\n\t\treturn;\n\t}\n\tif (component) {\n\t\tyield* getNodes(component.tree);\n\t\treturn;\n\t}\n\tyield* getNodes(children);\n}\n\nexport function unmount(iRender: IRender, tree: MountedNodes): void {\n\tif (Array.isArray(tree)) {\n\t\ttree.forEach(e => unmount(iRender, e));\n\t\treturn;\n\t}\n\tconst { component, children, node, ref } = tree;\n\trecoveryMountedNode(tree);\n\tif (node) {\n\t\tif (ref) { ref(node, true); }\n\t\tiRender.remove(node);\n\t\treturn;\n\t}\n\tif (component) {\n\t\tif (ref) { ref(component.exposed, true); }\n\t\tcomponent.unmount();\n\t\treturn;\n\t}\n\tunmount(iRender, children);\n}\n\n\nfunction replace<T extends MountedNode | MountedNode[]>(\n\tiRender: IRender,\n\tnewTree: T,\n\toldTree: MountedNode | MountedNode[],\n): T {\n\tconst next = getFirstNode(oldTree);\n\tif (!next) { return newTree; }\n\tconst parent = iRender.parent(next);\n\tif (!parent) { return newTree; }\n\tfor (const it of getNodes(newTree)) {\n\t\tiRender.insert(parent, it, next);\n\t}\n\tunmount(iRender, oldTree);\n\treturn newTree;\n}\n\nfunction updateList(\n\tiRender: IRender,\n\tsource: TreeNode[],\n\ttree: MountedNode | MountedNode[],\n): MountedNode[] {\n\tif (!source.length) {\n\t\tconst node = createItem(iRender, {tag: null, children: []});\n\t\treturn [replace(iRender, node, tree)];\n\t}\n\tif (!Array.isArray(tree)) { tree = [tree]; }\n\tconst newList: MountedNode[] = [];\n\tconst list = [...tree];\n\tconst mountedMap = new Map<MountedNode, MountedNode>();\n\tfor (const src of source) {\n\t\tconst index = list.findIndex(it =>\n\t\t\tit.tag === src.tag && it.key === src.key\n\t\t);\n\t\tif (index >= 0) {\n\t\t\tconst old = list[index];\n\t\t\tconst item = updateItem(iRender, src, old);\n\t\t\tmountedMap.set(old, item);\n\t\t\tnewList.push(item);\n\t\t\tlist.splice(index, 1);\n\t\t} else {\n\t\t\tconst item = createItem(iRender, src);\n\t\t\tnewList.push(item);\n\t\t}\n\t}\n\tif (!mountedMap.size) {\n\t\treturn replace(iRender, newList, list);\n\t}\n\tunmount(iRender, list);\n\ttree = tree.filter(t => mountedMap.has(t));\n\tconst last = getLastNode(tree[tree.length - 1]);\n\tconst parent = iRender.parent(last);\n\tif (!parent) { return newList; }\n\tlet next = iRender.next(last);\n\t// 调整次序\n\tfor(let i = newList.length - 1; i >= 0; i--) {\n\t\tconst item = newList[i];\n\t\tconst index = tree.findIndex(o => mountedMap.get(o) === item);\n\t\tif (index >= 0) {\n\t\t\tfor (const it of tree.splice(index)) {\n\t\t\t\tmountedMap.delete(it);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const it of getNodes(item)) {\n\t\t\t\tiRender.insert(parent, it, next);\n\t\t\t}\n\t\t}\n\t\tnext = getFirstNode(item) || next;\n\t}\n\treturn newList;\n}\n/**\n * 更新树\n * @param tree 已有树\n * @param source 用于替换的源\n * @param iRender Neep 对象\n */\nfunction updateAll(\n\tiRender: IRender,\n\tsource: (TreeNode | TreeNode[])[],\n\ttree: (MountedNode | MountedNode[])[],\n): (MountedNode | MountedNode[])[] {\n\tlet index = 0;\n\tlet length = Math.min(source.length, source.length || 1);\n\tconst list: (MountedNode | MountedNode[])[] = [];\n\tfor (; index < length; index++) {\n\t\tconst src = source[index];\n\t\tif (Array.isArray(src)) {\n\t\t\tlist.push(updateList(iRender, src, tree[index]));\n\t\t} else {\n\t\t\tlist.push(updateItem(iRender, src, tree[index]));\n\t\t}\n\t}\n\tlength = Math.max(source.length, tree.length);\n\tif (tree.length > length) {\n\t\t\t// 销毁多余项\n\t\t\tfor (; index < length; index++) {\n\t\t\tunmount(iRender, tree[index]);\n\t\t}\n\t}\n\tif (source.length > length) {\n\t\t// 创建多余项\n\t\tconst last = getLastNode(list[list.length - 1]);\n\t\tconst parent = iRender.parent(last);\n\t\tconst next = iRender.next(last);\n\t\tfor (; index < length; index++) {\n\t\t\tconst src = source[index];\n\t\t\tconst item = Array.isArray(src)\n\t\t\t\t? createList(iRender, src)\n\t\t\t\t: createItem(iRender, src);\n\t\t\tlist.push(item);\n\t\t\tif (!parent) { continue; }\n\t\t\tfor (const it of getNodes(item)) {\n\t\t\t\tiRender.insert(parent, it, next);\n\t\t\t}\n\t\t}\n\t}\n\treturn list;\n}\n\n/**\n * 更新树节点\n * @param iRender Neep 对象\n * @param tree 已有树\n * @param source 用于替换的源\n */\nfunction updateItem(\n\tiRender: IRender,\n\tsource: TreeNode,\n\ttree: MountedNode | MountedNode[],\n): MountedNode {\n\tif (Array.isArray(tree)) {\n\t\tconst index = tree.findIndex(it =>\n\t\t\tit.tag === source.tag && it.component === source.component\n\t\t);\n\t\tif (index < 0) {\n\t\t\treturn replace(iRender, createItem(iRender, source), tree);\n\t\t}\n\t\tconst all = tree;\n\t\t[tree] = tree.splice(index, 1);\n\t\tunmount(iRender, all);\n\t}\n\tconst { tag, component } = source;\n\tconst ref = source.ref !== tree.ref && source.ref;\n\tif (tag !== tree.tag || component !== tree.component) {\n\t\treturn replace(iRender, createItem(iRender, source), tree);\n\t}\n\tif (!tag) { return tree; }\n\tif (typeof tag !== 'string' || tag === Tags.Container) {\n\t\tif (!component) {\n\t\t\t// TODO: ref\n\t\t\treturn createMountedNode({\n\t\t\t\t...source,\n\t\t\t\tnode: undefined,\n\t\t\t\tcomponent: undefined,\n\t\t\t\tchildren: draw(\n\t\t\t\t\tiRender,\n\t\t\t\t\tsource.children,\n\t\t\t\t\ttree.children,\n\t\t\t\t),\n\t\t\t}, tree.id);\n\t\t}\n\t\tif (ref) { ref(component.exposed); }\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent,\n\t\t\tchildren: [],\n\t\t}, tree.id);\n\t}\n\tif (tag === Tags.Value) {\n\t\tif(tree.value === source.value) {\n\t\t\tif (ref && tree.node) { ref(tree.node); }\n\t\t\treturn createMountedNode({\n\t\t\t\t...tree,\n\t\t\t\t...source,\n\t\t\t\tchildren: [],\n\t\t\t}, tree.id);\n\t\t}\n\t\treturn replace( iRender, createValue(iRender, source), tree);\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\t// TODO: ref\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent: undefined,\n\t\t\tchildren: updateAll(\n\t\t\t\tiRender,\n\t\t\t\tsource.children,\n\t\t\t\ttree.children,\n\t\t\t),\n\t\t}, tree.id);\n\t}\n\tconst { node } = tree;\n\tiRender.update(\n\t\tnode as NativeElement,\n\t\tsource.props || {},\n\t);\n\tif (ref) { ref(node!); }\n\tif (!source.children.length && !tree.children.length) {\n\t\treturn createMountedNode(\n\t\t\t{\n\t\t\t\t...tree,\n\t\t\t\t...source,\n\t\t\t\tchildren: [],\n\t\t\t},\n\t\t\ttree.id);\n\t}\n\tif (!source.children.length && tree.children.length) {\n\t\tunmount(iRender, tree.children);\n\t}\n\tif (source.children.length && !tree.children.length) {\n\t\tconst children = createAll(iRender, source.children);\n\t\tfor (const it of getNodes(children)) {\n\t\t\tiRender.insert(node as NativeElement, it);\n\t\t}\n\t\treturn createMountedNode({\n\t\t\t...tree,\n\t\t\t...source,\n\t\t\tchildren,\n\t\t}, tree.id);\n\t}\n\treturn createMountedNode({\n\t\t...tree, ...source,\n\t\tchildren: updateAll(\n\t\t\tiRender,\n\t\t\tsource.children,\n\t\t\ttree.children,\n\t\t),\n\t}, tree.id);\n}\n\nfunction createValue(\n\tiRender: IRender,\n\tsource: TreeNode,\n): MountedNode {\n\tconst { value, ref } = source;\n\tif (iRender.isNode(source.value)) {\n\t\tif (ref) { ref(value); }\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: value,\n\t\t\tchildren: [],\n\t\t\tcomponent: undefined,\n\t\t});\n\t}\n\tconst type = typeof value;\n\tlet node: NativeNode | undefined;\n\tif (\n\t\ttype === 'bigint'\n\t\t|| type === 'boolean'\n\t\t|| type === 'number'\n\t\t|| type === 'string'\n\t\t|| type === 'symbol'\n\t\t|| value instanceof RegExp\n\t) {\n\t\tnode = iRender.text(String(value));\n\t} else if (value instanceof Date) {\n\t\tnode = iRender.text(value.toISOString());\n\t} else if (type === 'object' && value) {\n\t\tnode = iRender.text(String(value));\n\t\t// TODO: 对象处理\n\t}\n\tif (!node) { node = iRender.placeholder(); }\n\tif (ref) { ref(node); }\n\treturn createMountedNode({\n\t\t...source,\n\t\tnode,\n\t\tcomponent: undefined,\n\t\tchildren: [],\n\t});\n}\n\nfunction createAll(\n\tiRender: IRender,\n\tsource: (TreeNode | TreeNode[])[],\n): (MountedNode | MountedNode[])[] {\n\tif (!source.length) {\n\t\treturn [createMountedNode({\n\t\t\ttag: null,\n\t\t\tnode: iRender.placeholder(),\n\t\t\tcomponent: undefined,\n\t\t\tchildren: [],\n\t\t})];\n\t}\n\n\treturn source.map(item =>\n\t\tArray.isArray(item)\n\t\t\t? createList(iRender, item)\n\t\t\t: createItem(iRender, item)\n\t);\n}\n\nfunction createList(\n\tiRender: IRender,\n\tsource: TreeNode[],\n): MountedNode[] {\n\tif (source.length) {\n\t\treturn source.map(it => createItem(iRender, it));\n\t}\n\treturn [createMountedNode({\n\t\ttag: null,\n\t\tnode: iRender.placeholder(),\n\t\tcomponent: undefined,\n\t\tchildren: [],\n\t})];\n}\n\nfunction createItem(\n\tiRender: IRender,\n\tsource: TreeNode,\n): MountedNode {\n\tconst { tag, ref, component } = source;\n\tif (!tag) {\n\t\tconst node = iRender.placeholder();\n\t\tif (ref) { ref(node); }\n\t\treturn createMountedNode({\n\t\t\ttag: null,\n\t\t\tnode,\n\t\t\tcomponent: undefined,\n\t\t\tchildren: [],\n\t\t});\n\t}\n\tif (typeof tag !== 'string' || tag === Tags.Container) {\n\t\tif (!component) {\n\t\t\t// TODO: ref\n\t\t\treturn createMountedNode({\n\t\t\t\t...source,\n\t\t\t\tnode: undefined,\n\t\t\t\tcomponent: undefined,\n\t\t\t\tchildren: draw(iRender, source.children),\n\t\t\t});\n\t\t}\n\t\tcomponent.mount();\n\t\tif (ref) { ref(component.exposed); }\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent, children: [],\n\t\t});\n\t}\n\tif (tag === Tags.Value) {\n\t\treturn createValue(iRender, source);\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\t// TODO: ref\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent: undefined,\n\t\t\tchildren: createAll(iRender, source.children),\n\t\t});\n\t}\n\tconst node = iRender.create(tag, source.props || {});\n\tif (ref) { ref(node); }\n\tlet children: (MountedNode | MountedNode[])[] = [];\n\tif (source.children) {\n\t\tchildren = createAll(iRender, source.children);\n\t\tfor (const it of getNodes(children)) {\n\t\t\tiRender.insert(node, it);\n\t\t}\n\t}\n\treturn createMountedNode({\n\t\t...source,\n\t\tnode,\n\t\tcomponent: undefined,\n\t\tchildren,\n\t});\n}\n\nexport default function draw(\n\tiRender: IRender,\n\tsource: (TreeNode | TreeNode[])[],\n\ttree?: (MountedNode | MountedNode[])[],\n): (MountedNode | MountedNode[])[] {\n\tif (tree) {\n\t\treturn updateAll(iRender, source, tree);\n\t}\n\treturn createAll(iRender, source);\n}\n","import { NeepElement, SlotFn, Slots, IRender } from '../type';\nimport { isElement, SlotRender, ScopeSlot } from '../auxiliary';\nimport { isElementSymbol } from '../symbols';\nimport { isProduction } from '../constant';\n\n\nexport function getSlots(\n\tiRender: IRender,\n\tchildren: any[],\n\tslots: Record<string | symbol, any[]>,\n\tnative = false,\n): any[] {\n\t/** 原始对象 */\n\tconst nativeList: any[] = [];\n\tfor (const it of children) {\n\t\tif (Array.isArray(it)) {\n\t\t\tconst list: Record<string | symbol, any[]>\n\t\t\t\t= Object.create(null);\n\t\t\tnativeList.push(getSlots(iRender, it, list, native));\n\t\t\tfor (const k of Reflect.ownKeys(list) as string[]) {\n\t\t\t\tif (k in slots) {\n\t\t\t\t\tslots[k].push(list[k]);\n\t\t\t\t} else {\n\t\t\t\t\tslots[k] = [list[k]];\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (native) {\n\t\t\tif (iRender.isNode(it)) {\n\t\t\t\tnativeList.push(it);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!isElement(it)) {\n\t\t\t\tnativeList.push(it);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (it.tag !== SlotRender) {\n\t\t\t\tnativeList.push(it);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tconst slot = isElement(it) && it.slot || 'default';\n\t\tconst el = isElement(it) ? {\n\t\t\t...it, slot: undefined,\n\t\t\tprops: {...it.props, slot: undefined },\n\t\t} : it;\n\t\tif (slot in slots) {\n\t\t\tslots[slot].push(el);\n\t\t} else {\n\t\t\tslots[slot] = [el];\n\t\t}\n\t}\n\treturn nativeList;\n}\nfunction renderSlots(\n\tlist: any[],\n\t...props: any\n): any[] {\n\treturn list.map(it => {\n\t\tif (Array.isArray(it)) {\n\t\t\treturn renderSlots(it, ...props);\n\t\t}\n\t\tif (!isElement(it)) { return it; }\n\t\tif (it.tag !== SlotRender) {\n\t\t\treturn {\n\t\t\t\t...it,\n\t\t\t\tslot: undefined,\n\t\t\t} as NeepElement;\n\t\t}\n\t\tif (typeof it.render === 'function') {\n\t\t\treturn it.render(...props);\n\t\t}\n\t\treturn it.children;\n\t});\n}\nfunction createSlots(\n\tname: string,\n\tlist: any[],\n): SlotFn {\n\tconst slot = (...props: any) => ({\n\t\t[isElementSymbol]: true,\n\t\ttag: ScopeSlot,\n\t\tchildren: renderSlots(list, ...props),\n\t\tinserted: true,\n\t\tlabel: isProduction ? undefined : [`[${name}]`, '#00F'],\n\t} as NeepElement);\n\tslot.children = list;\n\treturn slot;\n}\nexport function setSlots(\n\tchildren: {[key: string]: any[]},\n\tslots: Slots = Object.create(null),\n) {\n\tfor (const k of Reflect.ownKeys(slots)) {\n\t\tif (!(k in children)) {\n\t\t\tdelete slots[k as string];\n\t\t}\n\t}\n\tfor (const k of Reflect.ownKeys(children) as string[]) {\n\t\tslots[k] = createSlots(k, children[k]);\n\t}\n\treturn slots;\n}\n","import { isValue } from '../auxiliary';\n\nexport function updateProps(\n\tobj: any,\n\tprops: any,\n\toldProps: any = {},\n\tdefine = false,\n) {\n\tconst newKeys = new Set(Reflect.ownKeys(props));\n\tfor (const k of Reflect.ownKeys(obj)) {\n\t\tif (!newKeys.has(k)) {\n\t\t\tdelete obj[k];\n\t\t}\n\t}\n\tif (!define) {\n\t\tfor (const k of newKeys) {\n\t\t\tobj[k] = props[k];\n\t\t}\n\t\treturn obj;\n\t}\n\tfor (const k of newKeys) {\n\t\tconst value = props[k];\n\t\tif (k in oldProps && oldProps[k] === value) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (isValue(value)) {\n\t\t\tReflect.defineProperty(obj, k, {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tget() { return value(); },\n\t\t\t\tset(v) { value(v); }\n\t\t\t});\n\t\t\tcontinue;\n\t\t}\n\t\tReflect.defineProperty(obj, k, {\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t\tvalue,\n\t\t});\n\t}\n\treturn obj;\n}","import {\n\tNeepElement, Exposed, Delivered,\n\tRender, NeepNode, Slots, Context, IRender, Component,\n} from '../type';\nimport { typeSymbol } from '../symbols';\nimport { isProduction } from '../constant';\nimport auxiliary, { isElement, Tags } from '../auxiliary';\nimport { renderSymbol, isElementSymbol } from '../symbols';\nimport { getLabel } from '../helper/label';\nimport Container from './Container';\nimport Entity from './Entity';\nimport { getSlots, setSlots } from './slot';\nimport { initContext } from '../helper/context';\nimport { updateProps } from './props';\n\nfunction execSimple(\n\tnObject: Container | Entity,\n\tdelivered: Delivered,\n\tnode: NeepElement,\n\ttag: Component,\n\tchildren: any[],\n) {\n\tconst { iRender } = nObject.container;\n\tconst slotMap = Object.create(null);\n\tgetSlots(iRender, children, slotMap);\n\tconst slots = setSlots(slotMap);\n\tconst context: Context = initContext({\n\t\tslots,\n\t\tcreated: false,\n\t\tparent: nObject.exposed,\n\t\tdelivered,\n\t\tchildren: new Set<Exposed>(),\n\t\tchildNodes: children,\n\t\trefresh(f) { nObject.refresh(f); }\n\t});\n\tif (!isProduction) { getLabel(); }\n\tconst result = tag({...node.props}, context, auxiliary);\n\tlet label: [string, string] | undefined;\n\tif (!isProduction) { label = getLabel(); }\n\tconst nodes = exec(nObject, delivered, renderNode(\n\t\tiRender,\n\t\tresult,\n\t\tcontext,\n\t\ttag[renderSymbol],\n\t), slots);\n\n\treturn {\n\t\t...node,\n\t\tchildren: Array.isArray(nodes) ? nodes : [nodes],\n\t\tlabel,\n\t} as NeepElement;\n}\n\nfunction execSlot(\n\tnode: NeepElement,\n\tslots: Slots,\n\tchildren: any[],\n\targs: any[] = [{}],\n): NeepElement {\n\tconst slotName = node.props?.name || 'default';\n\tconst slot = slots[slotName];\n\tif (typeof slot === 'function') {\n\t\treturn {\n\t\t\t...node,\n\t\t\t...slot(...args),\n\t\t};\n\t}\n\tconst { render } = node;\n\tconst label: [string, string] | undefined = isProduction\n\t\t? undefined\n\t\t: [`[${ slotName }]`, '#00F'];\n\treturn {\n\t\t...node,\n\t\ttag: Tags.ScopeSlot,\n\t\tlabel,\n\t\tchildren:\n\t\t\ttypeof render !== 'function' ? children : render(...args),\n\t};\n}\n\nfunction exec(\n\tnObject: Container | Entity,\n\tdelivered: Delivered,\n\tnode: any,\n\tslots: Slots,\n\tnative = false,\n): any {\n\tif (Array.isArray(node)) {\n\t\treturn node.map(n =>\n\t\t\texec(nObject, delivered, n, slots, native)\n\t\t);\n\t}\n\tif (!isElement(node)) { return node; }\n\tlet { tag, inserted, args = [{}] } = node;\n\tif (tag === Tags.Deliver) {\n\t\tconst props = { ...node.props };\n\t\tdelete props.ref;\n\t\tdelete props.slot;\n\t\tdelete props.key;\n\t\tconst newDelivered = Object.create(delivered);\n\t\tupdateProps(newDelivered, props || {}, {}, true);\n\t\treturn {\n\t\t\t...node,\n\t\t\ttag,\n\t\t\t$__neep__delivered: newDelivered,\n\t\t\tchildren: node.children.map(n => exec(\n\t\t\t\tnObject,\n\t\t\t\tnewDelivered,\n\t\t\t\tn,\n\t\t\t\tslots,\n\t\t\t\tnative,\n\t\t\t)),\n\t\t};\n\t}\n\n\tconst children = node.children\n\t\t.map(n => exec(nObject, delivered, n, slots, native));\n\n\tif (typeof tag === 'function') {\n\t\tif (tag[typeSymbol] === 'simple') {\n\t\t\treturn execSimple(nObject, delivered, node, tag, children);\n\t\t}\n\t\treturn { ...node, $__neep__delivered: delivered, children, tag };\n\n\t}\n\tif (tag === Tags.Slot) {\n\t\ttag = native ? 'slot' : Tags.ScopeSlot;\n\t}\n\tif (tag !== Tags.ScopeSlot || inserted) {\n\t\treturn { ...node, children, tag };\n\t}\n\treturn execSlot(node, slots, children, args);\n}\n\n\n\nfunction renderNode<R extends object = object>(\n\tiRender: IRender,\n\tnode: R | NeepNode | NeepNode[] | undefined | null,\n\tcontext: Context,\n\trender?: Render,\n): NeepNode[] {\n\tif (Array.isArray(node)) { return node; }\n\tif (isElement(node)) { return [node]; }\n\tif (node === undefined || node === null) {\n\t\treturn [{ [isElementSymbol]: true, tag: null, children: [] }];\n\t}\n\tif (!iRender.isNode(node) && typeof node === 'object' && render) {\n\t\tnode = render(node, context, auxiliary);\n\t}\n\tif (isElement(node)) { return [node]; }\n\tif (node === undefined || node === null) {\n\t\treturn [{ [isElementSymbol]: true, tag: null, children: [] }];\n\t}\n\treturn [{\n\t\t[isElementSymbol]: true,\n\t\ttag: Tags.Value,\n\t\tvalue: node,\n\t\tchildren: [],\n\t}];\n}\n\n\nexport default function normalize(\n\tnObject: Entity,\n\tresult: any,\n) {\n\treturn exec(\n\t\tnObject,\n\t\tnObject.delivered,\n\t\trenderNode(\n\t\t\tnObject.iRender,\n\t\t\tresult,\n\t\t\tnObject.context,\n\t\t\tnObject.component[renderSymbol],\n\t\t),\n\t\tnObject.context.slots,\n\t\tBoolean(nObject.native),\n\t);\n}\n","import NeepObject from \"./Object\";\n\nlet delayedRefresh = 0;\nconst objectSet = new Set<NeepObject>();\nexport function wait(obj: NeepObject) {\n\tif (delayedRefresh <= 0) { return false; }\n\tobjectSet.add(obj);\n\treturn true;\n}\nfunction run() {\n\tif (delayedRefresh > 0) { return; }\n\tconst list = [...objectSet];\n\tobjectSet.clear();\n\tlist.forEach(o => o.refresh());\n}\nasync function asyncRefresh<T>(f: () => PromiseLike<T> | T): Promise<T> {\n\ttry {\n\t\tdelayedRefresh++;\n\t\treturn await f();\n\t} finally {\n\t\tdelayedRefresh--;\n\t\trun();\n\t}\n}\nexport default function refresh<T>(f: () => T, async?: false): T;\nexport default function refresh<T>(\n\tf: () => PromiseLike<T> | T,\n\tasync: true,\n): Promise<T>;\nexport default function refresh<T>(\n\tf: () => PromiseLike<T> | T,\n\tasync?: boolean,\n): PromiseLike<T> | T;\nexport default function refresh<T>(\n\tf: () => PromiseLike<T> | T,\n\tasync?: boolean,\n): PromiseLike<T> | T {\n\tif (async) { return asyncRefresh(f); }\n\ttry {\n\t\tdelayedRefresh++;\n\t\treturn f();\n\t} finally {\n\t\tdelayedRefresh--;\n\t\trun();\n\t}\n}","import {\n\tExposed, Delivered,\n\tEntity as ComponentEntity,\n\tNativeComponent,\n\tHook, Hooks, NeepNode, IRender,\n} from '../type';\nimport { callHook, setHook } from '../hook';\nimport { MountedNode } from './draw';\nimport Container from './Container';\nimport convert, { TreeNode } from './convert';\nimport { wait } from './refresh';\n\nfunction createExposed(obj: NeepObject): Exposed {\n\tconst cfg: { [K in Exclude<keyof Exposed, '$label'>]-?:\n\t\t{ configurable: true, value: Exposed[K] }\n\t\t| { configurable: true, get(): Exposed[K] }\n\t} = {\n\t\t$parent: { configurable: true, get: () => obj.parent?.exposed },\n\t\t$component: { configurable: true, value: null },\n\t\t$isContainer: { configurable: true, value: false },\n\t\t$created: { configurable: true, get: () => obj.created },\n\t\t$destroyed: { configurable: true, get: () => obj.destroyed },\n\t\t$mounted: { configurable: true, get: () => obj.mounted },\n\t\t$unmounted: { configurable: true, get: () => obj.unmounted },\n\t};\n\tconst exposed: Exposed = Object.create(null, cfg);\n\treturn exposed;\n}\n\nfunction createEntity(obj: NeepObject): ComponentEntity {\n\tconst cfg: { [K in keyof ComponentEntity]-?:\n\t\t{ configurable: true, value: ComponentEntity[K], writable?: boolean }\n\t\t| { configurable: true, get(): ComponentEntity[K] }\n\t} = {\n\t\texposed: { configurable: true, get: () => obj.exposed },\n\t\tdelivered: { configurable: true, get: () => obj.delivered },\n\t\tparent: { configurable: true, get: () => obj.parent?.entity },\n\t\tcomponent: { configurable: true, value: null },\n\t\tisContainer: { configurable: true, value: false },\n\t\tcreated: { configurable: true, get: () => obj.created },\n\t\tdestroyed: { configurable: true, get: () => obj.destroyed },\n\t\tmounted: { configurable: true, get: () => obj.mounted },\n\t\tunmounted: { configurable: true, get: () => obj.unmounted },\n\t\t$_hooks: { configurable: true, value: Object.create(null) },\n\t\t$_valueIndex: { configurable: true, value: 0, writable: true },\n\t\t$_values: { configurable: true, value: [] },\n\t\tcallHook: {\n\t\t\tconfigurable: true,\n\t\t\tvalue(h: string) { callHook(h, entity); },\n\t\t},\n\t\tsetHook: {\n\t\t\tconfigurable: true,\n\t\t\tvalue(id: string, hook: Hook) {\n\t\t\t\treturn setHook(id, hook, entity);\n\t\t\t},\n\t\t},\n\t\trefresh: {\n\t\t\tconfigurable: true,\n\t\t\tvalue: obj.refresh.bind(obj),\n\t\t},\n\t};\n\tconst entity: ComponentEntity = Object.create(null, cfg);\n\treturn entity;\n}\n\nexport default class NeepObject {\n\treadonly iRender: IRender;\n\t/** TODO: 向后代呈递的值 */\n\treadonly parentDelivered: Delivered;\n\t/** TODO: 向后代呈递的值 */\n\treadonly delivered: Delivered;\n\t/** 组件暴露值 */\n\treadonly exposed: Exposed = createExposed(this);\n\t/** 组件实体 */\n\treadonly entity: ComponentEntity = createEntity(this);\n\t/** 父组件 */\n\tparent?: NeepObject;\n\t/** 原生组件 */\n\tnative: NativeComponent | null = null;\n\t/** 状态 */\n\tcreated: boolean = false;\n\tdestroyed: boolean = false;\n\tmounted: boolean = false;\n\tunmounted: boolean = false;\n\t/**  子组件的暴露值 */\n\treadonly children: Set<Exposed> = new Set();\n\t/** The subtree mounted on the parent node */\n\ttree: (MountedNode | MountedNode[])[] = [];\n\treadonly container: Container;\n\tconstructor(\n\t\tiRender: IRender,\n\t\tparent?: NeepObject,\n\t\tdelivered: Delivered = parent?.delivered || Object.create(null),\n\t\tcontainer?: Container,\n\t) {\n\t\tthis.iRender = iRender;\n\t\tthis.parentDelivered = delivered;\n\t\tthis.delivered = Object.create(delivered);\n\t\tif (parent) {\n\t\t\tthis.parent = parent;\n\t\t}\n\t\tthis.container = container || this as any as Container;\n\t}\n\t/** 结果渲染函数 */\n\tprotected _render: () => NeepNode[] = () => [];\n\n\tget canRefresh(): boolean {\n\t\tif (wait(this)) { return false; }\n\t\treturn !this._delayedRefresh;\n\t}\n\tprotected get needRefresh(): boolean {\n\t\tif (wait(this)) { return false; }\n\t\tif (this._delayedRefresh) { return false; }\n\t\tconst needRefresh = this._needRefresh;\n\t\tthis._needRefresh = false;\n\t\treturn needRefresh;\n\t}\n\t/** 是否需要继续刷新 */\n\tprotected _needRefresh = false;\n\tprivate _delayedRefresh = 0;\n\t/** 是否为刷新中 */\n\tprivate _refreshing = false;\n\t/** 渲染结果 */\n\tprotected _nodes: (TreeNode | TreeNode[])[] = [];\n\tprotected _refresh() { }\n\tasync asyncRefresh<T>(f: () => PromiseLike<T> | T): Promise<T> {\n\t\ttry {\n\t\t\tthis._delayedRefresh++;\n\t\t\treturn await f();\n\t\t} finally {\n\t\t\tthis._delayedRefresh--;\n\t\t\tthis.refresh();\n\t\t}\n\t}\n\trefresh(): void;\n\trefresh<T>(f: () => T, async?: false): T;\n\trefresh<T>(f: () => PromiseLike<T> | T, async: true): Promise<T>;\n\trefresh<T>(\n\t\tf: () => PromiseLike<T> | T,\n\t\tasync?: boolean,\n\t): PromiseLike<T> | T;\n\trefresh<T>(\n\t\tf?: () => PromiseLike<T> | T,\n\t\tasync?: boolean,\n\t): PromiseLike<T> | T | undefined;\n\trefresh<T>(\n\t\tf?: () => PromiseLike<T> | T,\n\t\tasync?: boolean,\n\t): PromiseLike<T> | T | undefined {\n\t\tif (typeof f === 'function') {\n\t\t\tif (async) { return this.asyncRefresh(f); }\n\t\t\ttry {\n\t\t\t\tthis._delayedRefresh++;\n\t\t\t\treturn f();\n\t\t\t} finally {\n\t\t\t\tthis._delayedRefresh--;\n\t\t\t\tif (this._delayedRefresh <= 0) {\n\t\t\t\t\tthis.refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.destroyed) { return; }\n\t\tthis._needRefresh = true;\n\t\tif (!this.created) { return; }\n\n\t\tif (this._refreshing) { return; }\n\t\tthis._refreshing = true;\n\n\t\tlet nodes: NeepNode[] | undefined;\n\t\twhile(this.needRefresh) {\n\t\t\tnodes = this._render();\n\t\t\tif (this.destroyed) { return; }\n\t\t}\n\t\tthis._refreshing = false;\n\t\tif (!this.canRefresh) { return; }\n\t\tif (!nodes) { return; }\n\n\t\tthis._nodes = convert(this, nodes, this._nodes);\n\t\tif (!this.mounted) { return; }\n\t\tif (this.destroyed) { return; }\n\t\tif (this.unmounted) { return; }\n\t\tthis._refresh();\n\t}\n\tcallHook<H extends Hooks>(id: H): void;\n\tcallHook(id: string): void;\n\tcallHook(id: string): void {\n\t\tcallHook(id, this.entity);\n\t}\n\n\tchildNodes: any[] = [];\n\t/** 更新属性及子代 */\n\tprotected _update(props: object, children: any[]): void {\n\t\tthis.childNodes = children;\n\t}\n\t/** 更新属性及子代 */\n\tupdate(props: object, children: any[]): void {\n\t\tthis._update(props, children);\n\t}\n\n\n\tprivate __executed_destroy = false;\n\tprivate __executed_mount = false;\n\tprivate __executed_mounted = false;\n\tprotected _destroy() { }\n\tdestroy() {\n\t\tif (this.__executed_destroy) { return; }\n\t\tthis.__executed_destroy = true;\n\t\tthis.callHook('beforeDestroy');\n\t\tthis._destroy();\n\t\tthis.callHook('destroyed');\n\t\tthis.destroyed = true;\n\t}\n\tprotected _mount() { }\n\tmount() {\n\t\tif (this.__executed_destroy) { return; }\n\t\tif (this.__executed_mount) { return; }\n\t\tthis.__executed_mount = true;\n\t\tthis.callHook('beforeMount');\n\t\tthis._mount();\n\t\tthis.callHook('mounted');\n\t\tthis.mounted = true;\n\t}\n\tprotected _unmount() { }\n\tunmount() {\n\t\tif (!this.mounted) { return; }\n\t\tif (this.__executed_mounted) { return; }\n\t\tthis.__executed_mounted = true;\n\t\tthis.callHook('beforeUnmount');\n\t\tthis._unmount();\n\t\tthis.callHook('unmounted');\n\t\tthis.unmounted = true;\n\t}\n\t_draw() {}\n\tdraw() {\n\t\tif (this.__executed_destroy) { return; }\n\t\tthis.callHook('beforeUpdate');\n\t\tthis._draw();\n\t\tthis.callHook('updated');\n\t}\n}\n","import { Component, NeepNode, Slots, Context, Delivered } from '../type';\nimport auxiliary from '../auxiliary';\nimport { monitorable } from '../install';\nimport { setCurrent } from '../helper/current';\nimport convert, { destroy, TreeNode } from './convert';\nimport draw, { unmount, MountedNode } from './draw';\nimport normalize from './normalize';\nimport { getSlots, setSlots } from './slot';\nimport NeepObject from './Object';\nimport { initContext } from '../helper/context';\nimport { updateProps } from './props';\n\nfunction update(\n\tnObject: Entity<any, any>,\n\tprops: any,\n\tchildren:any[],\n) {\n\tupdateProps(nObject.props, props);\n\n\tconst slots = Object.create(null);\n\tconst {\n\t\tnative,\n\t\tcontainer: { iRender },\n\t} = nObject;\n\tconst childNodes = getSlots(\n\t\tiRender,\n\t\tchildren,\n\t\tslots,\n\t\tBoolean(native),\n\t);\n\tsetSlots(slots, nObject.slots);\n\tif (!native) { return; }\n\tnObject.nativeNodes\n\t\t= convert(nObject, childNodes, nObject.nativeNodes);\n}\n\nfunction createContext<\n\tP extends object = object,\n\tR extends object = object\n>(nObject: Entity<P, R>): Context {\n\treturn initContext({\n\t\tslots: nObject.slots,\n\t\tget created() { return nObject.created; },\n\t\tget parent() { return nObject.parent.exposed; },\n\t\tget delivered() { return nObject.parentDelivered; },\n\t\tget children() { return nObject.children; },\n\t\tget childNodes() { return nObject.childNodes; },\n\t\trefresh(f) { nObject.refresh(f); }\n\t}, nObject.exposed);\n}\n\n/** 初始化渲染 */\nfunction initRender<R extends object = object>(\n\tnObject: Entity<any, R>\n): { render(): any, nodes: any, stopRender(): void } {\n\tconst {\n\t\tcomponent,\n\t\tprops,\n\t\tcontext,\n\t\tentity,\n\t} = nObject;\n\tconst refresh = (changed: boolean) => changed && nObject.refresh()\n\t// 初始化执行\n\tconst result = monitorable.exec(() => setCurrent(\n\t\t() => component(props, context, auxiliary),\n\t\tentity,\n\t), refresh, { resultOnly: true, postpone: true });\n\tif (typeof result === 'function') {\n\t\t// 响应式\n\t\tconst render = monitorable.createExecutable(\n\t\t\t() => normalize(nObject, (result as () => NeepNode)()),\n\t\t\trefresh,\n\t\t);\n\t\treturn {\n\t\t\tnodes: render(),\n\t\t\trender,\n\t\t\tstopRender: () => render.stop(),\n\t\t};\n\t}\n\n\tconst render = monitorable.createExecutable(\n\t\t() => normalize(nObject, setCurrent(\n\t\t\t() => component(props, context, auxiliary),\n\t\t\tentity,\n\t\t)),\n\t\trefresh,\n\t\t{ postpone: true },\n\t);\n\treturn {\n\t\tnodes: monitorable.exec(\n\t\t\t() => normalize(nObject, result),\n\t\t\trefresh,\n\t\t\t{ resultOnly: true, postpone: true },\n\t\t),\n\t\trender,\n\t\tstopRender: () => render.stop(),\n\t};\n}\n\n\nexport default class Entity<\n\tP extends object = object,\n\tR extends object = object\n> extends NeepObject {\n\t/** 组件函数 */\n\treadonly component: Component<P, R>;\n\t/** 组件属性 */\n\treadonly props: P = monitorable.encase(Object.create(null));\n\t/** 组件槽 */\n\treadonly slots: Slots = monitorable.encase(Object.create(null));\n\t/** 结果渲染函数 */\n\tprivate readonly _stopRender:() => void;\n\t/** 原生子代 */\n\tnativeNodes: (TreeNode | TreeNode[])[] | undefined;\n\tnativeTree: (MountedNode | MountedNode[])[] = [];\n\t/** 组件上下文 */\n\treadonly context: Context;\n\treadonly parent: NeepObject;\n\t/** 结果渲染函数 */\n\tconstructor(\n\t\tcomponent: Component<P, R>,\n\t\tprops: object,\n\t\tchildren: any[],\n\t\tparent: NeepObject,\n\t\tdelivered?: Delivered,\n\t) {\n\t\tsuper(parent.iRender, parent, delivered, parent.container);\n\t\tthis.component = component;\n\t\tReflect.defineProperty(\n\t\t\tthis.exposed,\n\t\t\t'$component',\n\t\t\t{ value: component, enumerable: true, configurable: true },\n\t\t);\n\t\t// // 原生组件\n\t\t// const native = nativeRender.component\n\t\t// \t&& component[typeSymbol] === 'native' && false;\n\t\t// // 原生组件\n\t\t// const nativeComponent = native\n\t\t// \t? nativeRender.component!()\n\t\t// \t: null;\n\t\t// this.native = nativeComponent;\n\t\t// 父子关系\n\t\tthis.parent = parent;\n\t\tparent.children.add(this.exposed);\n\t\t// 上下文属性\n\t\tconst context = createContext(this);\n\t\tthis.context = context;\n\t\t// 初始化钩子\n\t\tthis.callHook('beforeCreate');\n\t\t// 更新属性\n\t\tthis.childNodes = children;\n\t\tupdate(this, props, children);\n\t\t// 获取渲染函数及初始渲染\n\t\tconst { render, nodes, stopRender } = initRender(this);\n\t\tthis._render = render;\n\t\tthis._stopRender = stopRender;\n\t\tthis._nodes = convert(this, nodes);\n\t\t// 初始化钩子\n\t\tthis.callHook('created');\n\t\tthis.created = true;\n\t\tif (this._needRefresh) { this.refresh(); }\n\t}\n\t/** 更新属性及子代 */\n\t_update(props: object, children: any[]): void {\n\t\tif (this.destroyed) { return; }\n\t\tthis.childNodes = children;\n\t\tupdate(this, props, children);\n\t}\n\t_destroy() {\n\t\tif (this._stopRender) {\n\t\t\tthis._stopRender();\n\t\t}\n\t\tthis.parent.children.delete(this.exposed);\n\t\tdestroy(this._nodes);\n\t}\n\n\t/** 刷新 */\n\t_refresh() {\n\t\tthis.container.markDraw(this);\n\t}\n\t_draw() {\n\t\tthis.tree = draw(\n\t\t\tthis.container.iRender,\n\t\t\tthis._nodes,\n\t\t\tthis.tree,\n\t\t);\n\t\tconst {native} = this;\n\t\tif (native) {\n\t\t\t// const shadow = this.container.iRender.shadow!(native);\n\t\t\t// TODO: 更新 childNodes\n\t\t}\n\t}\n\t_mount() {\n\t\tthis.tree = draw(this.container.iRender, this._nodes);\n\t}\n\t_unmount() {\n\t\tunmount(this.container.iRender, this.tree);\n\t}\n}\n","import { getRender } from '../install';\nimport { NeepNode, NeepElement, Tag } from '../type';\nimport { Tags, isElement, Value, Template } from '../auxiliary';\nimport { isElementSymbol, typeSymbol } from '../symbols';\nimport { recursive2iterable } from './recursive';\nimport Entity from './Entity';\nimport NeepObject from './Object';\nimport Container from './Container';\nimport { updateProps } from './props';\n\nexport interface TreeNode\n\textends Omit<\n\t\tNeepElement,\n\t\t'children' | 'tag' | typeof isElementSymbol\n\t>\n{\n\t/** 标签名 */\n\ttag: Tag;\n\tchildren: (this | this[])[];\n\tmounted?: boolean;\n\tcomponent?: NeepObject;\n}\n/** 强制转换为 NeepElement */\nfunction toElement(t: any): null | NeepElement {\n\tif (t === false || t === null || t === undefined) {\n\t\treturn null;\n\t}\n\tif (isElement(t)) {\n\t\treturn t;\n\t}\n\treturn {\n\t\t[isElementSymbol]: true,\n\t\ttag: Value,\n\t\tkey: t,\n\t\tvalue: t,\n\t\tchildren: [],\n\t};\n}\n\nexport function destroy(\n\ttree: TreeNode | TreeNode[] | (TreeNode | TreeNode[])[]\n) {\n\tif (Array.isArray(tree)) {\n\t\ttree.forEach(t => destroy(t));\n\t\treturn;\n\t}\n\tconst { component } = tree;\n\tif (component) { component.destroy(); }\n}\n\nfunction createItem(\n\tnObject: NeepObject,\n\tsource: NeepNode,\n): TreeNode {\n\tif (!source) { return { tag: null, children: [] }; }\n\tconst { tag } = source;\n\tif (!tag) { return { tag: null, children: [] }; }\n\tif (typeof tag !== 'string') {\n\t\tif (tag[typeSymbol] === 'simple') {\n\t\t\treturn {\n\t\t\t\t...source,\n\t\t\t\tchildren: convert(nObject, source.children),\n\t\t\t\tcomponent: undefined,\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\t...source, children: [],\n\t\t\tcomponent: new Entity(\n\t\t\t\ttag,\n\t\t\t\tsource.props || {},\n\t\t\t\tsource.children,\n\t\t\t\tnObject,\n\t\t\t\tsource.$__neep__delivered,\n\t\t\t),\n\t\t};\n\t}\n\tif (tag === Tags.Container) {\n\t\tconst type = source?.props?.type;\n\t\tconst iRender = type ? getRender(type) : nObject.iRender;\n\t\treturn {\n\t\t\t...source, children: [],\n\t\t\tcomponent: new Container(\n\t\t\t\tiRender,\n\t\t\t\tsource.props || {},\n\t\t\t\tsource.children,\n\t\t\t\tnObject,\n\t\t\t\tsource.$__neep__delivered,\n\t\t\t),\n\t\t};\n\t}\n\tif (tag === Tags.Value) {\n\t\treturn { ...source, children: [] };\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\treturn {\n\t\t\t...source,\n\t\t\tchildren: convert(nObject, source.children),\n\t\t};\n\t}\n\treturn {...source, children: convert(nObject, source.children) };\n}\n\n/**\n * 更新树节点\n * @param nObject Neep 对象\n * @param source 用于替换的源\n * @param tree 已有树\n */\nfunction updateList(\n\tnObject: NeepObject,\n\tsource: any[],\n\ttree: TreeNode | TreeNode[],\n): TreeNode[] {\n\tif (!Array.isArray(tree)) { tree = [tree]; }\n\tconst newList: TreeNode[] = [];\n\tfor (const src of recursive2iterable(source)) {\n\t\tconst node = toElement(src);\n\t\tif (!node) { continue; }\n\t\tconst index = tree.findIndex(it =>\n\t\t\tit.tag === node.tag && it.key === node.key\n\t\t);\n\t\tif (index >= 0) {\n\t\t\tnewList.push(updateItem(nObject, node, tree[index]));\n\t\t\ttree.splice(index, 1);\n\t\t} else {\n\t\t\tnewList.push(createItem(nObject, node));\n\t\t}\n\t}\n\tdestroy(tree);\n\treturn newList;\n}\n\n/**\n * 更新树节点\n * @param tree 已有树\n * @param source 用于替换的源\n * @param nObject Neep 对象\n */\nfunction updateItem(\n\tnObject: NeepObject,\n\tsource: NeepNode,\n\ttree?: TreeNode | TreeNode[],\n): TreeNode {\n\tif (!tree) {\n\t\treturn createItem(nObject, source);\n\t}\n\tif (!source) {\n\t\tdestroy(tree);\n\t\treturn { tag: null, children: [] };\n\t}\n\tif (Array.isArray(tree)) {\n\t\tif (!tree.length) { return createItem(nObject, source); }\n\t\tconst index = tree.findIndex(it => it.tag === source.tag);\n\t\tif (index < 0) {\n\t\t\tdestroy(tree);\n\t\t\treturn createItem(nObject, source);\n\t\t}\n\t\tconst all = tree;\n\t\t[tree] = tree.splice(index, 1);\n\t\tdestroy(all);\n\t}\n\tconst { tag } = source;\n\tif (tag !== tree.tag) {\n\t\tdestroy(tree);\n\t\treturn createItem(nObject, source);\n\t}\n\tif (!tag) { return { tag: null, children: [] }; }\n\tif (typeof tag !== 'string') {\n\t\tif (tag[typeSymbol] === 'simple') {\n\t\t\treturn {\n\t\t\t\t...source,\n\t\t\t\tchildren: convert(\n\t\t\t\t\tnObject,\n\t\t\t\t\tsource.children,\n\t\t\t\t\ttree.children,\n\t\t\t\t),\n\t\t\t\tcomponent: undefined,\n\t\t\t};\n\t\t}\n\t\tconst { component } = tree;\n\t\tif (!component) { return createItem(nObject, source); }\n\t\tcomponent!.update(source.props || {}, source.children);\n\t\treturn { ...source, children: [], component };\n\t}\n\tif (tag === Tags.Container) {\n\t\tconst { component } = tree;\n\t\tif (!component) { return createItem(nObject, source); }\n\t\tconst type = source?.props?.type;\n\t\tconst iRender = type ? getRender(type) : nObject.iRender;\n\t\tif (iRender !== component.iRender) {\n\t\t\treturn createItem(nObject, source);\n\t\t}\n\t\tcomponent!.update(source.props || {}, source.children);\n\t\treturn { ...source, children: [], component };\n\t}\n\tif (tag === Tags.Value) {\n\t\treturn { ...source, children: [] };\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\tlet delivered: any;\n\t\tif (Tags.Deliver === tag) {\n\t\t\tconst props = { ...source.props };\n\t\t\tdelete props.ref;\n\t\t\tdelete props.slot;\n\t\t\tdelete props.key;\n\t\t\tdelivered = updateProps(\n\t\t\t\ttree.$__neep__delivered,\n\t\t\t\tprops,\n\t\t\t\ttree.props,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\t\treturn {\n\t\t\t...source,\n\t\t\t$__neep__delivered: delivered,\n\t\t\tchildren: convert(\n\t\t\t\tnObject,\n\t\t\t\tsource.children,\n\t\t\t\ttree.children,\n\t\t\t),\n\t\t};\n\t}\n\treturn {\n\t\t...source,\n\t\tchildren: convert(nObject, source.children, tree.children),\n\t};\n}\n\n\nfunction createAll(\n\tnObject: NeepObject,\n\tsource: any[],\n): (TreeNode | TreeNode[])[] {\n\tif (!source.length) { return []; }\n\treturn (source as any[]).map(item => {\n\t\tif (!Array.isArray(item)) {\n\t\t\treturn createItem(nObject, toElement(item));\n\t\t}\n\t\treturn [...recursive2iterable(item)]\n\t\t\t.map(it => createItem(nObject, toElement(it)));\n\t});\n}\nfunction *updateAll(\n\tnObject: NeepObject,\n\tsource: any[],\n\ttree: (TreeNode | TreeNode[])[],\n): Iterable<TreeNode | TreeNode[]> {\n\tlet index = 0;\n\tlet length = Math.min(source.length, source.length);\n\tfor (; index < length; index++) {\n\t\tconst src = source[index];\n\t\tif (Array.isArray(src)) {\n\t\t\tyield updateList(nObject, src, tree[index]);\n\t\t} else {\n\t\t\tyield updateItem(nObject, toElement(src), tree[index]);\n\t\t}\n\t}\n\tlength = Math.max(source.length, source.length);\n\tif (tree.length > length) {\n\t\t\t// 销毁多余项\n\t\t\tfor (; index < length; index++) {\n\t\t\t\tdestroy(tree[index]);\n\t\t\t}\n\t}\n\tif (source.length > length) {\n\t\t// 创建多余项\n\t\tfor (; index < length; index++) {\n\t\t\tconst src = source[index];\n\t\t\tif (Array.isArray(src)) {\n\t\t\t\tyield [...recursive2iterable(src)]\n\t\t\t\t\t.map(it => createItem(nObject, it));\n\t\t\t} else {\n\t\t\t\tyield createItem(nObject, src);\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * 更新树\n * @param source 用于替换的源\n * @param nObject Neep 对象\n * @param tree 已有树\n */\nfunction convert(\n\tnObject: NeepObject,\n\tsource: any,\n\ttree?: (TreeNode | TreeNode[])[],\n): (TreeNode | TreeNode[])[] {\n\tif (!Array.isArray(source)) { source = []; }\n\tif (!tree) {\n\t\treturn createAll(nObject, source);\n\t}\n\treturn [...updateAll(nObject, source, tree)];\n}\n\n\nexport default convert;\n","import {\n\tIRender,\n\tMountProps,\n\tNativeNode,\n\tNativeContainer,\n\tDelivered,\n} from '../type';\nimport { Tags } from '../auxiliary';\nimport { createMountedNode } from './id';\nimport convert, { destroy } from './convert';\nimport draw, { unmount, getNodes, MountedNode } from './draw';\nimport NeepObject from './Object';\nimport { nextFrame } from '../install';\n\n\nlet awaitDraw = new Set<Container>();\nlet requested = false;\nfunction markDraw(c: Container) {\n\tawaitDraw.add(c);\n\tif (requested) { return; }\n\trequested = true;\n\tnextFrame(() => {\n\t\trequested = false;\n\t\tconst list = [...awaitDraw];\n\t\tawaitDraw.clear();\n\t\tlist.map(c => c.drawAll());\n\t});\n}\n\nexport default class Container extends NeepObject {\n\tprops: MountProps;\n\t/** 组件树结构 */\n\tcontent: (MountedNode | MountedNode[])[] = [];\n\t_node: NativeNode | null = null;\n\t_container: NativeContainer | null = null;\n\treadonly rootContainer: Container = this;\n\tconstructor(\n\t\tiRender: IRender,\n\t\tprops: MountProps,\n\t\tchildren: any[],\n\t\tparent?: NeepObject,\n\t\tdelivered?: Delivered,\n\t) {\n\t\tsuper(iRender, parent, delivered);\n\t\tthis.props = props;\n\t\tthis.parent = parent;\n\t\tif (parent) {\n\t\t\tthis.rootContainer = parent.container.rootContainer;\n\t\t}\n\t\tthis.callHook('beforeCreate');\n\t\tthis._render = () => children;\n\t\tthis._nodes = convert(this, children);\n\t\tthis.callHook('created');\n\t\tthis.created = true;\n\t}\n\t_drawChildren = false;\n\t_drawContainer = false;\n\tsetChildren(children: any[]): void {\n\t\tif (this.destroyed) { return; }\n\t\tthis.childNodes = children;\n\t\tthis._render = () => children;\n\t\tthis._drawChildren = true;\n\t\tthis.refresh();\n\t}\n\tsetProps(props: MountProps): void {\n\t\tif (this.destroyed) { return; }\n\t\tthis.props = props;\n\t\tthis._drawContainer = true;\n\t\tthis.refresh();\n\t}\n\t/** 更新属性及子代 */\n\tupdate(props: MountProps, children: any[]): void {\n\t\tthis.refresh(() => {\n\t\t\tthis.setProps(props);\n\t\t\tthis.setChildren(children);\n\t\t});\n\t}\n\t_refresh() {\n\t\tthis.markDraw(this);\n\t}\n\t_mount() {\n\t\tconst { props, parent, iRender } = this;\n\t\tconst content = draw(this.container.iRender, this._nodes);\n\t\tthis.content = content;\n\t\tconst [container, node]\n\t\t\t= iRender.mount(props, parent?.iRender);\n\t\tfor (const it of getNodes(content)) {\n\t\t\tiRender.insert(container, it);\n\t\t}\n\t\tthis.tree = [createMountedNode({\n\t\t\ttag: Tags.Value,\n\t\t\tcomponent: undefined,\n\t\t\tnode,\n\t\t\tvalue: node,\n\t\t\tchildren: [],\n\t\t})];\n\t\tthis._node = node;\n\t\tthis._container = container;\n\t}\n\t_destroy() {\n\t\tdestroy(this.content);\n\t}\n\t_unmount() {\n\t\tconst { parent, iRender } = this;\n\t\tif (parent) {\n\t\t\tunmount(parent.iRender, this.tree);\n\t\t}\n\t\tiRender.unmount(\n\t\t\tthis._container!,\n\t\t\tthis._node!,\n\t\t\tBoolean(parent),\n\t\t);\n\t\tunmount(this.iRender, this.content);\n\t}\n\t_draw() {\n\t}\n\tdrawSelf() {\n\t\tif (!this.mounted) { return; }\n\t\tif (this.destroyed) { return; }\n\t\tconst {\n\t\t\t_drawChildren: drawChildren,\n\t\t\t_drawContainer: drawContainer,\n\t\t} = this;\n\t\tthis._needDraw = false;\n\t\tthis._drawChildren = false;\n\t\tthis._drawContainer = false;\n\t\tthis.callHook('beforeUpdate');\n\t\tif (drawContainer) {\n\t\t\tthis.iRender.drawContainer(\n\t\t\t\tthis._container!,\n\t\t\t\tthis._node!,\n\t\t\t\tthis.props,\n\t\t\t\tthis.parent?.iRender,\n\t\t\t);\n\t\t}\n\t\tif (drawChildren) {\n\t\t\tthis.content = draw(\n\t\t\t\tthis.iRender,\n\t\t\t\tthis._nodes,\n\t\t\t\tthis.content,\n\t\t\t);\n\t\t}\n\t\tthis.callHook('updated');\n\t}\n\t/** 等待重画的项目 */\n\tprivate _awaitDraw = new Set<NeepObject>();\n\t/** 自身是否需要重绘 */\n\tprivate _needDraw = false;\n\t/** 标记需要绘制的元素 */\n\tmarkDraw(\n\t\tnObject: NeepObject,\n\t\tremove = false,\n\t) {\n\t\tif (nObject === this) {\n\t\t\tthis._needDraw = !remove;\n\t\t} else if (remove) {\n\t\t\tthis._awaitDraw.delete(nObject);\n\t\t} else {\n\t\t\tthis._awaitDraw.add(nObject);\n\t\t}\n\t\tthis.rootContainer.markDrawContainer(\n\t\t\tthis,\n\t\t\t!this._needDraw && !this._awaitDraw.size || this.destroyed,\n\t\t);\n\t}\n\tdrawContainer() {\n\t\tconst {\n\t\t\t_node: node,\n\t\t\t_container: container,\n\t\t\t_awaitDraw: awaitDraw,\n\t\t} = this;\n\t\tif (!node || !container) { return; }\n\t\tthis.callHook('beforeDraw');\n\t\tconst needDraw = this._needDraw;\n\t\tthis._needDraw = false;\n\t\tconst list = [...awaitDraw];\n\t\tawaitDraw.clear();\n\t\tif (needDraw) { this.drawSelf(); }\n\t\tlist.map(c => c.draw());\n\t\tthis.iRender.draw(container, node);\n\t\tthis.callHook('drawn');\n\t}\n\tprivate _containers = new Set<Container>();\n\tmarkDrawContainer(\n\t\tcontainer: Container,\n\t\tremove = false,\n\t) {\n\t\tif (remove) {\n\t\t\tthis._containers.delete(container);\n\t\t} else {\n\t\t\tthis._containers.add(container);\n\t\t}\n\t\tmarkDraw(this);\n\t}\n\tdrawAll() {\n\t\tconst containers = this._containers;\n\t\tif (!containers.size) { return; }\n\t\tthis.callHook('beforeDrawAll');\n\t\tconst list = [...containers];\n\t\tlist.map(c => c.drawContainer());\n\t\tthis.callHook('drawnAll');\n\t}\n}\n","import {\n\tMountProps,\n\tNeepElement,\n\tComponent,\n\tRootExposed,\n} from '../type';\nimport { isElement, createElement } from '../auxiliary';\nimport { isProduction } from '../constant';\nimport { devtools, getRender } from '../install';\nimport Container from './Container';\n\nexport function render(\n\te?: NeepElement | Component,\n\tp: MountProps = {},\n): RootExposed {\n\tlet params = {...p};\n\tconst container =  new Container(\n\t\tgetRender(p.type),\n\t\tparams,\n\t\te === undefined ? [] : isElement(e) ? [e] : [createElement(e)],\n\t);\n\tif (!isProduction) {\n\t\tdevtools.renderHook(container);\n\t}\n\tconst { exposed } = container;\n\tReflect.defineProperty(exposed, '$update', {\n\t\tvalue(c?: NeepElement | Component) {\n\t\t\tcontainer.setChildren(c === undefined ? []\n\t\t\t\t: isElement(c) ? [c] : [createElement(c)]);\n\t\t\treturn exposed;\n\t\t},\n\t\tconfigurable: true,\n\t});\n\tReflect.defineProperty(exposed, '$mount', {\n\t\tvalue(target?: any) {\n\t\t\tif (exposed.$mounted) { return exposed; }\n\t\t\tif (target) {\n\t\t\t\tparams.target = target;\n\t\t\t\tcontainer.setProps(params);\n\t\t\t}\n\t\t\tcontainer.mount();\n\t\t\treturn exposed;\n\t\t},\n\t\tconfigurable: true,\n\t});\n\tReflect.defineProperty(exposed, '$unmount', {\n\t\tvalue() {\n\t\t\tif (!exposed.$mounted) { return; }\n\t\t\tif (exposed.$unmounted) { return; }\n\t\t\tif (exposed.$destroyed) { return container.destroy(); }\n\t\t\tcontainer.unmount();\n\t\t\treturn;\n\t\t},\n\t\tconfigurable: true,\n\t});\n\tif (params.target) {\n\t\tcontainer.mount();\n\t}\n\treturn exposed as any as RootExposed;\n}\nexport { default as refresh } from './refresh';\n","import { Component, Render, Marks } from './type';\nimport { nameSymbol, typeSymbol, renderSymbol } from './symbols';\n\n/** 组件标记函数 */\nexport interface Mark {\n\t<N extends Component<any, any>>(component: N): N;\n}\n\n/**\n * 创建组件标记函数\n */\nfunction Mark<S extends keyof Marks>(\n\tsymbol: S,\n\tvalue: Component[S],\n): Mark {\n\treturn component => {\n\t\tcomponent[symbol] = value as any;\n\t\treturn component;\n\t};\n}\n\n\n/** 标记组件名称 */\nexport function mName(name: string): Mark;\nexport function mName<N extends Component<any, any>>(\n\tname: string,\n\tcomponent: N,\n): N;\nexport function mName<N extends Component<any, any>>(\n\tname: string,\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(nameSymbol, name); }\n\tcomponent[nameSymbol] = name;\n\treturn component;\n}\n\n/** 标记组件类型 */\nexport function mType(type?: 'native' | 'simple' | 'standard'): Mark;\nexport function mType<N extends Component<any, any>>(\n\ttype: 'native' | 'simple' | 'standard',\n\tcomponent: N,\n): N;\nexport function mType<N extends Component<any, any>>(\n\ttype?: 'native' | 'simple' | 'standard',\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(typeSymbol, type); }\n\tcomponent[typeSymbol] = type;\n\treturn component;\n}\n/** 标记为简单组件 */\nexport function mSimple(): Mark;\nexport function mSimple<N extends Component<any, any>>(\n\tcomponent: N,\n): N;\nexport function mSimple<N extends Component<any, any>>(\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(typeSymbol, 'simple'); }\n\tcomponent[typeSymbol] = 'simple';\n\treturn component;\n}\n/** 标记为原生组件 */\nexport function mNative(): Mark;\nexport function mNative<N extends Component<any, any>>(\n\tcomponent: N,\n): N;\nexport function mNative<N extends Component<any, any>>(\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(typeSymbol, 'native'); }\n\tcomponent[typeSymbol] = 'native';\n\treturn component;\n}\n\n/** 标记独立的渲染函数 */\nexport function mRender(fn?: Marks[typeof renderSymbol]): Mark;\nexport function mRender<N extends Component<any, any>>(\n\tfn: Marks[typeof renderSymbol] | undefined,\n\tcomponent: N,\n): N;\nexport function mRender<N extends Component<any, any>>(\n\tfn?: Marks[typeof renderSymbol] | undefined,\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(renderSymbol, fn); }\n\tcomponent[renderSymbol] = fn;\n\treturn component;\n}\n\nexport function create<P extends object>(\n\tc: Component<P, never>,\n): Component<P, never>;\nexport function create<\n\tP extends object = object,\n\tR extends object = object,\n>(c: Component<P, R>, r: Render<R>): Component<P, R>;\nexport function create<T extends Component<any, any>>(\n\tc: T,\n\tr?: Render,\n): T {\n\tif (typeof r === 'function') {\n\t\tc[renderSymbol] = r;\n\t}\n\treturn c;\n}\n\nexport function mark<N extends Component<any, any>>(\n\tcomponent: N,\n\t...marks: Mark[]\n): N {\n\tfor (const m of marks) { m(component); }\n\treturn component;\n}\n","import { install } from '.';\nimport * as monitorable from 'monitorable';\n\ninstall({ monitorable });\n\nexport * from '.'"],"names":["version","mode","isProduction","NeepError","Error","constructor","message","tag","assert","v","monitorable","nextFrameApi","nextFrame","fn","renders","Object","create","getRender","type","default","addRender","render","installRender","Array","isArray","devtools","renderHook","installDevtools","tools","install","apis","ScopeSlot","SlotRender","Slot","Value","Container","Deliver","Template","Fragment","value","computed","isValue","encase","recover","setCurrent","entity","oldEntity","current","$_valueIndex","ret","$_values","length","checkCurrent","name","initOnly","created","constructors","initContext","context","exposed","addContextConstructor","push","safeify","hooks","setHook","id","hook","list","$_hooks","set","Set","add","delete","callHook","watch","cb","stop","s","useValue","f","index","values","undefined","setValue","obj","opt","includes","Reflect","defineProperty","get","configurable","enumerable","expose","deliver","delivered","isElementSymbol","Symbol","for","typeSymbol","nameSymbol","renderSymbol","isElement","createElement","attrs","children","node","key","slot","ref","Tags","argv","args","props","on","k","onInfo","exec","nCmd","elements","n","concat","simple","label","setLabel","l","getLabel","text","color","auxiliary","State","Life","Element","Dev","Constant","setAuxiliary","defineAuxiliary","ids","Nodes","IdMap","Map","createMountedNode","recoveryMountedNode","recursive2iterable","it","getLastNode","tree","component","getFirstNode","getNodes","unmount","iRender","forEach","e","remove","replace","newTree","oldTree","next","parent","insert","updateList","source","createItem","newList","mountedMap","src","findIndex","old","item","updateItem","splice","size","filter","t","has","last","i","o","updateAll","Math","min","max","createList","all","draw","createValue","substr","update","createAll","isNode","RegExp","String","Date","toISOString","placeholder","map","mount","getSlots","slots","native","nativeList","ownKeys","el","renderSlots","createSlots","inserted","setSlots","updateProps","oldProps","define","newKeys","execSimple","nObject","container","slotMap","childNodes","refresh","result","nodes","renderNode","execSlot","slotName","newDelivered","$__neep__delivered","normalize","Boolean","delayedRefresh","objectSet","wait","run","clear","asyncRefresh","async","createExposed","cfg","$parent","$component","$isContainer","$created","$destroyed","destroyed","$mounted","mounted","$unmounted","unmounted","createEntity","isContainer","writable","h","bind","NeepObject","parentDelivered","canRefresh","_delayedRefresh","needRefresh","_needRefresh","_refresh","_refreshing","_render","_nodes","convert","_update","_destroy","destroy","__executed_destroy","_mount","__executed_mount","_unmount","__executed_mounted","_draw","nativeNodes","createContext","initRender","changed","resultOnly","postpone","createExecutable","stopRender","Entity","_stopRender","markDraw","toElement","awaitDraw","requested","c","drawAll","rootContainer","setChildren","_drawChildren","setProps","_drawContainer","content","_node","_container","drawSelf","drawChildren","drawContainer","_needDraw","_awaitDraw","markDrawContainer","needDraw","_containers","containers","p","params","target","Mark","symbol","mName","mType","mSimple","mNative","mRender","r","mark","marks","m"],"mappings":"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"}