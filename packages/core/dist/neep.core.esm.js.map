{"version":3,"file":"neep.core.esm.js","sources":["../src/constant.ts","../src/Error.ts","../src/install.ts","../src/auxiliary/tags.ts","../src/helper/current.ts","../src/helper/context.ts","../src/hook.ts","../src/auxiliary/life.ts","../src/symbols.ts","../src/auxiliary/element.ts","../src/helper/label.ts","../src/auxiliary/dev.ts","../src/auxiliary/index.ts","../src/render/id.ts","../src/render/recursive.ts","../src/render/draw.ts","../src/render/slot.ts","../src/render/props.ts","../src/render/normalize.ts","../src/render/refresh.ts","../src/render/Object.ts","../src/render/Entity.ts","../src/render/convert.ts","../src/render/Container.ts","../src/render/index.ts","../src/create.ts"],"sourcesContent":["/**\n * Global constant\n *\n * Will be replaced by the 'rollup-plugin-replace' plug-in\n */\n\n /**\n * Neep code version\n */\nexport const version = '__VERSION__' as string;\n/**\n * Current mode\n * @enum production\n * @enum development\n */\nexport const mode = '__MODE__' as any as 'production' | 'development';\n/**\n * Is the current mode production mode\n * @description Support tree shaking\n */\nexport const isProduction = mode === 'production';\n","export default class NeepError extends Error {\n\treadonly tag: string;\n\tconstructor(message: string, tag: string = '') {\n\t\tsuper(tag ? `[${tag}] ${message}` : message);\n\t\tthis.tag = tag;\n\t}\n}\nexport function assert(v: any, message: string, tag?: string) {\n\tif (v) { return; }\n\tthrow new NeepError(message, tag);\n}","import * as monitorableApi from 'monitorable';\nimport { IRender } from './type';\nimport { isProduction } from './constant';\n\nimport { Devtools } from '../../devtools/src/type';\nimport { assert } from './Error';\n\nexport let monitorable: typeof monitorableApi;\n\nexport let value: typeof monitorableApi.value;\nexport let computed: typeof monitorableApi.computed;\nexport let isValue: typeof monitorableApi.isValue;\nexport let encase: typeof monitorableApi.encase;\nexport let recover: typeof monitorableApi.recover;\n\nfunction installMonitorable(api?: typeof monitorableApi) {\n\tif (!api) { return; }\n\tmonitorable = api;\n\tvalue = monitorable.value;\n\tcomputed = monitorable.computed;\n\tisValue = monitorable.isValue;\n\tencase = monitorable.encase;\n\trecover = monitorable.recover;\n}\n\nexport interface InstallOptions {\n\tmonitorable?: typeof monitorableApi;\n\trender?: IRender;\n\trenders?: IRender[];\n\tdevtools?: any;\n}\n\n\nlet nextFrameApi: undefined | ((fn: () => void) => void);\nexport function nextFrame(fn: () => void): void {\n\tassert(nextFrameApi, 'The basic renderer is not installed', 'install');\n\tnextFrameApi!(fn);\n}\n\nexport const renders: Record<string, IRender>\n\t= Object.create(null);\n\nexport function getRender(\n\ttype: string | number | IRender = ''\n\t): IRender {\n\tif (typeof type === 'object') { return type; }\n\treturn renders[type] || renders.default;\n}\n\nfunction addRender(render?: IRender): void {\n\tif (!render) { return; }\n\trenders[render.type] = render;\n\tif (nextFrameApi) { return; }\n\tif (!renders.default) {\n\t\trenders.default = render;\n\t}\n\tif (!nextFrameApi && render.nextFrame) {\n\t\trenders.default = render;\n\t\tnextFrameApi = render.nextFrame;\n\t}\n\n}\nfunction installRender({ render, renders}: InstallOptions) {\n\taddRender(render);\n\tif (!Array.isArray(renders)) { return; }\n\tfor (const render of renders) {\n\t\taddRender(render);\n\t}\n}\n\n\nexport const devtools: Devtools = {\n\trenderHook(){},\n};\n\nfunction installDevtools(tools?: Partial<Devtools>) {\n\tif (!tools) { return; }\n\tif (typeof tools !== 'object') { return; }\n\tconst { renderHook } = tools;\n\tif (typeof renderHook === 'function') {\n\t\tdevtools.renderHook = renderHook;\n\t}\n}\n\n\nexport default function install(apis: InstallOptions) {\n\tinstallMonitorable(apis.monitorable);\n\tinstallRender(apis);\n\tif (!isProduction) {\n\t\tinstallDevtools(apis.devtools);\n\t}\n}\n","export const ScopeSlot = 'Neep:ScopeSlot';\nexport const SlotRender = 'Neep:SlotRender';\nexport const Slot = 'Neep:Slot';\nexport const Value = 'Neep:Value';\nexport const Container = 'Neep:Container';\nexport const Deliver = 'Neep:Deliver';\nexport const Template = 'template';\nexport const Fragment = Template;\n","import NeepError from '../Error';\nimport { Entity } from '../type';\n\n/** 当前正在执行的对象 */\nexport let current: Entity | undefined;\nexport function setCurrent<T>(\n\tfn: () => T,\n\tentity: Entity,\n): T {\n\tconst oldEntity = current;\n\tcurrent = entity;\n\ttry {\n\t\tcurrent.$_valueIndex = 0;\n\t\tconst ret = fn();\n\t\tif (current.$_valueIndex !== current.$_values.length) {\n\t\t\tthrow new NeepError(\n\t\t\t\t'Inconsistent number of useValue executions',\n\t\t\t\t'life',\n\t\t\t);\n\t\t}\n\t\treturn ret;\n\t} finally {\n\t\tcurrent = oldEntity;\n\t}\n}\n\nexport function checkCurrent(\n\tname: string,\n\tinitOnly = false,\n): Entity {\n\tif (!current) {\n\t\tthrow new NeepError(\n\t\t\t`Function \\`${name}\\` can only be called within a cycle.`,\n\t\t\t'life',\n\t\t);\n\t}\n\tif (!initOnly) {\n\t\treturn current;\n\t}\n\tif (!current.created) {\n\t\treturn current;\n\t}\n\tthrow new NeepError(\n\t\t`Function \\`${name}\\` can only be called at initialization time.`,\n\t\t'life',\n\t);\n}\n","import { Context, ContextConstructor, Exposed } from '../type';\nimport { monitorable } from '../install';\n\nconst constructors: ContextConstructor[] = [];\nexport function initContext(\n\tcontext: Context,\n\texposed?: Exposed,\n): Context {\n\tfor (const constructor of constructors) {\n\t\tconstructor(context, exposed);\n\t}\n\treturn context;\n}\nexport function addContextConstructor(\n\tconstructor: ContextConstructor\n): void {\n\tconstructors.push(monitorable.safeify(constructor));\n}","import { monitorable } from './install';\nimport { Hook, Hooks, Entity } from './type';\nconst hooks: Record<string, Set<Hook>> = Object.create(null);\n\nexport function setHook<H extends Hooks>(\n\tid: H,\n\thook: Hook,\n\tentity?: Entity,\n):() => void;\nexport function setHook(\n\tid: string,\n\thook: Hook,\n\tentity?: Entity,\n): () => void;\n\nexport function setHook(\n\tid: string,\n\thook: Hook,\n\tentity?: Entity,\n):() => void {\n\tlet list = entity?.$_hooks || hooks;\n\tif (!list) { return () => {}; }\n\thook = monitorable.safeify(hook);\n\tlet set = list[id];\n\tif (!set) {\n\t\tset = new Set();\n\t\tlist[id] = set;\n\t}\n\tset.add(hook);\n\treturn () => set.delete(hook);\n}\n\nexport function callHook<H extends Hooks>(\n\tid: H,\n\texposed: Entity,\n): void;\nexport function callHook(id: string, exposed: Entity): void;\nexport function callHook(id: string, exposed: Entity): void {\n\tif (!exposed) { return; }\n\tfor (const hook of exposed.$_hooks[id] || []) {\n\t\thook(exposed);\n\t}\n\tfor (const hook of hooks[id] || []) {\n\t\thook(exposed);\n\t}\n}\n","/**********************************\n * 组件上下文环境专用 API\n * @description 简单组件不支持\n **********************************/\nimport { Value, WatchCallback } from 'monitorable';\nimport { Hooks } from '../type';\nimport { checkCurrent } from '../helper';\nimport NeepError from '../Error';\nimport { setHook } from '../hook';\nimport { isValue, value, computed } from './state';\n\n\n/**********************************\n * 状态管理类 API\n **********************************/\n/**\n * 监听指定值的变化\n * @description 本质是调用 Value 对象的 watch 方法\n * @description 但是通过此方法进行的观察，会在组件生命周期结束时自动停止观察\n * @description 此函数只有在初始化调用时有效\n * @param value 被监听的值\n * @param cb    当监听的值发送变化时调用的函数\n */\nexport function watch<T>(\n\tvalue: Value<T>,\n\tcb: WatchCallback<T>,\n): () => void;\n/**\n * 监听指定值的变化\n * @description 本质是创建调用 Value 对象的 watch 方法\n * @description 但是通过此方法进行的观察，会在组件生命周期结束时自动停止观察\n * @description 此函数只有在初始化调用时有效\n * @param value 用于计算观测值的函数\n * @param cb    当监听的值发送变化时调用的函数\n */\nexport function watch<T>(\n\tvalue: () => T,\n\tcb: (v: T, stopped: boolean) => void,\n): () => void;\n\nexport function watch<T>(\n\tvalue: Value<T> | (() => T),\n\tcb: (v: Value<T> | T, stopped: boolean) => void\n): () => void {\n\tconst entity = checkCurrent('watch');\n\tif (typeof value !== 'function') { return () => {}; }\n\tconst stop = isValue(value)\n\t\t? value.watch(cb)\n\t\t: computed(value).watch((v, s) => cb(v(), s));\n\tsetHook('beforeDestroy', () => stop(), entity);\n\treturn stop;\n}\n\nexport function useValue(): Value<any>;\nexport function useValue<T>(fn: () => T, name?: string): T;\nexport function useValue<T>(fn?: () => T, name?: string): T | Value<any>;\nexport function useValue<T>(fn?: () => T, name = 'useValue'): T | Value<any> {\n\tconst entity = checkCurrent(name);\n\tconst index = entity.$_valueIndex++;\n\tconst values = entity.$_values;\n\tif (!entity.created) {\n\t\tvalues[index] = undefined;\n\t\tconst v = typeof fn === 'function' ? fn() : value(undefined);\n\t\treturn values[index] = v;\n\t}\n\tif (index >= values.length) {\n\t\tthrow new NeepError(\n\t\t\t'Inconsistent number of useValue executions',\n\t\t\t'life',\n\t\t);\n\t}\n\treturn values[index];\n\n}\n\n/**********************************\n * 钩子类 API\n **********************************/\n/**\n * 为当前组件注册钩子\n * @param name 钩子名称\n * @param hook 钩子\n * @param initOnly 是否仅在初始化时有效\n */\nexport function hook<H extends Hooks>(\n\tname: H,\n\thook: () => void,\n\tinitOnly?: boolean,\n): undefined | (() => void);\nexport function hook(\n\tname: string,\n\thook: () => void,\n\tinitOnly?: boolean,\n): undefined | (() => void);\nexport function hook(\n\tname: string,\n\thook: () => void,\n\tinitOnly?: boolean,\n): undefined | (() => void) {\n\tconst entity = checkCurrent('setHook');\n\tif (initOnly && entity.created) { return undefined; }\n\treturn setHook(name, () => hook(), entity);\n}\n\n/**********************************\n * 配置 API\n **********************************/\n\nexport function setValue<T>(\n\tobj: any,\n\tname: string | number | symbol,\n\tvalue: T | Value<T> | (() => T),\n\topt?: boolean | ((value: T) => void),\n): void {\n\tif (\n\t\ttypeof name === 'string'\n\t\t&& ['$', '_'].includes(name[0])\n\t) {\n\t\treturn;\n\t}\n\tif (isValue(value) && opt) {\n\t\tReflect.defineProperty(obj, name, {\n\t\t\tget() { return value(); },\n\t\t\tset(v) { value(v); },\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t});\n\t\treturn;\n\t}\n\tif (typeof value === 'function' && opt) {\n\t\tReflect.defineProperty(obj, name, {\n\t\t\tget: value as () => T,\n\t\t\tset: typeof opt === 'function' ? opt : undefined,\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t});\n\t\treturn;\n\t}\n\tReflect.defineProperty(obj, name, {\n\t\tget() { return value; },\n\t\tconfigurable: true,\n\t\tenumerable: true,\n\t});\n}\n\n\n/**\n * 将 Value 导出\n * @param name 导出用的名称\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tvalue: Value<T>,\n\tmix?: boolean,\n): void;\n/**\n * 将普通值导出\n * @param name\n * @param value\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tvalue: T,\n): void;\n/**\n * 设置基于 getter 的导出\n * @param name\n * @param getter\n * @param nonModifiable\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tnonModifiable: true,\n): void;\n/**\n * 设置基于 getter/setter 的导出\n * @param name\n * @param getter\n * @param setter\n */\nexport function expose<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tsetter: (value: T) => void,\n): void;\nexport function expose<T>(\n\tname: string | number | symbol,\n\tvalue: T | Value<T> | (() => T),\n\topt?: boolean | ((value: T) => void),\n): void {\n\tsetValue(checkCurrent('expose', true).exposed, name, value, opt);\n}\n\n\n/**\n * 将 Value 传递给子组件\n * @param name 导出用的名称\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tvalue: Value<T>,\n\tmix?: boolean,\n): void;\n/**\n * 将普通值导出\n * @param name\n * @param value\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tvalue: T,\n): void;\n/**\n * 设置基于 getter 的传递\n * @param name\n * @param getter\n * @param nonModifiable\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tnonModifiable: true,\n): void;\n/**\n * 设置基于 getter/setter 的传递\n * @param name\n * @param getter\n * @param setter\n */\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tgetter: () => T,\n\tsetter: (value: T) => void,\n): void;\nexport function deliver<T>(\n\tname: string | number | symbol,\n\tvalue: T | Value<T> | (() => T),\n\topt?: boolean | ((value: T) => void),\n): void {\n\tsetValue(checkCurrent('deliver', true).delivered, name, value, opt);\n}\n","export const isElementSymbol = Symbol.for('isNeepElement');\nexport const typeSymbol = Symbol.for('type');\nexport const nameSymbol = Symbol.for('name');\nexport const renderSymbol = Symbol.for('render');\n","import { Tag, NeepElement, Component } from '../type';\nimport { isElementSymbol, typeSymbol } from '../symbols';\nimport * as Tags from './tags';\n\n/**\n * 判读是否为元素\n */\nexport function isElement(v: any): v is NeepElement {\n\tif (!v) { return false; }\n\tif (typeof v !== 'object') { return false; }\n\treturn v[isElementSymbol] === true;\n}\n\nexport function createElement(\n\ttag: Tag,\n\tattrs?: {[key:string]: any},\n\t...children: any[]\n): NeepElement {\n\tattrs = attrs ? {...attrs} : {};\n\tconst node: NeepElement = {\n\t\t[isElementSymbol]: true,\n\t\ttag,\n\t\tchildren: [],\n\t};\n\tif ('key' in attrs) { node.key = attrs.key; }\n\tif ('slot' in attrs) { node.slot = attrs.slot; }\n\tif (typeof attrs.ref === 'function') { node.ref = attrs.ref; }\n\tif (tag === Tags.Value) {\n\t\tnode.value = attrs.value;\n\t\treturn node;\n\t}\n\tnode.children = children;\n\tif (tag === Tags.Template) { return node; }\n\tif (tag === Tags.SlotRender) {\n\t\tnode.render = attrs.render;\n\t\treturn node;\n\t}\n\tif (tag === Tags.ScopeSlot || tag === Tags.Slot) {\n\t\tconst { render, argv, args, name } = attrs;\n\t\tnode.render = render;\n\t\tnode.args = argv && [argv]\n\t\t\t|| Array.isArray(args) && args.length && args\n\t\t\t|| [{}];\n\n\t\tif (tag === Tags.ScopeSlot) {\n\t\t\tnode.props = { name };\n\t\t\treturn node;\n\t\t}\n\t}\n\tnode.on = {};\n\tnode.props = {};\n\tfor (let k in attrs) {\n\t\t/** 事件 */\n\t\tconst onInfo = /^(::|@|on:)([a-zA-Z0-9].*)$/.exec(k);\n\t\tif (onInfo) {\n\t\t\tnode.on[onInfo[2]] = attrs[k];\n\t\t\tcontinue;\n\t\t}\n\t\t// TODO: data\n\t\tconst nCmd = /^n([:-])([a-zA-Z0-9]+(?:\\.[a-zA-Z0-9]+)*)$/i.exec(k);\n\t\t/** 普通属性 */\n\t\tif (!nCmd) {\n\t\t\tnode.props[k] = attrs[k];\n\t\t\tcontinue;\n\t\t}\n\t}\n\treturn node;\n}\n\nexport interface elementIteratorOptions {\n\tsimple?: boolean | Component[] | ((c: Component) => boolean);\n}\n\nexport function elements(\n\tnode: any,\n\topt: elementIteratorOptions = {},\n): any[] {\n\tif (Array.isArray(node)) {\n\t\tconst list: any[][] = [];\n\t\tfor (let n of node) {\n\t\t\tlist.push(elements(n, opt));\n\t\t}\n\t\treturn ([] as any[]).concat(...list);\n\t}\n\tif (!isElement(node)) { return [node]; }\n\tlet { tag } = node;\n\tif (!tag) { return []; }\n\n\tif (([Tags.Template, Tags.ScopeSlot] as Tag[]).includes(tag)) {\n\t\treturn elements(node.children, opt);\n\t}\n\tif (typeof tag !== 'function') { return [node]; }\n\tif (tag[typeSymbol] !== 'simple') { return [node]; }\n\tconst { simple } = opt;\n\tif (!simple) { return [node]; }\n\tif (Array.isArray(simple)) {\n\t\tif (simple.includes(tag)) { return [node]; }\n\t} else if (typeof simple === 'function') {\n\t\tif (!simple(tag)) { return [node]; }\n\t}\n\treturn elements(node.children, opt);\n}\n","let label: [string, string] | undefined;\nexport function setLabel(l: [string, string]) {\n\tlabel = l;\n}\n\nexport function getLabel() {\n\tconst l = label;\n\tlabel = undefined;\n\treturn l;\n}\n","import { isProduction } from '../constant';\nimport { current } from '../helper';\nimport { setLabel } from '../helper/label';\n\nexport function label(text: string, color = ''): void {\n\tif (!isProduction) {\n\t\tif (!current) {\n\t\t\tsetLabel([text, color]);\n\t\t\treturn;\n\t\t}\n\t\tReflect.defineProperty(current.exposed, '$label', {\n\t\t\tvalue: [text, color],\n\t\t\tconfigurable: true,\n\t\t});\n\t}\n}\n","import * as Constant from '../constant';\nimport * as Tags from './tags';\nimport * as State from './state';\nimport * as Life from './life';\nimport * as Element from './element';\nimport * as Dev from './dev';\n\nexport * from './tags';\nexport * from './state';\nexport * from './life';\nexport * from './element';\nexport * from './dev';\n\nexport { Tags };\n\n/** 辅助 */\nexport interface Auxiliary extends\n\tReadonly<typeof Tags>,\n\tReadonly<typeof State>,\n\tReadonly<typeof Life>,\n\tReadonly<typeof Element>,\n\tReadonly<typeof Dev>,\n\tReadonly<typeof Constant>\n{}\n\nconst auxiliary: Auxiliary = {\n\t...Tags,\n\t...Life,\n\t...Element,\n\t...Dev,\n\t...Constant,\n\tget value() { return State.value },\n\tget computed() { return State.computed },\n\tget isValue() { return State.isValue },\n\tget encase() { return State.encase },\n\tget recover() { return State.recover },\n};\n\nexport function setAuxiliary<T>(\n\tname: string,\n\tvalue: T,\n): void {\n\tReflect.defineProperty(auxiliary, name, {\n\t\tvalue,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n}\nexport function defineAuxiliary<T>(\n\tname: string,\n\tget: (this: Auxiliary) => T,\n): void {\n\tReflect.defineProperty(auxiliary, name, {\n\t\tget,\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t});\n}\nexport default auxiliary;\n","import { NativeNode } from '../type';\nimport { isProduction } from '../constant';\nimport { MountedNode } from './draw';\n\nlet ids = 0;\nconst Nodes: {[key: number]: MountedNode} = {};\nlet IdMap: undefined | Map<NativeNode, number>;\nif (!isProduction) {\n\tIdMap = new Map();\n}\nexport function createMountedNode(\n\tn: Omit<MountedNode, 'id'>,\n\tid?: number,\n): MountedNode {\n\tif (!isProduction) {\n\t\tid = id || ++ids;\n\t\tconst { node } = n;\n\t\tif (node && IdMap) { IdMap.set(node, id); }\n\t\treturn Nodes[id] = {...n, id};\n\t}\n\treturn {...n, id: 0};\n}\n\nexport function recoveryMountedNode(node: MountedNode): void {\n\tif (!isProduction) {\n\t\tdelete Nodes[node.id];\n\t}\n}\n\nexport function getNode(\n\tid: number | NativeNode,\n): MountedNode | undefined {\n\tif (!isProduction) {\n\t\tif (typeof id !== 'number') {\n\t\t\tid = IdMap?.get(id) || -1;\n\t\t}\n\t\treturn Nodes[id];\n\t}\n\treturn undefined;\n}\n","export interface RecursiveArray<T> extends Array<RecursiveItem<T>>{};\nexport type RecursiveItem<T> = T | RecursiveArray<T>;\n\nexport function *recursive2iterable<T>(\n\tlist: RecursiveItem<T>,\n): Iterable<T> {\n\tif (!Array.isArray(list)) {\n\t\tyield list;\n\t\treturn;\n\t}\n\tfor (const it of list) {\n\t\tyield* recursive2iterable(it);\n\t}\n}\n","import { Tags, Template, isValue } from '../auxiliary';\nimport { IRender, NativeNode, NativeElement, Exposed, Ref } from '../type';\nimport { createMountedNode, recoveryMountedNode } from './id';\nimport { TreeNode } from './convert';\n\n/**\n * @description node / component / children 至少一个有效\n */\nexport interface MountedNode extends TreeNode {\n\tid: number;\n\tparent?: this;\n\tnode: undefined | NativeNode;\n}\n\nlet refList: (() => void)[] | undefined;\nexport function setRefList(list?: (() => void)[]) {\n\trefList = list;\n}\nfunction setRef(\n\tref?: Ref,\n\tnode?: Exposed | NativeNode,\n\tisRemove?: boolean,\n) {\n\tif (typeof ref !== 'function') { return; }\n\tif (!node) { return; }\n\tif (!refList) {\n\t\tref(node, isRemove);\n\t} else {\n\t\trefList.push(() => ref(node, isRemove));\n\t}\n}\n\ntype MountedNodes = MountedNode | MountedNode[]\n\t| (MountedNode | MountedNode[])[];\n\nfunction getLastNode(tree: MountedNodes): NativeNode {\n\tif (Array.isArray(tree)) {\n\t\treturn getLastNode(tree[tree.length - 1]);\n\t}\n\tconst { component, children, node } = tree;\n\tif (node) { return node; }\n\tif (component) { return getLastNode(component.tree); }\n\treturn getLastNode(children);\n}\n\nfunction getFirstNode(tree: MountedNodes): NativeNode {\n\tif (Array.isArray(tree)) { return getFirstNode(tree[0]); }\n\tconst { component, children, node } = tree;\n\tif (node) { return node; }\n\tif (component) { return getFirstNode(component.tree); }\n\treturn getFirstNode(children[0]);\n}\n\nexport function *getNodes(tree: MountedNodes): Iterable<NativeNode> {\n\tif (Array.isArray(tree)) {\n\t\tfor (const it of tree) {\n\t\t\tyield* getNodes(it);\n\t\t}\n\t\treturn;\n\t}\n\tconst { children, node, component } = tree;\n\tif (node) {\n\t\tyield node;\n\t\treturn;\n\t}\n\tif (component) {\n\t\tyield* getNodes(component.tree);\n\t\treturn;\n\t}\n\tyield* getNodes(children);\n}\n\nexport function unmount(iRender: IRender, tree: MountedNodes): void {\n\tif (Array.isArray(tree)) {\n\t\ttree.forEach(e => unmount(iRender, e));\n\t\treturn;\n\t}\n\tconst { component, children, node, ref } = tree;\n\trecoveryMountedNode(tree);\n\tif (node) {\n\t\tsetRef(ref, node, true);\n\t\tiRender.remove(node);\n\t\treturn;\n\t}\n\tif (component) {\n\t\tsetRef(ref, component.exposed, true);\n\t\tcomponent.unmount();\n\t\treturn;\n\t}\n\tunmount(iRender, children);\n}\n\n\nfunction replace<T extends MountedNode | MountedNode[]>(\n\tiRender: IRender,\n\tnewTree: T,\n\toldTree: MountedNode | MountedNode[],\n): T {\n\tconst next = getFirstNode(oldTree);\n\tif (!next) { return newTree; }\n\tconst parent = iRender.parent(next);\n\tif (!parent) { return newTree; }\n\tfor (const it of getNodes(newTree)) {\n\t\tiRender.insert(parent, it, next);\n\t}\n\tunmount(iRender, oldTree);\n\treturn newTree;\n}\n\nfunction updateList(\n\tiRender: IRender,\n\tsource: TreeNode[],\n\ttree: MountedNode | MountedNode[],\n): MountedNode[] {\n\tif (!source.length) {\n\t\tconst node = createItem(iRender, {tag: null, children: []});\n\t\treturn [replace(iRender, node, tree)];\n\t}\n\tif (!Array.isArray(tree)) { tree = [tree]; }\n\tconst newList: MountedNode[] = [];\n\tconst list = [...tree];\n\tconst mountedMap = new Map<MountedNode, MountedNode>();\n\tfor (const src of source) {\n\t\tconst index = list.findIndex(it =>\n\t\t\tit.tag === src.tag && it.key === src.key\n\t\t);\n\t\tif (index >= 0) {\n\t\t\tconst old = list[index];\n\t\t\tconst item = updateItem(iRender, src, old);\n\t\t\tmountedMap.set(old, item);\n\t\t\tnewList.push(item);\n\t\t\tlist.splice(index, 1);\n\t\t} else {\n\t\t\tconst item = createItem(iRender, src);\n\t\t\tnewList.push(item);\n\t\t}\n\t}\n\tif (!mountedMap.size) {\n\t\treturn replace(iRender, newList, list);\n\t}\n\tunmount(iRender, list);\n\ttree = tree.filter(t => mountedMap.has(t));\n\tconst last = getLastNode(tree[tree.length - 1]);\n\tconst parent = iRender.parent(last);\n\tif (!parent) { return newList; }\n\tlet next = iRender.next(last);\n\t// 调整次序\n\tfor(let i = newList.length - 1; i >= 0; i--) {\n\t\tconst item = newList[i];\n\t\tconst index = tree.findIndex(o => mountedMap.get(o) === item);\n\t\tif (index >= 0) {\n\t\t\tfor (const it of tree.splice(index)) {\n\t\t\t\tmountedMap.delete(it);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const it of getNodes(item)) {\n\t\t\t\tiRender.insert(parent, it, next);\n\t\t\t}\n\t\t}\n\t\tnext = getFirstNode(item) || next;\n\t}\n\treturn newList;\n}\n/**\n * 更新树\n * @param tree 已有树\n * @param source 用于替换的源\n * @param iRender Neep 对象\n */\nfunction updateAll(\n\tiRender: IRender,\n\tsource: (TreeNode | TreeNode[])[],\n\ttree: (MountedNode | MountedNode[])[],\n): (MountedNode | MountedNode[])[] {\n\tlet index = 0;\n\tlet length = Math.min(source.length, source.length || 1);\n\tconst list: (MountedNode | MountedNode[])[] = [];\n\tfor (; index < length; index++) {\n\t\tconst src = source[index];\n\t\tif (Array.isArray(src)) {\n\t\t\tlist.push(updateList(iRender, src, tree[index]));\n\t\t} else {\n\t\t\tlist.push(updateItem(iRender, src, tree[index]));\n\t\t}\n\t}\n\tlength = Math.max(source.length, tree.length);\n\tif (tree.length > length) {\n\t\t\t// 销毁多余项\n\t\t\tfor (; index < length; index++) {\n\t\t\tunmount(iRender, tree[index]);\n\t\t}\n\t}\n\tif (source.length > length) {\n\t\t// 创建多余项\n\t\tconst last = getLastNode(list[list.length - 1]);\n\t\tconst parent = iRender.parent(last);\n\t\tconst next = iRender.next(last);\n\t\tfor (; index < length; index++) {\n\t\t\tconst src = source[index];\n\t\t\tconst item = Array.isArray(src)\n\t\t\t\t? createList(iRender, src)\n\t\t\t\t: createItem(iRender, src);\n\t\t\tlist.push(item);\n\t\t\tif (!parent) { continue; }\n\t\t\tfor (const it of getNodes(item)) {\n\t\t\t\tiRender.insert(parent, it, next);\n\t\t\t}\n\t\t}\n\t}\n\treturn list;\n}\n\n/**\n * 更新树节点\n * @param iRender Neep 对象\n * @param tree 已有树\n * @param source 用于替换的源\n */\nfunction updateItem(\n\tiRender: IRender,\n\tsource: TreeNode,\n\ttree: MountedNode | MountedNode[],\n): MountedNode {\n\tif (Array.isArray(tree)) {\n\t\tconst index = tree.findIndex(it =>\n\t\t\tit.tag === source.tag && it.component === source.component\n\t\t);\n\t\tif (index < 0) {\n\t\t\treturn replace(iRender, createItem(iRender, source), tree);\n\t\t}\n\t\tconst all = tree;\n\t\t[tree] = tree.splice(index, 1);\n\t\tunmount(iRender, all);\n\t}\n\tconst { tag, component } = source;\n\tconst ref = source.ref !== tree.ref && source.ref || undefined;\n\tif (tag !== tree.tag || component !== tree.component) {\n\t\treturn replace(iRender, createItem(iRender, source), tree);\n\t}\n\tif (!tag) { return tree; }\n\tif (typeof tag !== 'string' || tag === Tags.Container) {\n\t\tif (!component) {\n\t\t\t// TODO: ref\n\t\t\treturn createMountedNode({\n\t\t\t\t...source,\n\t\t\t\tnode: undefined,\n\t\t\t\tcomponent: undefined,\n\t\t\t\tchildren: draw(\n\t\t\t\t\tiRender,\n\t\t\t\t\tsource.children,\n\t\t\t\t\ttree.children,\n\t\t\t\t),\n\t\t\t}, tree.id);\n\t\t}\n\t\tsetRef(ref, component.exposed);\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent,\n\t\t\tchildren: [],\n\t\t}, tree.id);\n\t}\n\tif (tag === Tags.Value) {\n\t\tlet value = source.value;\n\t\tif (isValue(value)) { value = value(); }\n\t\tif(tree.value === value) {\n\t\t\tsetRef(ref, tree.node);\n\t\t\treturn createMountedNode({\n\t\t\t\t...tree,\n\t\t\t\t...source,\n\t\t\t\tvalue,\n\t\t\t\tchildren: [],\n\t\t\t}, tree.id);\n\t\t}\n\t\treturn replace(iRender, createValue(iRender, source, value), tree);\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\t// TODO: ref\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent: undefined,\n\t\t\tchildren: updateAll(\n\t\t\t\tiRender,\n\t\t\t\tsource.children,\n\t\t\t\ttree.children,\n\t\t\t),\n\t\t}, tree.id);\n\t}\n\tconst { node } = tree;\n\tiRender.update(\n\t\tnode as NativeElement,\n\t\tsource.props || {},\n\t\tisValue,\n\t);\n\tsetRef(ref, node);\n\tif (!source.children.length && !tree.children.length) {\n\t\treturn createMountedNode(\n\t\t\t{\n\t\t\t\t...tree,\n\t\t\t\t...source,\n\t\t\t\tchildren: [],\n\t\t\t},\n\t\t\ttree.id);\n\t}\n\tif (!source.children.length && tree.children.length) {\n\t\tunmount(iRender, tree.children);\n\t}\n\tif (source.children.length && !tree.children.length) {\n\t\tconst children = createAll(iRender, source.children);\n\t\tfor (const it of getNodes(children)) {\n\t\t\tiRender.insert(node as NativeElement, it);\n\t\t}\n\t\treturn createMountedNode({\n\t\t\t...tree,\n\t\t\t...source,\n\t\t\tchildren,\n\t\t}, tree.id);\n\t}\n\treturn createMountedNode({\n\t\t...tree, ...source,\n\t\tchildren: updateAll(\n\t\t\tiRender,\n\t\t\tsource.children,\n\t\t\ttree.children,\n\t\t),\n\t}, tree.id);\n}\n\nfunction createValue(\n\tiRender: IRender,\n\tsource: TreeNode,\n\tvalue: any,\n): MountedNode {\n\tlet { ref } = source;\n\tif (iRender.isNode(value)) {\n\t\tsetRef(ref, value);\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tvalue,\n\t\t\tnode: value,\n\t\t\tchildren: [],\n\t\t\tcomponent: undefined,\n\t\t});\n\t}\n\tconst type = typeof value;\n\tlet node: NativeNode | undefined;\n\tif (\n\t\ttype === 'bigint'\n\t\t|| type === 'boolean'\n\t\t|| type === 'number'\n\t\t|| type === 'string'\n\t\t|| type === 'symbol'\n\t\t|| value instanceof RegExp\n\t) {\n\t\tnode = iRender.text(String(value));\n\t} else if (value instanceof Date) {\n\t\tnode = iRender.text(value.toISOString());\n\t} else if (type === 'object' && value) {\n\t\tnode = iRender.text(String(value));\n\t\t// TODO: 对象处理\n\t}\n\tif (!node) { node = iRender.placeholder(); }\n\tsetRef(ref, node);\n\treturn createMountedNode({\n\t\t...source,\n\t\tvalue,\n\t\tnode,\n\t\tcomponent: undefined,\n\t\tchildren: [],\n\t});\n}\n\nfunction createAll(\n\tiRender: IRender,\n\tsource: (TreeNode | TreeNode[])[],\n): (MountedNode | MountedNode[])[] {\n\tif (!source.length) {\n\t\treturn [createMountedNode({\n\t\t\ttag: null,\n\t\t\tnode: iRender.placeholder(),\n\t\t\tcomponent: undefined,\n\t\t\tchildren: [],\n\t\t})];\n\t}\n\n\treturn source.map(item =>\n\t\tArray.isArray(item)\n\t\t\t? createList(iRender, item)\n\t\t\t: createItem(iRender, item)\n\t);\n}\n\nfunction createList(\n\tiRender: IRender,\n\tsource: TreeNode[],\n): MountedNode[] {\n\tif (source.length) {\n\t\treturn source.map(it => createItem(iRender, it));\n\t}\n\treturn [createMountedNode({\n\t\ttag: null,\n\t\tnode: iRender.placeholder(),\n\t\tcomponent: undefined,\n\t\tchildren: [],\n\t})];\n}\n\nfunction createItem(\n\tiRender: IRender,\n\tsource: TreeNode,\n): MountedNode {\n\tconst { tag, ref, component } = source;\n\tif (!tag) {\n\t\tconst node = iRender.placeholder();\n\t\tsetRef(ref, node);\n\t\treturn createMountedNode({\n\t\t\ttag: null,\n\t\t\tnode,\n\t\t\tcomponent: undefined,\n\t\t\tchildren: [],\n\t\t});\n\t}\n\tif (typeof tag !== 'string' || tag === Tags.Container) {\n\t\tif (!component) {\n\t\t\t// TODO: ref\n\t\t\treturn createMountedNode({\n\t\t\t\t...source,\n\t\t\t\tnode: undefined,\n\t\t\t\tcomponent: undefined,\n\t\t\t\tchildren: draw(iRender, source.children),\n\t\t\t});\n\t\t}\n\t\tcomponent.mount();\n\t\tsetRef(ref, component.exposed);\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent, children: [],\n\t\t});\n\t}\n\tif (tag === Tags.Value) {\n\t\treturn createValue(iRender, source, source.value);\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\t// TODO: ref\n\t\treturn createMountedNode({\n\t\t\t...source,\n\t\t\tnode: undefined,\n\t\t\tcomponent: undefined,\n\t\t\tchildren: createAll(iRender, source.children),\n\t\t});\n\t}\n\tconst node = iRender.create(tag, source.props || {}, isValue);\n\tsetRef(ref, node);\n\tlet children: (MountedNode | MountedNode[])[] = [];\n\tif (source.children) {\n\t\tchildren = createAll(iRender, source.children);\n\t\tfor (const it of getNodes(children)) {\n\t\t\tiRender.insert(node, it);\n\t\t}\n\t}\n\treturn createMountedNode({\n\t\t...source,\n\t\tnode,\n\t\tcomponent: undefined,\n\t\tchildren,\n\t});\n}\n\nexport default function draw(\n\tiRender: IRender,\n\tsource: (TreeNode | TreeNode[])[],\n\ttree?: (MountedNode | MountedNode[])[],\n): (MountedNode | MountedNode[])[] {\n\tif (tree) {\n\t\treturn updateAll(iRender, source, tree);\n\t}\n\treturn createAll(iRender, source);\n}\n","import { NeepElement, SlotFn, Slots, IRender } from '../type';\nimport { isElement, SlotRender, ScopeSlot } from '../auxiliary';\nimport { isElementSymbol } from '../symbols';\nimport { isProduction } from '../constant';\n\n\nexport function getSlots(\n\tiRender: IRender,\n\tchildren: any[],\n\tslots: Record<string | symbol, any[]>,\n\tnative = false,\n): any[] {\n\t/** 原始对象 */\n\tconst nativeList: any[] = [];\n\tfor (const it of children) {\n\t\tif (Array.isArray(it)) {\n\t\t\tconst list: Record<string | symbol, any[]>\n\t\t\t\t= Object.create(null);\n\t\t\tnativeList.push(getSlots(iRender, it, list, native));\n\t\t\tfor (const k of Reflect.ownKeys(list) as string[]) {\n\t\t\t\tif (k in slots) {\n\t\t\t\t\tslots[k].push(list[k]);\n\t\t\t\t} else {\n\t\t\t\t\tslots[k] = [list[k]];\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (native) {\n\t\t\tif (iRender.isNode(it)) {\n\t\t\t\tnativeList.push(it);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!isElement(it)) {\n\t\t\t\tnativeList.push(it);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (it.tag !== SlotRender) {\n\t\t\t\tnativeList.push(it);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tconst slot = isElement(it) && it.slot || 'default';\n\t\tconst el = isElement(it) ? {\n\t\t\t...it, slot: undefined,\n\t\t\tprops: {...it.props, slot: undefined },\n\t\t} : it;\n\t\tif (slot in slots) {\n\t\t\tslots[slot].push(el);\n\t\t} else {\n\t\t\tslots[slot] = [el];\n\t\t}\n\t}\n\treturn nativeList;\n}\nfunction renderSlots(\n\tlist: any[],\n\t...props: any\n): any[] {\n\treturn list.map(it => {\n\t\tif (Array.isArray(it)) {\n\t\t\treturn renderSlots(it, ...props);\n\t\t}\n\t\tif (!isElement(it)) { return it; }\n\t\tif (it.tag !== SlotRender) {\n\t\t\treturn {\n\t\t\t\t...it,\n\t\t\t\tslot: undefined,\n\t\t\t} as NeepElement;\n\t\t}\n\t\tif (typeof it.render === 'function') {\n\t\t\treturn it.render(...props);\n\t\t}\n\t\treturn it.children;\n\t});\n}\nfunction createSlots(\n\tname: string,\n\tlist: any[],\n): SlotFn {\n\tconst slot = (...props: any) => ({\n\t\t[isElementSymbol]: true,\n\t\ttag: ScopeSlot,\n\t\tchildren: renderSlots(list, ...props),\n\t\tinserted: true,\n\t\tlabel: isProduction ? undefined : [`[${name}]`, '#00F'],\n\t} as NeepElement);\n\tslot.children = list;\n\treturn slot;\n}\nexport function setSlots(\n\tchildren: {[key: string]: any[]},\n\tslots: Slots = Object.create(null),\n) {\n\tfor (const k of Reflect.ownKeys(slots)) {\n\t\tif (!(k in children)) {\n\t\t\tdelete slots[k as string];\n\t\t}\n\t}\n\tfor (const k of Reflect.ownKeys(children) as string[]) {\n\t\tslots[k] = createSlots(k, children[k]);\n\t}\n\treturn slots;\n}\n","import { isValue } from '../auxiliary';\n\nexport function updateProps(\n\tobj: any,\n\tprops: any,\n\toldProps: any = {},\n\tdefine = false,\n) {\n\tconst newKeys = new Set(Reflect.ownKeys(props));\n\tfor (const k of Reflect.ownKeys(obj)) {\n\t\tif (!newKeys.has(k)) {\n\t\t\tdelete obj[k];\n\t\t}\n\t}\n\tif (!define) {\n\t\tfor (const k of newKeys) {\n\t\t\tobj[k] = props[k];\n\t\t}\n\t\treturn obj;\n\t}\n\tfor (const k of newKeys) {\n\t\tconst value = props[k];\n\t\tif (k in oldProps && oldProps[k] === value) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (isValue(value)) {\n\t\t\tReflect.defineProperty(obj, k, {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tget() { return value(); },\n\t\t\t\tset(v) { value(v); }\n\t\t\t});\n\t\t\tcontinue;\n\t\t}\n\t\tReflect.defineProperty(obj, k, {\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t\tvalue,\n\t\t});\n\t}\n\treturn obj;\n}","import {\n\tNeepElement, Exposed, Delivered,\n\tRender, NeepNode, Slots, Context, IRender, Component,\n} from '../type';\nimport { typeSymbol } from '../symbols';\nimport { isProduction } from '../constant';\nimport auxiliary, { isElement, Tags } from '../auxiliary';\nimport { renderSymbol, isElementSymbol } from '../symbols';\nimport { getLabel } from '../helper/label';\nimport Container from './Container';\nimport Entity from './Entity';\nimport { getSlots, setSlots } from './slot';\nimport { initContext } from '../helper/context';\nimport { updateProps } from './props';\n\nfunction execSimple(\n\tnObject: Container | Entity,\n\tdelivered: Delivered,\n\tnode: NeepElement,\n\ttag: Component,\n\tchildren: any[],\n) {\n\tconst { iRender } = nObject.container;\n\tconst slotMap = Object.create(null);\n\tgetSlots(iRender, children, slotMap);\n\tconst slots = setSlots(slotMap);\n\tconst context: Context = initContext({\n\t\tslots,\n\t\tcreated: false,\n\t\tparent: nObject.exposed,\n\t\tdelivered,\n\t\tchildren: new Set<Exposed>(),\n\t\tchildNodes: children,\n\t\trefresh(f) { nObject.refresh(f); }\n\t});\n\tif (!isProduction) { getLabel(); }\n\tconst result = tag({...node.props}, context, auxiliary);\n\tlet label: [string, string] | undefined;\n\tif (!isProduction) { label = getLabel(); }\n\tconst nodes = exec(nObject, delivered, renderNode(\n\t\tiRender,\n\t\tresult,\n\t\tcontext,\n\t\ttag[renderSymbol],\n\t), slots);\n\n\treturn {\n\t\t...node,\n\t\tchildren: Array.isArray(nodes) ? nodes : [nodes],\n\t\tlabel,\n\t} as NeepElement;\n}\n\nfunction execSlot(\n\tnode: NeepElement,\n\tslots: Slots,\n\tchildren: any[],\n\targs: any[] = [{}],\n): NeepElement {\n\tconst slotName = node.props?.name || 'default';\n\tconst slot = slots[slotName];\n\tif (typeof slot === 'function') {\n\t\treturn {\n\t\t\t...node,\n\t\t\t...slot(...args),\n\t\t};\n\t}\n\tconst { render } = node;\n\tconst label: [string, string] | undefined = isProduction\n\t\t? undefined\n\t\t: [`[${ slotName }]`, '#00F'];\n\treturn {\n\t\t...node,\n\t\ttag: Tags.ScopeSlot,\n\t\tlabel,\n\t\tchildren:\n\t\t\ttypeof render !== 'function' ? children : render(...args),\n\t};\n}\n\nfunction exec(\n\tnObject: Container | Entity,\n\tdelivered: Delivered,\n\tnode: any,\n\tslots: Slots,\n\tnative = false,\n): any {\n\tif (Array.isArray(node)) {\n\t\treturn node.map(n =>\n\t\t\texec(nObject, delivered, n, slots, native)\n\t\t);\n\t}\n\tif (!isElement(node)) { return node; }\n\tlet { tag, inserted, args = [{}] } = node;\n\tif (tag === Tags.Deliver) {\n\t\tconst props = { ...node.props };\n\t\tdelete props.ref;\n\t\tdelete props.slot;\n\t\tdelete props.key;\n\t\tconst newDelivered = Object.create(delivered);\n\t\tupdateProps(newDelivered, props || {}, {}, true);\n\t\treturn {\n\t\t\t...node,\n\t\t\ttag,\n\t\t\t$__neep__delivered: newDelivered,\n\t\t\tchildren: node.children.map(n => exec(\n\t\t\t\tnObject,\n\t\t\t\tnewDelivered,\n\t\t\t\tn,\n\t\t\t\tslots,\n\t\t\t\tnative,\n\t\t\t)),\n\t\t};\n\t}\n\n\tconst children = node.children\n\t\t.map(n => exec(nObject, delivered, n, slots, native));\n\n\tif (typeof tag === 'function') {\n\t\tif (tag[typeSymbol] === 'simple') {\n\t\t\treturn execSimple(nObject, delivered, node, tag, children);\n\t\t}\n\t\treturn { ...node, $__neep__delivered: delivered, children, tag };\n\n\t}\n\tif (tag === Tags.Slot) {\n\t\ttag = native ? 'slot' : Tags.ScopeSlot;\n\t}\n\tif (tag !== Tags.ScopeSlot || inserted) {\n\t\treturn { ...node, children, tag };\n\t}\n\treturn execSlot(node, slots, children, args);\n}\n\n\n\nfunction renderNode<R extends object = object>(\n\tiRender: IRender,\n\tnode: R | NeepNode | NeepNode[] | undefined | null,\n\tcontext: Context,\n\trender?: Render,\n): NeepNode[] {\n\tif (Array.isArray(node)) { return node; }\n\tif (isElement(node)) { return [node]; }\n\tif (node === undefined || node === null) {\n\t\treturn [{ [isElementSymbol]: true, tag: null, children: [] }];\n\t}\n\tif (!iRender.isNode(node) && typeof node === 'object' && render) {\n\t\tnode = render(node, context, auxiliary);\n\t}\n\tif (isElement(node)) { return [node]; }\n\tif (node === undefined || node === null) {\n\t\treturn [{ [isElementSymbol]: true, tag: null, children: [] }];\n\t}\n\treturn [{\n\t\t[isElementSymbol]: true,\n\t\ttag: Tags.Value,\n\t\tvalue: node,\n\t\tchildren: [],\n\t}];\n}\n\n\nexport default function normalize(\n\tnObject: Entity,\n\tresult: any,\n) {\n\treturn exec(\n\t\tnObject,\n\t\tnObject.delivered,\n\t\trenderNode(\n\t\t\tnObject.iRender,\n\t\t\tresult,\n\t\t\tnObject.context,\n\t\t\tnObject.component[renderSymbol],\n\t\t),\n\t\tnObject.context.slots,\n\t\tBoolean(nObject.native),\n\t);\n}\n","import NeepObject from \"./Object\";\n\nlet delayedRefresh = 0;\nconst objectSet = new Set<NeepObject>();\nexport function wait(obj: NeepObject) {\n\tif (delayedRefresh <= 0) { return false; }\n\tobjectSet.add(obj);\n\treturn true;\n}\nfunction run() {\n\tif (delayedRefresh > 0) { return; }\n\tconst list = [...objectSet];\n\tobjectSet.clear();\n\tlist.forEach(o => o.refresh());\n}\nasync function asyncRefresh<T>(f: () => PromiseLike<T> | T): Promise<T> {\n\ttry {\n\t\tdelayedRefresh++;\n\t\treturn await f();\n\t} finally {\n\t\tdelayedRefresh--;\n\t\trun();\n\t}\n}\nexport default function refresh<T>(f: () => T, async?: false): T;\nexport default function refresh<T>(\n\tf: () => PromiseLike<T> | T,\n\tasync: true,\n): Promise<T>;\nexport default function refresh<T>(\n\tf: () => PromiseLike<T> | T,\n\tasync?: boolean,\n): PromiseLike<T> | T;\nexport default function refresh<T>(\n\tf: () => PromiseLike<T> | T,\n\tasync?: boolean,\n): PromiseLike<T> | T {\n\tif (async) { return asyncRefresh(f); }\n\ttry {\n\t\tdelayedRefresh++;\n\t\treturn f();\n\t} finally {\n\t\tdelayedRefresh--;\n\t\trun();\n\t}\n}","import {\n\tExposed, Delivered,\n\tEntity as ComponentEntity,\n\tNativeComponent,\n\tHook, Hooks, NeepNode, IRender,\n} from '../type';\nimport { callHook, setHook } from '../hook';\nimport { MountedNode } from './draw';\nimport Container from './Container';\nimport convert, { TreeNode } from './convert';\nimport { wait } from './refresh';\nimport { monitorable } from '../install';\n\nfunction createExposed(obj: NeepObject): Exposed {\n\tconst cfg: { [K in Exclude<keyof Exposed, '$label'>]-?:\n\t\t{ configurable: true, value: Exposed[K] }\n\t\t| { configurable: true, get(): Exposed[K] }\n\t} = {\n\t\t$parent: { configurable: true, get: () => obj.parent?.exposed },\n\t\t$component: { configurable: true, value: null },\n\t\t$isContainer: { configurable: true, value: false },\n\t\t$created: { configurable: true, get: () => obj.created },\n\t\t$destroyed: { configurable: true, get: () => obj.destroyed },\n\t\t$mounted: { configurable: true, get: () => obj.mounted },\n\t\t$unmounted: { configurable: true, get: () => obj.unmounted },\n\t};\n\tconst exposed: Exposed = Object.create(null, cfg);\n\treturn exposed;\n}\n\nlet completeList: (() => void)[] | undefined;\nexport function setCompleteList(list?: (() => void)[]) {\n\tcompleteList = list;\n}\nexport function complete(it: () => void) {\n\tif (!completeList) {\n\t\tit();\n\t} else {\n\t\tcompleteList.push(it);\n\t}\n}\n\nfunction createEntity(obj: NeepObject): ComponentEntity {\n\tconst cfg: { [K in keyof ComponentEntity]-?:\n\t\t{ configurable: true, value: ComponentEntity[K], writable?: boolean }\n\t\t| { configurable: true, get(): ComponentEntity[K] }\n\t} = {\n\t\texposed: { configurable: true, get: () => obj.exposed },\n\t\tdelivered: { configurable: true, get: () => obj.delivered },\n\t\tparent: { configurable: true, get: () => obj.parent?.entity },\n\t\tcomponent: { configurable: true, value: null },\n\t\tisContainer: { configurable: true, value: false },\n\t\tcreated: { configurable: true, get: () => obj.created },\n\t\tdestroyed: { configurable: true, get: () => obj.destroyed },\n\t\tmounted: { configurable: true, get: () => obj.mounted },\n\t\tunmounted: { configurable: true, get: () => obj.unmounted },\n\t\t$_hooks: { configurable: true, value: Object.create(null) },\n\t\t$_valueIndex: { configurable: true, value: 0, writable: true },\n\t\t$_values: { configurable: true, value: [] },\n\t\tcallHook: {\n\t\t\tconfigurable: true,\n\t\t\tvalue(h: string) { callHook(h, entity); },\n\t\t},\n\t\tsetHook: {\n\t\t\tconfigurable: true,\n\t\t\tvalue(id: string, hook: Hook) {\n\t\t\t\treturn setHook(id, hook, entity);\n\t\t\t},\n\t\t},\n\t\trefresh: {\n\t\t\tconfigurable: true,\n\t\t\tvalue: obj.refresh.bind(obj),\n\t\t},\n\t};\n\tconst entity: ComponentEntity = Object.create(null, cfg);\n\treturn entity;\n}\n\nexport default class NeepObject {\n\treadonly iRender: IRender;\n\t/** 接受到的呈递值 */\n\treadonly parentDelivered: Delivered;\n\t/** 向后代呈递的值 */\n\treadonly delivered: Delivered;\n\t/** 组件暴露值 */\n\treadonly exposed: Exposed = createExposed(this);\n\t/** 组件实体 */\n\treadonly entity: ComponentEntity = createEntity(this);\n\t/** 父组件 */\n\tparent?: NeepObject;\n\t/** 原生组件 */\n\tnative: NativeComponent | undefined;\n\t/** 状态 */\n\tcreated: boolean = false;\n\tdestroyed: boolean = false;\n\tmounted: boolean = false;\n\tunmounted: boolean = false;\n\t/**  子组件的暴露值 */\n\treadonly children: Set<Exposed> = new Set();\n\t/** The subtree mounted on the parent node */\n\ttree: (MountedNode | MountedNode[])[] = [];\n\treadonly container: Container;\n\tconstructor(\n\t\tiRender: IRender,\n\t\tparent?: NeepObject,\n\t\tdelivered: Delivered = parent?.delivered || Object.create(null),\n\t\tcontainer?: Container,\n\t) {\n\t\tthis.iRender = iRender;\n\t\tthis.parentDelivered = delivered;\n\t\tthis.delivered = Object.create(delivered);\n\t\tif (parent) {\n\t\t\tthis.parent = parent;\n\t\t}\n\t\tthis.container = container || this as any as Container;\n\t}\n\t/** 结果渲染函数 */\n\tprotected _render: () => NeepNode[] = () => [];\n\n\tget canRefresh(): boolean {\n\t\tif (wait(this)) { return false; }\n\t\treturn !this._delayedRefresh;\n\t}\n\tprotected get needRefresh(): boolean {\n\t\tif (wait(this)) { return false; }\n\t\tif (this._delayedRefresh) { return false; }\n\t\tconst needRefresh = this._needRefresh;\n\t\tthis._needRefresh = false;\n\t\treturn needRefresh;\n\t}\n\t/** 是否需要继续刷新 */\n\tprotected _needRefresh = false;\n\tprivate _delayedRefresh = 0;\n\t/** 是否为刷新中 */\n\tprivate _refreshing = false;\n\t/** 渲染结果 */\n\tprotected _nodes: (TreeNode | TreeNode[])[] = [];\n\tprotected requestDraw() { }\n\tasync asyncRefresh<T>(f: () => PromiseLike<T> | T): Promise<T> {\n\t\ttry {\n\t\t\tthis._delayedRefresh++;\n\t\t\treturn await f();\n\t\t} finally {\n\t\t\tthis._delayedRefresh--;\n\t\t\tthis.refresh();\n\t\t}\n\t}\n\trefresh(): void;\n\trefresh<T>(f: () => T, async?: false): T;\n\trefresh<T>(f: () => PromiseLike<T> | T, async: true): Promise<T>;\n\trefresh<T>(\n\t\tf: () => PromiseLike<T> | T,\n\t\tasync?: boolean,\n\t): PromiseLike<T> | T;\n\trefresh<T>(\n\t\tf?: () => PromiseLike<T> | T,\n\t\tasync?: boolean,\n\t): PromiseLike<T> | T | undefined;\n\trefresh<T>(\n\t\tf?: () => PromiseLike<T> | T,\n\t\tasync?: boolean,\n\t): PromiseLike<T> | T | undefined {\n\t\tif (typeof f === 'function') {\n\t\t\tif (async) { return this.asyncRefresh(f); }\n\t\t\ttry {\n\t\t\t\tthis._delayedRefresh++;\n\t\t\t\treturn f();\n\t\t\t} finally {\n\t\t\t\tthis._delayedRefresh--;\n\t\t\t\tif (this._delayedRefresh <= 0) {\n\t\t\t\t\tthis.refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.destroyed) { return; }\n\t\tthis._needRefresh = true;\n\t\tif (!this.created) { return; }\n\n\t\tif (this._refreshing) { return; }\n\t\tthis._refreshing = true;\n\n\t\tlet nodes: NeepNode[] | undefined;\n\t\twhile(this.needRefresh) {\n\t\t\tnodes = this._render();\n\t\t\tif (this.destroyed) { return; }\n\t\t}\n\t\tthis._refreshing = false;\n\t\tif (!this.canRefresh) { return; }\n\t\tif (!nodes) { return; }\n\n\t\tthis._nodes = convert(this, nodes, this._nodes);\n\t\tif (!this.mounted) { return; }\n\t\tif (this.destroyed) { return; }\n\t\tif (this.unmounted) { return; }\n\t\tthis.requestDraw();\n\t}\n\tcallHook<H extends Hooks>(id: H): void;\n\tcallHook(id: string): void;\n\tcallHook(id: string): void {\n\t\tcallHook(id, this.entity);\n\t}\n\n\tchildNodes: any[] = [];\n\t/** 更新属性及子代 */\n\tprotected _update(props: object, children: any[]): void {\n\t\tthis.childNodes = children;\n\t}\n\t/** 更新属性及子代 */\n\tupdate(props: object, children: any[]): void {\n\t\tthis._update(props, children);\n\t}\n\n\n\tprivate __executed_destroy = false;\n\tprivate __executed_mount = false;\n\tprivate __executed_mounted = false;\n\tprotected _destroy() { }\n\tdestroy() {\n\t\tif (this.__executed_destroy) { return; }\n\t\tthis.__executed_destroy = true;\n\t\tthis.callHook('beforeDestroy');\n\t\tthis._destroy();\n\t\tthis.callHook('destroyed');\n\t\tthis.destroyed = true;\n\t}\n\tprotected _mount() { }\n\tmount() {\n\t\tif (this.__executed_destroy) { return; }\n\t\tif (this.__executed_mount) { return; }\n\t\tthis.__executed_mount = true;\n\t\tthis.callHook('beforeMount');\n\t\tconst result = monitorable.exec(\n\t\t\t() => {\n\t\t\t\tthis._mount();\n\t\t\t\tthis.mounted = true;\n\t\t\t},\n\t\t\tc => c && this.requestDraw(),\n\t\t\t{ postpone: true }\n\t\t);\n\t\tthis._cancelDrawMonitor = result.stop;\n\t\tcomplete(() => this.callHook('mounted'));\n\t}\n\tprotected _unmount() { }\n\tunmount() {\n\t\tif (!this.mounted) { return; }\n\t\tif (this.__executed_mounted) { return; }\n\t\tthis.__executed_mounted = true;\n\t\tthis.callHook('beforeUnmount');\n\t\tthis._unmount();\n\t\tthis.callHook('unmounted');\n\t\tthis.unmounted = true;\n\t}\n\t_draw() {}\n\t_cancelDrawMonitor?: () => void;\n\tdraw() {\n\t\tif (this.__executed_destroy) { return; }\n\t\tthis._cancelDrawMonitor?.();\n\t\tthis.callHook('beforeUpdate');\n\t\tconst result = monitorable.exec(\n\t\t\t() => this._draw(),\n\t\t\tc => c && this.requestDraw(),\n\t\t\t{ postpone: true }\n\t\t);\n\t\tthis._cancelDrawMonitor = result.stop;\n\t\tcomplete(() => this.callHook('updated'));\n\t}\n}","import { Component, NeepNode, Slots, Context, Delivered, NativeShadow } from '../type';\nimport auxiliary, { createElement, Value } from '../auxiliary';\nimport { monitorable } from '../install';\nimport { setCurrent } from '../helper/current';\nimport convert, { destroy, TreeNode } from './convert';\nimport draw, { unmount, MountedNode, getNodes } from './draw';\nimport normalize from './normalize';\nimport { getSlots, setSlots } from './slot';\nimport NeepObject from './Object';\nimport { initContext } from '../helper/context';\nimport { updateProps } from './props';\nimport { typeSymbol } from '../symbols';\n\nfunction update(\n\tnObject: Entity<any, any>,\n\tprops: any,\n\tchildren:any[],\n) {\n\tupdateProps(nObject.props, props);\n\n\tconst slots = Object.create(null);\n\tconst {\n\t\tnative,\n\t\tiRender,\n\t} = nObject;\n\tconst childNodes = getSlots(\n\t\tiRender,\n\t\tchildren,\n\t\tslots,\n\t\tBoolean(native),\n\t);\n\tsetSlots(slots, nObject.slots);\n\tif (!native) { return; }\n\tnObject.nativeNodes\n\t\t= convert(nObject, childNodes, nObject.nativeNodes);\n\tif (!nObject.mounted) { return; }\n\tnObject.requestDraw();\n}\n\nfunction createContext<\n\tP extends object = object,\n\tR extends object = object\n>(nObject: Entity<P, R>): Context {\n\treturn initContext({\n\t\tslots: nObject.slots,\n\t\tget created() { return nObject.created; },\n\t\tget parent() { return nObject.parent.exposed; },\n\t\tget delivered() { return nObject.parentDelivered; },\n\t\tget children() { return nObject.children; },\n\t\tget childNodes() { return nObject.childNodes; },\n\t\trefresh(f) { nObject.refresh(f); }\n\t}, nObject.exposed);\n}\n\n/** 初始化渲染 */\nfunction initRender<R extends object = object>(\n\tnObject: Entity<any, R>\n): { render(): any, nodes: any, stopRender(): void } {\n\tconst {\n\t\tcomponent,\n\t\tprops,\n\t\tcontext,\n\t\tentity,\n\t} = nObject;\n\tconst refresh = (changed: boolean) => changed && nObject.refresh()\n\t// 初始化执行\n\tconst result = monitorable.exec(() => setCurrent(\n\t\t() => component(props, context, auxiliary),\n\t\tentity,\n\t), refresh, { resultOnly: true, postpone: true });\n\tif (typeof result === 'function') {\n\t\t// 响应式\n\t\tconst render = monitorable.createExecutable(\n\t\t\t() => normalize(nObject, (result as () => NeepNode)()),\n\t\t\trefresh,\n\t\t);\n\t\treturn {\n\t\t\tnodes: render(),\n\t\t\trender,\n\t\t\tstopRender: () => render.stop(),\n\t\t};\n\t}\n\n\tconst render = monitorable.createExecutable(\n\t\t() => normalize(nObject, setCurrent(\n\t\t\t() => component(props, context, auxiliary),\n\t\t\tentity,\n\t\t)),\n\t\trefresh,\n\t\t{ postpone: true },\n\t);\n\treturn {\n\t\tnodes: monitorable.exec(\n\t\t\t() => normalize(nObject, result),\n\t\t\trefresh,\n\t\t\t{ resultOnly: true, postpone: true },\n\t\t),\n\t\trender,\n\t\tstopRender: () => render.stop(),\n\t};\n}\n\n\nexport default class Entity<\n\tP extends object = object,\n\tR extends object = object\n> extends NeepObject {\n\t/** 组件函数 */\n\treadonly component: Component<P, R>;\n\t/** 组件属性 */\n\treadonly props: P = monitorable.encase(Object.create(null));\n\t/** 组件槽 */\n\treadonly slots: Slots = monitorable.encase(Object.create(null));\n\t/** 结果渲染函数 */\n\tprivate readonly _stopRender:() => void;\n\t/** 原生子代 */\n\tnativeNodes: (TreeNode | TreeNode[])[] | undefined;\n\tshadowTree: (MountedNode | MountedNode[])[] = [];\n\tnativeTree: (MountedNode | MountedNode[])[] = [];\n\tprivate readonly _shadow: NativeShadow | undefined;\n\t/** 组件上下文 */\n\treadonly context: Context;\n\treadonly parent: NeepObject;\n\t/** 结果渲染函数 */\n\tconstructor(\n\t\tcomponent: Component<P, R>,\n\t\tprops: object,\n\t\tchildren: any[],\n\t\tparent: NeepObject,\n\t\tdelivered?: Delivered,\n\t) {\n\t\tsuper(parent.iRender, parent, delivered, parent.container);\n\t\tthis.component = component;\n\t\tReflect.defineProperty(\n\t\t\tthis.exposed,\n\t\t\t'$component',\n\t\t\t{ value: component, enumerable: true, configurable: true },\n\t\t);\n\t\t// 原生组件\n\t\t[this.native, this._shadow] =\n\t\t\tcomponent[typeSymbol] === 'native' &&\n\t\t\tthis.iRender.component?.() || [];\n\t\t// 父子关系\n\t\tthis.parent = parent;\n\t\tparent.children.add(this.exposed);\n\t\t// 上下文属性\n\t\tconst context = createContext(this);\n\t\tthis.context = context;\n\t\t// 初始化钩子\n\t\tthis.callHook('beforeCreate');\n\t\t// 更新属性\n\t\tthis.childNodes = children;\n\t\tupdate(this, props, children);\n\t\t// 获取渲染函数及初始渲染\n\t\tconst { render, nodes, stopRender } = initRender(this);\n\t\tthis._render = render;\n\t\tthis._stopRender = stopRender;\n\t\tthis._nodes = convert(this, nodes);\n\t\t// 初始化钩子\n\t\tthis.callHook('created');\n\t\tthis.created = true;\n\t\tif (this._needRefresh) { this.refresh(); }\n\t}\n\t/** 更新属性及子代 */\n\t_update(props: object, children: any[]): void {\n\t\tif (this.destroyed) { return; }\n\t\tthis.childNodes = children;\n\t\tupdate(this, props, children);\n\t}\n\t_destroy() {\n\t\tif (this._stopRender) {\n\t\t\tthis._stopRender();\n\t\t}\n\t\tthis.parent.children.delete(this.exposed);\n\t\tdestroy(this._nodes);\n\t}\n\n\t/** 刷新 */\n\trequestDraw() {\n\t\tthis.container.markDraw(this);\n\t}\n\t_draw() {\n\t\tconst {nativeNodes, iRender, _shadow, native} = this;\n\t\tif (!native || !nativeNodes || !_shadow) {\n\t\t\tthis.tree = draw(\n\t\t\t\tiRender,\n\t\t\t\tthis._nodes,\n\t\t\t\tthis.tree,\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tthis.shadowTree = draw(\n\t\t\tiRender,\n\t\t\tthis._nodes,\n\t\t\tthis.shadowTree,\n\t\t);\n\t\tthis.nativeTree = draw(\n\t\t\tiRender,\n\t\t\tnativeNodes,\n\t\t\tthis.nativeTree,\n\t\t);\n\t}\n\t_mount() {\n\t\tconst {nativeNodes, iRender, _shadow, native, _nodes} = this;\n\t\tif (!native || !nativeNodes || !_shadow) {\n\t\t\tthis.tree = draw(iRender, _nodes);\n\t\t\treturn;\n\t\t}\n\t\tthis.tree = draw(iRender, convert(this, native));\n\t\tthis.shadowTree = draw(iRender, _nodes);\n\t\tfor (const it of getNodes(this.shadowTree)) {\n\t\t\tiRender.insert(_shadow, it);\n\t\t}\n\t\tthis.nativeTree = draw(iRender, nativeNodes);\n\t\tfor (const it of getNodes(this.nativeTree)) {\n\t\t\tiRender.insert(native, it);\n\t\t}\n\t}\n\t_unmount() {\n\t\tconst {iRender, nativeTree} = this;\n\t\tunmount(iRender, this.tree);\n\t\tif (!nativeTree) { return; }\n\t\tunmount(iRender, nativeTree);\n\t}\n}\n","import { getRender } from '../install';\nimport { NeepNode, NeepElement, Tag } from '../type';\nimport { Tags, isElement, Value, Template } from '../auxiliary';\nimport { isElementSymbol, typeSymbol } from '../symbols';\nimport { recursive2iterable } from './recursive';\nimport Entity from './Entity';\nimport NeepObject from './Object';\nimport Container from './Container';\nimport { updateProps } from './props';\n\nexport interface TreeNode\n\textends Omit<\n\t\tNeepElement,\n\t\t'children' | 'tag' | typeof isElementSymbol\n\t>\n{\n\t/** 标签名 */\n\ttag: Tag;\n\tchildren: (this | this[])[];\n\tmounted?: boolean;\n\tcomponent?: NeepObject;\n}\n/** 强制转换为 NeepElement */\nfunction toElement(t: any): null | NeepElement {\n\tif (t === false || t === null || t === undefined) {\n\t\treturn null;\n\t}\n\tif (isElement(t)) {\n\t\treturn t;\n\t}\n\treturn {\n\t\t[isElementSymbol]: true,\n\t\ttag: Value,\n\t\tkey: t,\n\t\tvalue: t,\n\t\tchildren: [],\n\t};\n}\n\nexport function destroy(\n\ttree: TreeNode | TreeNode[] | (TreeNode | TreeNode[])[]\n) {\n\tif (Array.isArray(tree)) {\n\t\ttree.forEach(t => destroy(t));\n\t\treturn;\n\t}\n\tconst { component } = tree;\n\tif (component) { component.destroy(); }\n}\n\nfunction createItem(\n\tnObject: NeepObject,\n\tsource: NeepNode,\n): TreeNode {\n\tif (!source) { return { tag: null, children: [] }; }\n\tconst { tag } = source;\n\tif (!tag) { return { tag: null, children: [] }; }\n\tif (typeof tag !== 'string') {\n\t\tif (tag[typeSymbol] === 'simple') {\n\t\t\treturn {\n\t\t\t\t...source,\n\t\t\t\tchildren: convert(nObject, source.children),\n\t\t\t\tcomponent: undefined,\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\t...source, children: [],\n\t\t\tcomponent: new Entity(\n\t\t\t\ttag,\n\t\t\t\tsource.props || {},\n\t\t\t\tsource.children,\n\t\t\t\tnObject,\n\t\t\t\tsource.$__neep__delivered,\n\t\t\t),\n\t\t};\n\t}\n\tif (tag === Tags.Container) {\n\t\tconst type = source?.props?.type;\n\t\tconst iRender = type ? getRender(type) : nObject.iRender;\n\t\treturn {\n\t\t\t...source, children: [],\n\t\t\tcomponent: new Container(\n\t\t\t\tiRender,\n\t\t\t\tsource.props || {},\n\t\t\t\tsource.children,\n\t\t\t\tnObject,\n\t\t\t\tsource.$__neep__delivered,\n\t\t\t),\n\t\t};\n\t}\n\tif (tag === Tags.Value) {\n\t\treturn { ...source, children: [] };\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\treturn {\n\t\t\t...source,\n\t\t\tchildren: convert(nObject, source.children),\n\t\t};\n\t}\n\treturn {...source, children: convert(nObject, source.children) };\n}\n\n/**\n * 更新树节点\n * @param nObject Neep 对象\n * @param source 用于替换的源\n * @param tree 已有树\n */\nfunction updateList(\n\tnObject: NeepObject,\n\tsource: any[],\n\ttree: TreeNode | TreeNode[],\n): TreeNode[] {\n\tif (!Array.isArray(tree)) { tree = [tree]; }\n\tconst newList: TreeNode[] = [];\n\tfor (const src of recursive2iterable(source)) {\n\t\tconst node = toElement(src);\n\t\tif (!node) { continue; }\n\t\tconst index = tree.findIndex(it =>\n\t\t\tit.tag === node.tag && it.key === node.key\n\t\t);\n\t\tif (index >= 0) {\n\t\t\tnewList.push(updateItem(nObject, node, tree[index]));\n\t\t\ttree.splice(index, 1);\n\t\t} else {\n\t\t\tnewList.push(createItem(nObject, node));\n\t\t}\n\t}\n\tdestroy(tree);\n\treturn newList;\n}\n\n/**\n * 更新树节点\n * @param tree 已有树\n * @param source 用于替换的源\n * @param nObject Neep 对象\n */\nfunction updateItem(\n\tnObject: NeepObject,\n\tsource: NeepNode,\n\ttree?: TreeNode | TreeNode[],\n): TreeNode {\n\tif (!tree) {\n\t\treturn createItem(nObject, source);\n\t}\n\tif (!source) {\n\t\tdestroy(tree);\n\t\treturn { tag: null, children: [] };\n\t}\n\tif (Array.isArray(tree)) {\n\t\tif (!tree.length) { return createItem(nObject, source); }\n\t\tconst index = tree.findIndex(it => it.tag === source.tag);\n\t\tif (index < 0) {\n\t\t\tdestroy(tree);\n\t\t\treturn createItem(nObject, source);\n\t\t}\n\t\tconst all = tree;\n\t\t[tree] = tree.splice(index, 1);\n\t\tdestroy(all);\n\t}\n\tconst { tag } = source;\n\tif (tag !== tree.tag) {\n\t\tdestroy(tree);\n\t\treturn createItem(nObject, source);\n\t}\n\tif (!tag) { return { tag: null, children: [] }; }\n\tif (typeof tag !== 'string') {\n\t\tif (tag[typeSymbol] === 'simple') {\n\t\t\treturn {\n\t\t\t\t...source,\n\t\t\t\tchildren: convert(\n\t\t\t\t\tnObject,\n\t\t\t\t\tsource.children,\n\t\t\t\t\ttree.children,\n\t\t\t\t),\n\t\t\t\tcomponent: undefined,\n\t\t\t};\n\t\t}\n\t\tconst { component } = tree;\n\t\tif (!component) { return createItem(nObject, source); }\n\t\tcomponent.update(source.props || {}, source.children);\n\t\treturn { ...source, children: [], component };\n\t}\n\tif (tag === Tags.Container) {\n\t\tconst { component } = tree;\n\t\tif (!component) { return createItem(nObject, source); }\n\t\tconst type = source?.props?.type;\n\t\tconst iRender = type ? getRender(type) : nObject.iRender;\n\t\tif (iRender !== component.iRender) {\n\t\t\treturn createItem(nObject, source);\n\t\t}\n\t\tcomponent.update(source.props || {}, source.children);\n\t\treturn { ...source, children: [], component };\n\t}\n\tif (tag === Tags.Value) {\n\t\treturn { ...source, children: [] };\n\t}\n\tif (tag === Template || tag.substr(0, 5) === 'Neep:') {\n\t\tlet delivered: any;\n\t\tif (Tags.Deliver === tag) {\n\t\t\tconst props = { ...source.props };\n\t\t\tdelete props.ref;\n\t\t\tdelete props.slot;\n\t\t\tdelete props.key;\n\t\t\tdelivered = updateProps(\n\t\t\t\ttree.$__neep__delivered,\n\t\t\t\tprops,\n\t\t\t\ttree.props,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\t\treturn {\n\t\t\t...source,\n\t\t\t$__neep__delivered: delivered,\n\t\t\tchildren: convert(\n\t\t\t\tnObject,\n\t\t\t\tsource.children,\n\t\t\t\ttree.children,\n\t\t\t),\n\t\t};\n\t}\n\treturn {\n\t\t...source,\n\t\tchildren: convert(nObject, source.children, tree.children),\n\t};\n}\n\n\nfunction createAll(\n\tnObject: NeepObject,\n\tsource: any[],\n): (TreeNode | TreeNode[])[] {\n\tif (!source.length) { return []; }\n\treturn (source as any[]).map(item => {\n\t\tif (!Array.isArray(item)) {\n\t\t\treturn createItem(nObject, toElement(item));\n\t\t}\n\t\treturn [...recursive2iterable(item)]\n\t\t\t.map(it => createItem(nObject, toElement(it)));\n\t});\n}\nfunction *updateAll(\n\tnObject: NeepObject,\n\tsource: any[],\n\ttree: (TreeNode | TreeNode[])[],\n): Iterable<TreeNode | TreeNode[]> {\n\tlet index = 0;\n\tlet length = Math.min(source.length, source.length);\n\tfor (; index < length; index++) {\n\t\tconst src = source[index];\n\t\tif (Array.isArray(src)) {\n\t\t\tyield updateList(nObject, src, tree[index]);\n\t\t} else {\n\t\t\tyield updateItem(nObject, toElement(src), tree[index]);\n\t\t}\n\t}\n\tlength = Math.max(source.length, source.length);\n\tif (tree.length > length) {\n\t\t\t// 销毁多余项\n\t\t\tfor (; index < length; index++) {\n\t\t\t\tdestroy(tree[index]);\n\t\t\t}\n\t}\n\tif (source.length > length) {\n\t\t// 创建多余项\n\t\tfor (; index < length; index++) {\n\t\t\tconst src = toElement(source[index]);\n\t\t\tif (Array.isArray(src)) {\n\t\t\t\tyield [...recursive2iterable(src)]\n\t\t\t\t\t.map(it => createItem(nObject, it));\n\t\t\t} else {\n\t\t\t\tyield createItem(nObject, src);\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * 更新树\n * @param source 用于替换的源\n * @param nObject Neep 对象\n * @param tree 已有树\n */\nfunction convert(\n\tnObject: NeepObject,\n\tsource: any,\n\ttree?: (TreeNode | TreeNode[])[],\n): (TreeNode | TreeNode[])[] {\n\tif (!Array.isArray(source)) { source = [source]; }\n\tif (!tree) {\n\t\treturn createAll(nObject, source);\n\t}\n\treturn [...updateAll(nObject, source, tree)];\n}\n\n\nexport default convert;\n","import {\n\tIRender,\n\tMountProps,\n\tNativeNode,\n\tNativeContainer,\n\tDelivered,\n} from '../type';\nimport { Tags } from '../auxiliary';\nimport { createMountedNode } from './id';\nimport convert, { destroy } from './convert';\nimport draw, { unmount, getNodes, MountedNode, setRefList } from './draw';\nimport NeepObject, { setCompleteList, complete } from './Object';\nimport { nextFrame, isValue, monitorable } from '../install';\n\n\nlet awaitDraw = new Set<Container>();\nlet requested = false;\nfunction markDraw(c: Container) {\n\tawaitDraw.add(c);\n\tif (requested) { return; }\n\trequested = true;\n\tnextFrame(() => {\n\t\trequested = false;\n\t\tconst list = [...awaitDraw];\n\t\tawaitDraw.clear();\n\t\tlist.map(c => c.drawAll());\n\t});\n}\n\nexport default class Container extends NeepObject {\n\tprops: MountProps;\n\t/** 组件树结构 */\n\tcontent: (MountedNode | MountedNode[])[] = [];\n\t_node: NativeNode | null = null;\n\t_container: NativeContainer | null = null;\n\treadonly rootContainer: Container = this;\n\tconstructor(\n\t\tiRender: IRender,\n\t\tprops: MountProps,\n\t\tchildren: any[],\n\t\tparent?: NeepObject,\n\t\tdelivered?: Delivered,\n\t) {\n\t\tsuper(iRender, parent, delivered);\n\t\tthis.props = props;\n\t\tthis.parent = parent;\n\t\tif (parent) {\n\t\t\tthis.rootContainer = parent.container.rootContainer;\n\t\t}\n\t\tthis.callHook('beforeCreate');\n\t\tthis._render = () => children;\n\t\tthis._nodes = convert(this, children);\n\t\tthis.callHook('created');\n\t\tthis.created = true;\n\t}\n\t_drawChildren = false;\n\t_drawContainer = false;\n\tsetChildren(children: any[]): void {\n\t\tif (this.destroyed) { return; }\n\t\tthis.childNodes = children;\n\t\tthis._render = () => children;\n\t\tthis._drawChildren = true;\n\t\tthis.refresh();\n\t}\n\tsetProps(props: MountProps): void {\n\t\tif (this.destroyed) { return; }\n\t\tthis.props = props;\n\t\tthis._drawContainer = true;\n\t\tthis.refresh();\n\t}\n\t/** 更新属性及子代 */\n\tupdate(props: MountProps, children: any[]): void {\n\t\tthis.refresh(() => {\n\t\t\tthis.setProps(props);\n\t\t\tthis.setChildren(children);\n\t\t});\n\t}\n\trequestDraw() {\n\t\tthis.markDraw(this);\n\t}\n\t_mount() {\n\t\tconst { props, parent, iRender } = this;\n\t\tconst content = draw(this.container.iRender, this._nodes);\n\t\tthis.content = content;\n\t\tconst [container, node]\n\t\t\t= iRender.mount(props, isValue, parent?.iRender);\n\t\tfor (const it of getNodes(content)) {\n\t\t\tiRender.insert(container, it);\n\t\t}\n\t\tthis.tree = [createMountedNode({\n\t\t\ttag: Tags.Value,\n\t\t\tcomponent: undefined,\n\t\t\tnode,\n\t\t\tvalue: node,\n\t\t\tchildren: [],\n\t\t})];\n\t\tthis._node = node;\n\t\tthis._container = container;\n\t}\n\t_destroy() {\n\t\tdestroy(this.content);\n\t}\n\t_unmount() {\n\t\tconst { parent, iRender } = this;\n\t\tif (parent) {\n\t\t\tunmount(parent.iRender, this.tree);\n\t\t}\n\t\tiRender.unmount(\n\t\t\tthis._container!,\n\t\t\tthis._node!,\n\t\t\tBoolean(parent),\n\t\t);\n\t\tunmount(this.iRender, this.content);\n\t}\n\t_draw() {\n\t\tconst {\n\t\t\t_drawChildren: drawChildren,\n\t\t\t_drawContainer: drawContainer,\n\t\t} = this;\n\t\tthis._drawContainer = false;\n\t\tif (drawContainer) {\n\t\t\tthis.iRender.drawContainer(\n\t\t\t\tthis._container!,\n\t\t\t\tthis._node!,\n\t\t\t\tthis.props,\n\t\t\t\tisValue,\n\t\t\t\tthis.parent?.iRender,\n\t\t\t);\n\t\t}\n\t\tif (this.parent && this.parent.iRender !== this.iRender) {\n\t\t\treturn;\n\t\t}\n\t\tthis._drawChildren = false;\n\t\tif (drawChildren) {\n\t\t\tthis.content = draw(\n\t\t\t\tthis.iRender,\n\t\t\t\tthis._nodes,\n\t\t\t\tthis.content,\n\t\t\t);\n\t\t}\n\t}\n\t_drawSelf() {\n\t\tconst {\n\t\t\t_drawChildren: drawChildren,\n\t\t\t_drawContainer: drawContainer,\n\t\t} = this;\n\t\tthis._needDraw = false;\n\t\tthis._drawChildren = false;\n\t\tthis._drawContainer = false;\n\t\tif (drawContainer) {\n\t\t\tthis.iRender.drawContainer(\n\t\t\t\tthis._container!,\n\t\t\t\tthis._node!,\n\t\t\t\tthis.props,\n\t\t\t\tisValue,\n\t\t\t\tthis.parent?.iRender,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\t\tif (drawChildren) {\n\t\t\tthis.content = draw(\n\t\t\t\tthis.iRender,\n\t\t\t\tthis._nodes,\n\t\t\t\tthis.content,\n\t\t\t);\n\t\t}\n\t}\n\tdrawSelf() {\n\t\tif (!this.mounted) { return; }\n\t\tif (this.destroyed) { return; }\n\t\tthis.callHook('beforeUpdate');\n\t\tmonitorable.exec(\n\t\t\t() => this._drawSelf(),\n\t\t\tc => c && this.markDraw(this),\n\t\t\t{ postpone: true }\n\t\t);\n\t\tcomplete(() => this.callHook('updated'));\n\t}\n\t/** 等待重画的项目 */\n\tprivate _awaitDraw = new Set<NeepObject>();\n\t/** 自身是否需要重绘 */\n\tprivate _needDraw = false;\n\t/** 标记需要绘制的元素 */\n\tmarkDraw(\n\t\tnObject: NeepObject,\n\t\tremove = false,\n\t) {\n\t\tif (this.parent?.iRender === this.iRender) {\n\t\t\tthis.parent.container.markDraw(nObject, remove);\n\t\t\treturn;\n\t\t}\n\t\tif (nObject === this && this.parent) {\n\t\t\tthis.parent.container.markDraw(this, remove);\n\t\t\tthis._needDraw = !remove;\n\t\t} else if (remove) {\n\t\t\tthis._awaitDraw.delete(nObject);\n\t\t} else {\n\t\t\tthis._awaitDraw.add(nObject);\n\t\t}\n\t\tthis.rootContainer.markDrawContainer(\n\t\t\tthis,\n\t\t\t!this._needDraw && !this._awaitDraw.size || this.destroyed,\n\t\t);\n\t}\n\tdrawContainer() {\n\t\tconst {\n\t\t\t_node: node,\n\t\t\t_container: container,\n\t\t\t_awaitDraw: awaitDraw,\n\t\t} = this;\n\t\tif (!node || !container) { return; }\n\t\tthis.callHook('beforeDraw');\n\t\tconst needDraw = this._needDraw;\n\t\tthis._needDraw = false;\n\t\tconst list = [...awaitDraw];\n\t\tawaitDraw.clear();\n\t\tif (needDraw) { this.drawSelf(); }\n\t\tlist.map(c => c.draw());\n\t\tthis.iRender.draw(container, node);\n\t\tcomplete(() => this.callHook('drawn'));\n\t}\n\tprivate _containers = new Set<Container>();\n\tmarkDrawContainer(\n\t\tcontainer: Container,\n\t\tremove = false,\n\t) {\n\t\tif (remove) {\n\t\t\tthis._containers.delete(container);\n\t\t} else {\n\t\t\tthis._containers.add(container);\n\t\t}\n\t\tmarkDraw(this);\n\t}\n\tdrawAll() {\n\t\tconst containers = this._containers;\n\t\tif (!containers.size) { return; }\n\t\tthis.callHook('beforeDrawAll');\n\t\tconst refs: (() => void)[] = [];\n\t\tconst completeList: (() => void)[] = [];\n\t\tsetCompleteList(completeList);\n\t\tsetRefList(refs);\n\t\tconst list = [...containers];\n\t\tcontainers.clear();\n\t\tlist.forEach(c => c.drawContainer());\n\t\tsetRefList();\n\t\trefs.forEach(r => r());\n\t\tcompleteList.forEach(r => r());\n\t\tthis.callHook('drawnAll');\n\t}\n}\n","import {\n\tMountProps,\n\tNeepElement,\n\tComponent,\n\tRootExposed,\n} from '../type';\nimport { isElement, createElement } from '../auxiliary';\nimport { isProduction } from '../constant';\nimport { devtools, getRender } from '../install';\nimport Container from './Container';\n\nexport function render(\n\te?: NeepElement | Component,\n\tp: MountProps = {},\n): RootExposed {\n\tlet params = {...p};\n\tconst container =  new Container(\n\t\tgetRender(p.type),\n\t\tparams,\n\t\te === undefined ? [] : isElement(e) ? [e] : [createElement(e)],\n\t);\n\tif (!isProduction) {\n\t\tdevtools.renderHook(container);\n\t}\n\tconst { exposed } = container;\n\tReflect.defineProperty(exposed, '$update', {\n\t\tvalue(c?: NeepElement | Component) {\n\t\t\tcontainer.setChildren(c === undefined ? []\n\t\t\t\t: isElement(c) ? [c] : [createElement(c)]);\n\t\t\treturn exposed;\n\t\t},\n\t\tconfigurable: true,\n\t});\n\tReflect.defineProperty(exposed, '$mount', {\n\t\tvalue(target?: any) {\n\t\t\tif (exposed.$mounted) { return exposed; }\n\t\t\tif (target) {\n\t\t\t\tparams.target = target;\n\t\t\t\tcontainer.setProps(params);\n\t\t\t}\n\t\t\tcontainer.mount();\n\t\t\treturn exposed;\n\t\t},\n\t\tconfigurable: true,\n\t});\n\tReflect.defineProperty(exposed, '$unmount', {\n\t\tvalue() {\n\t\t\tif (!exposed.$mounted) { return; }\n\t\t\tif (exposed.$unmounted) { return; }\n\t\t\tif (exposed.$destroyed) { return container.destroy(); }\n\t\t\tcontainer.unmount();\n\t\t\treturn;\n\t\t},\n\t\tconfigurable: true,\n\t});\n\tif (params.target) {\n\t\tcontainer.mount();\n\t}\n\treturn exposed as any as RootExposed;\n}\nexport { default as refresh } from './refresh';\n","import { Component, Render, Marks } from './type';\nimport { nameSymbol, typeSymbol, renderSymbol } from './symbols';\n\n/** 组件标记函数 */\nexport interface Mark {\n\t<N extends Component<any, any>>(component: N): N;\n}\n\n/**\n * 创建组件标记函数\n */\nfunction Mark<S extends keyof Marks>(\n\tsymbol: S,\n\tvalue: Component[S],\n): Mark {\n\treturn component => {\n\t\tcomponent[symbol] = value as any;\n\t\treturn component;\n\t};\n}\n\n\n/** 标记组件名称 */\nexport function mName(name: string): Mark;\nexport function mName<N extends Component<any, any>>(\n\tname: string,\n\tcomponent: N,\n): N;\nexport function mName<N extends Component<any, any>>(\n\tname: string,\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(nameSymbol, name); }\n\tcomponent[nameSymbol] = name;\n\treturn component;\n}\n\n/** 标记组件类型 */\nexport function mType(type?: 'native' | 'simple' | 'standard'): Mark;\nexport function mType<N extends Component<any, any>>(\n\ttype: 'native' | 'simple' | 'standard',\n\tcomponent: N,\n): N;\nexport function mType<N extends Component<any, any>>(\n\ttype?: 'native' | 'simple' | 'standard',\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(typeSymbol, type); }\n\tcomponent[typeSymbol] = type;\n\treturn component;\n}\n/** 标记为简单组件 */\nexport function mSimple(): Mark;\nexport function mSimple<N extends Component<any, any>>(\n\tcomponent: N,\n): N;\nexport function mSimple<N extends Component<any, any>>(\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(typeSymbol, 'simple'); }\n\tcomponent[typeSymbol] = 'simple';\n\treturn component;\n}\n/** 标记为原生组件 */\nexport function mNative(): Mark;\nexport function mNative<N extends Component<any, any>>(\n\tcomponent: N,\n): N;\nexport function mNative<N extends Component<any, any>>(\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(typeSymbol, 'native'); }\n\tcomponent[typeSymbol] = 'native';\n\treturn component;\n}\n\n/** 标记独立的渲染函数 */\nexport function mRender(fn?: Marks[typeof renderSymbol]): Mark;\nexport function mRender<N extends Component<any, any>>(\n\tfn: Marks[typeof renderSymbol] | undefined,\n\tcomponent: N,\n): N;\nexport function mRender<N extends Component<any, any>>(\n\tfn?: Marks[typeof renderSymbol] | undefined,\n\tcomponent?: N,\n): Mark | N {\n\tif (!component) { return Mark(renderSymbol, fn); }\n\tcomponent[renderSymbol] = fn;\n\treturn component;\n}\n\nexport function create<P extends object>(\n\tc: Component<P, never>,\n): Component<P, never>;\nexport function create<\n\tP extends object = object,\n\tR extends object = object,\n>(c: Component<P, R>, r: Render<R>): Component<P, R>;\nexport function create<T extends Component<any, any>>(\n\tc: T,\n\tr?: Render,\n): T {\n\tif (typeof r === 'function') {\n\t\tc[renderSymbol] = r;\n\t}\n\treturn c;\n}\n\nexport function mark<N extends Component<any, any>>(\n\tcomponent: N,\n\t...marks: Mark[]\n): N {\n\tfor (const m of marks) { m(component); }\n\treturn component;\n}\n"],"names":["version","mode","isProduction","NeepError","Error","constructor","message","tag","assert","v","monitorable","value","computed","isValue","encase","recover","installMonitorable","api","nextFrameApi","nextFrame","fn","renders","Object","create","getRender","type","default","addRender","render","installRender","Array","isArray","devtools","renderHook","installDevtools","tools","install","apis","ScopeSlot","SlotRender","Slot","Value","Container","Deliver","Template","Fragment","current","setCurrent","entity","oldEntity","$_valueIndex","ret","$_values","length","checkCurrent","name","initOnly","created","constructors","initContext","context","exposed","addContextConstructor","push","safeify","hooks","setHook","id","hook","list","$_hooks","set","Set","add","delete","callHook","watch","cb","stop","s","useValue","index","values","undefined","setValue","obj","opt","includes","Reflect","defineProperty","get","configurable","enumerable","expose","deliver","delivered","isElementSymbol","Symbol","for","typeSymbol","nameSymbol","renderSymbol","isElement","createElement","attrs","children","node","key","slot","ref","Tags","argv","args","props","on","k","onInfo","exec","nCmd","elements","n","concat","simple","label","setLabel","l","getLabel","text","color","auxiliary","Life","Element","Dev","Constant","State","setAuxiliary","defineAuxiliary","ids","Nodes","IdMap","Map","createMountedNode","recoveryMountedNode","recursive2iterable","it","refList","setRefList","setRef","isRemove","getLastNode","tree","component","getFirstNode","getNodes","unmount","iRender","forEach","e","remove","replace","newTree","oldTree","next","parent","insert","updateList","source","createItem","newList","mountedMap","src","findIndex","old","item","updateItem","splice","size","filter","t","has","last","i","o","updateAll","Math","min","max","createList","all","draw","createValue","substr","update","createAll","isNode","RegExp","String","Date","toISOString","placeholder","map","mount","getSlots","slots","native","nativeList","ownKeys","el","renderSlots","createSlots","inserted","setSlots","updateProps","oldProps","define","newKeys","execSimple","nObject","container","slotMap","childNodes","refresh","f","result","nodes","renderNode","execSlot","slotName","newDelivered","$__neep__delivered","normalize","Boolean","delayedRefresh","objectSet","wait","run","clear","asyncRefresh","async","createExposed","cfg","$parent","$component","$isContainer","$created","$destroyed","destroyed","$mounted","mounted","$unmounted","unmounted","completeList","setCompleteList","complete","createEntity","isContainer","writable","h","bind","NeepObject","parentDelivered","canRefresh","_delayedRefresh","needRefresh","_needRefresh","requestDraw","_refreshing","_render","_nodes","convert","_update","_destroy","destroy","__executed_destroy","_mount","__executed_mount","c","postpone","_cancelDrawMonitor","_unmount","__executed_mounted","_draw","nativeNodes","createContext","initRender","changed","resultOnly","createExecutable","stopRender","Entity","_shadow","_stopRender","markDraw","shadowTree","nativeTree","toElement","awaitDraw","requested","drawAll","rootContainer","setChildren","_drawChildren","setProps","_drawContainer","content","_node","_container","drawChildren","drawContainer","_drawSelf","_needDraw","drawSelf","_awaitDraw","markDrawContainer","needDraw","_containers","containers","refs","r","p","params","target","Mark","symbol","mName","mType","mSimple","mNative","mRender","mark","marks","m"],"mappings":"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"}