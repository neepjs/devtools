{"version":3,"file":"neep.web.render.esm.min.js","sources":["../src/update.ts","../../core/src/render/recursive.ts","../src/props.ts","../src/nextFrame.ts","../src/createElement.ts","../src/index.ts"],"sourcesContent":["import {\n\trecursive2iterable, RecursiveItem,\n} from '../../core/src/render/recursive';\nimport * as monitorable from 'monitorable';\nimport { getElementModel, ModelInfo, setAttrs } from './props';\n\nfunction getId(v: any): string | undefined {\n\tif (typeof v === 'string') { return v; }\n\tif (typeof v === 'number') { return String(v); }\n\treturn undefined;\n}\nfunction getClass(\n\tlist: RecursiveItem<(string | {[k: string]: any})>\n): Set<string> | undefined {\n\tconst set = new Set<string>();\n\tfor (const v of recursive2iterable(list)) {\n\t\tif (!v) { continue; }\n\t\tif (typeof v === 'string') {\n\t\t\tfor (let k of v.split(' ').filter(Boolean)) {\n\t\t\t\tset.add(k);\n\t\t\t}\n\t\t} else if (typeof v === 'object') {\n\t\t\tfor (const k in v) {\n\t\t\t\tconst add = v[k];\n\t\t\t\tfor (let it of k.split(' ').filter(Boolean)) {\n\t\t\t\t\tset[add ? 'add' : 'delete'](it);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (!set.size) { return undefined; }\n\treturn set;\n}\n\nfunction getStyle(\n\tstyle: any\n): string | Record<string, [string, 'important' | null]> | undefined {\n\tif (typeof style === 'string') { return style; }\n\tif (!style) { return undefined; }\n\tif (typeof style !== 'object') { return undefined; }\n\tconst css: Record<string, [string, 'important' | null]> =\n\t\tObject.create(null);\n\tfor (let k in style) {\n\t\tlet value = style[k];\n\t\tconst key = k.substr(0, 2) === '--' ? k\n\t\t\t: k.replace(/[A-Z]/g, '-$1')\n\t\t\t\t.replace(/-+/g, '-')\n\t\t\t\t.toLowerCase();\n\t\tif (typeof value === 'number') {\n\t\t\tcss[key] = [value === 0 ? '0' : `${value}px`, null];\n\t\t} else if (value && typeof value === 'string') {\n\t\t\tconst v = value.replace(/\\!important\\s*$/, '');\n\t\t\tcss[key] = [v, v === value ? null : 'important'];\n\t\t}\n\t}\n\treturn css;\n}\n\nfunction stringify(\n\tdata: any,\n\tisOn = false,\n): string | null | undefined {\n\tif (data === undefined || data === null) { return data; }\n\tif (isOn && typeof data === 'function') { return undefined; }\n\tif (typeof data === 'boolean') { return data ? '' : null; }\n\tif (typeof data !== 'object') { return String(data); }\n\tif (data instanceof Date) {\n\t\treturn data.toISOString();\n\t}\n\tif (data instanceof RegExp) {\n\t\treturn data.toString();\n\t}\n\treturn JSON.stringify(data);\n}\nfunction getAttrs(\n\tprops: {[k: string]: any},\n\thasStyle: boolean,\n\tisValue: typeof monitorable.isValue,\n) {\n\tconst attrs: Record<string, string | null> = Object.create(null);\n\tfor (const k in props) {\n\t\tif (!/^[a-zA-Z0-9_-]/.test(k[0])) { continue; }\n\t\tconst name = k\n\t\t\t.replace(/([A-Z])/g, '-$1')\n\t\t\t.replace(/(\\-)\\-+/g, '$1')\n\t\t\t.toLowerCase();\n\t\tswitch(name) {\n\t\t\tcase 'style':\n\t\t\t\tif (!hasStyle) { break; }\n\t\t\tcase 'ref':\n\t\t\tcase 'is':\n\t\t\tcase 'id':\n\t\t\tcase 'class':\n\t\t\t\tcontinue;\n\t\t}\n\t\tlet data = props[k];\n\t\tif (isValue(data)) { data = data(); }\n\t\tconst value = stringify(data, name.substr(0, 2) === 'on');\n\t\tif (value !== undefined) { attrs[name] = value; }\n\t}\n\treturn attrs;\n}\nfunction getEvent(\n\tprops: {[k: string]: any},\n\tisValue: typeof monitorable.isValue,\n\tmodelInfo?: ModelInfo,\n) {\n\tconst evt: Record<string, Set<EventListener>> = Object.create(null);\n\tfunction addEvt(name: string, f: EventListener) {\n\t\tlet set = evt[name];\n\t\tif (!set) {\n\t\t\tset = new Set();\n\t\t\tevt[name] = set;\n\t\t}\n\t\tset.add(f);\n\t}\n\tfor (const k in props) {\n\t\tconst f = props[k];\n\t\tif (typeof f !== 'function') { continue; }\n\t\tif (k[0] !== '@' && k.substr(0, 2) !== 'on') { continue; }\n\t\tconst name = k.substr(k[0] === '@' ? 1 : 2).toLowerCase();\n\t\taddEvt(name, f);\n\t}\n\tif (modelInfo) {\n\t\tconst [prop, name , t] = modelInfo;\n\t\tconst value = props[prop];\n\t\tif (isValue(value)) {\n\t\t\taddEvt(name, e => value(t(e)));\n\t\t}\n\t}\n\treturn evt;\n}\ninterface Props {\n\tid?: string;\n\tclasses?: Set<string>;\n\tstyle?: string | Record<string, [string, 'important' | null]>;\n\tattrs: Record<string, string | null>;\n\tevent: Record<string, Set<EventListener>>;\n}\nfunction getProps(\n\t{\n\t\tid,\n\t\tclass: className,\n\t\tstyle,\n\t\t...attrs\n\t}: {[k: string]: any},\n\thasStyle: boolean,\n\tisValue: typeof monitorable.isValue,\n\tmodelInfo?: ModelInfo,\n): Props {\n\treturn {\n\t\tid: getId(isValue(id) ? id() : id),\n\t\tclasses: getClass(isValue(className) ? id() : className),\n\t\tstyle: hasStyle ? getStyle(isValue(style) ? style() : style) : undefined,\n\t\tattrs: getAttrs(attrs, hasStyle, isValue),\n\t\tevent: getEvent(attrs, isValue, modelInfo),\n\t};\n}\n\nfunction updateClass(\n\tel: Element,\n\tclasses?: Set<string>,\n\toClasses?: Set<string>,\n) {\n\tif (classes && oClasses) {\n\t\tconst list = el.getAttribute('class') || '';\n\t\tconst classList = new Set(list.split(' ').filter(Boolean));\n\t\toClasses.forEach(c => classList.delete(c));\n\t\tclasses.forEach(c => classList.add(c));\n\t\tel.setAttribute('class', [...classList].join(' '));\n\t} else if (classes) {\n\t\tel.setAttribute('class', [...classes].join(' '));\n\t} else if (oClasses) {\n\t\tel.removeAttribute('class');\n\t}\n}\nfunction updateStyle(\n\tcss: CSSStyleDeclaration,\n\tstyle?: string | Record<string, [string, 'important' | null]>,\n\toStyle?: string | Record<string, [string, 'important' | null]>,\n) {\n\tif (!style) {\n\t\tif (!oStyle) { return; }\n\t\tif (typeof oStyle === 'string') {\n\t\t\tcss.cssText = '';\n\t\t\treturn;\n\t\t}\n\t\tfor (const k of Object.keys(oStyle)) {\n\t\t\tcss.removeProperty(k);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (typeof style === 'string') {\n\t\tif (style !== typeof oStyle) {\n\t\t\tcss.cssText = style;\n\t\t}\n\t\treturn;\n\t}\n\tif (!oStyle || typeof oStyle === 'string') {\n\t\tif (typeof oStyle === 'string') {\n\t\t\tcss.cssText = '';\n\t\t}\n\t\tfor (const k of Object.keys(style)) {\n\t\t\tcss.setProperty(k, ...style[k]);\n\t\t}\n\t\treturn;\n\t}\n\n\tfor (const k of Object.keys(style)) {\n\t\tconst v = style[k];\n\t\tif (\n\t\t\t!oStyle[k]\n\t\t\t|| oStyle[k][0] !== v[0]\n\t\t\t|| oStyle[k][1] !== v[1]\n\t\t) {\n\t\t\tcss.setProperty(k, ...v);\n\t\t}\n\t}\n\tfor (const k of Object.keys(oStyle)) {\n\t\tif (!style[k]) {\n\t\t\tcss.removeProperty(k);\n\t\t}\n\t}\n}\nfunction updateAttrs(\n\tel: Element,\n\tattrs: Record<string, string | null>,\n\toAttrs: Record<string, string | null>,\n) {\n\tfor (const k of Object.keys(attrs)) {\n\t\tconst v = attrs[k];\n\t\tif (!(k in oAttrs) || oAttrs[k] !== v) {\n\t\t\tif (v === null) {\n\t\t\t\tel.removeAttribute(k);\n\t\t\t} else {\n\t\t\t\tel.setAttribute(k, v);\n\t\t\t}\n\t\t}\n\t}\n\tfor (const k of Object.keys(oAttrs)) {\n\t\tif (!(k in attrs)) {\n\t\t\tel.removeAttribute(k);\n\t\t}\n\t}\n\tsetAttrs(el, attrs);\n}\n\nfunction updateEvent(\n\tel: Element,\n\tevt: Record<string, Set<EventListener>>,\n\toEvt: Record<string, Set<EventListener>>,\n) {\n\n\tfor (const k of Object.keys(evt)) {\n\t\tconst set = evt[k];\n\t\tif (k in oEvt) {\n\t\t\tconst oSet = oEvt[k];\n\t\t\tfor (const f of set) {\n\t\t\t\tif (!oSet.has(f)) { el.addEventListener(k, f); }\n\t\t\t}\n\t\t\tfor (const f of oSet) {\n\t\t\t\tif (!set.has(f)) { el.removeEventListener(k, f); }\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const f of set) {\n\t\t\t\tel.addEventListener(k, f);\n\t\t\t}\n\t\t}\n\t}\n\tfor (const k of Object.keys(oEvt)) {\n\t\tif (k in evt) { continue; }\n\t\tfor (const f of oEvt[k]) {\n\t\t\tel.removeEventListener(k, f);\n\t\t}\n\t}\n}\n\nconst PropsMap = new WeakMap<Element, Props>();\nexport default function update(\n\tel: Element,\n\tprops: {[k: string]: any},\n\tisValue: typeof monitorable.isValue,\n) {\n\tconst css = (el as any).style;\n\tconst hasStyle = css instanceof CSSStyleDeclaration;\n\tconst old = PropsMap.get(el) || { attrs: {}, event: {} };\n\n\tconst { id,  classes, style, attrs, event } =\n\t\tgetProps(props, hasStyle, isValue, getElementModel(el));\n\tPropsMap.set(el, { id, classes, style, attrs, event });\n\tif (id !== old.id) {\n\t\tif (typeof id === 'string') {\n\t\t\tel.id = props.id;\n\t\t} else {\n\t\t\tel.removeAttribute('id');\n\t\t}\n\t}\n\tupdateClass(el, classes, old.classes);\n\tif (hasStyle) { updateStyle(css, style, old.style); }\n\tupdateAttrs(el, attrs, old.attrs);\n\tupdateEvent(el, event, old.event);\n\treturn el;\n}\n","export interface RecursiveArray<T> extends Array<RecursiveItem<T>>{};\nexport type RecursiveItem<T> = T | RecursiveArray<T>;\n\nexport function *recursive2iterable<T>(\n\tlist: RecursiveItem<T>,\n): Iterable<T> {\n\tif (!Array.isArray(list)) {\n\t\tyield list;\n\t\treturn;\n\t}\n\tfor (const it of list) {\n\t\tyield* recursive2iterable(it);\n\t}\n}\n","export type ModelInfo = [string, string, (e: any) => any];\nexport function getElementModel(el: Element): ModelInfo | undefined {\n\tif (el instanceof HTMLInputElement) {\n\t\tswitch(el.type.toLowerCase()) {\n\t\t\tcase 'checkbox':\n\t\t\tcase 'radio':\n\t\t\treturn [\n\t\t\t\t'checked', 'change',\n\t\t\t\t(e: any) => (e.currentTarget as HTMLInputElement).checked\n\t\t\t];\n\t\t}\n\t\treturn [\n\t\t\t'value', 'input',\n\t\t\t(e: any) => (e.currentTarget as HTMLInputElement).value\n\t\t];\n\t}\n\tif (el instanceof HTMLSelectElement) {\n\t\treturn [\n\t\t\t'value', 'select',\n\t\t\t(e: any) => (e.currentTarget as HTMLSelectElement).value\n\t\t];\n\t}\n\treturn ;\n}\n\nexport function setAttrs(el: Element, attrs: Record<string, string | null>) {\n\tif (el instanceof HTMLInputElement && 'checked' in attrs) {\n\n\t\tswitch(el.type.toLowerCase()) {\n\t\t\tcase 'checkbox':\n\t\t\tcase 'radio':\n\t\t\t\tif ((attrs.checked !== null) !== el.checked) {\n\t\t\t\t\tel.checked = attrs.checked !== null;\n\t\t\t\t}\n\t\t}\n\t}\n\n\tif ((el instanceof HTMLSelectElement || el instanceof HTMLInputElement) && 'value' in attrs) {\n\t\tconst value = attrs.value || '';\n\t\tif (el.value !== value) {\n\t\t\tel.value = value;\n\t\t}\n\t}\n\n}","let list: (() => void)[] | undefined;\nexport default function nextFrame(f: () => void) {\n\tif (list) {\n\t\tlist.push(f);\n\t\treturn;\n\t}\n\tlist = [f];\n\twindow.requestAnimationFrame(() => {\n\t\tconst fs = list;\n\t\tlist = undefined;\n\t\tif (!fs) { return; }\n\t\tfs.forEach(f => f());\n\t});\n}","const xmlnsMap: Record<string, string> = {\n\tsvg: 'http://www.w3.org/2000/svg',\n\thtml: 'http://www.w3.org/1999/xhtml',\n\tmathml: 'http://www.w3.org/1998/Math/MathML'\n};\nconst SVGTags = new Set([\n\t'altGlyph',\n\t'altGlyphDef',\n\t'altGlyphItem',\n\t'animate',\n\t'animateColor',\n\t'animateMotion',\n\t'animateTransform',\n\t'circle',\n\t'clipPath',\n\t'color-profile',\n\t'cursor',\n\t'defs',\n\t'desc',\n\t'ellipse',\n\t'feBlend',\n\t'feColorMatrix',\n\t'feComponentTransfer',\n\t'feComposite',\n\t'feConvolveMatrix',\n\t'feDiffuseLighting',\n\t'feDisplacementMap',\n\t'feDistantLight',\n\t'feFlood',\n\t'feFuncA',\n\t'feFuncB',\n\t'feFuncG',\n\t'feFuncR',\n\t'feGaussianBlur',\n\t'feImage',\n\t'feMerge',\n\t'feMergeNode',\n\t'feMorphology',\n\t'feOffset',\n\t'fePointLight',\n\t'feSpecularLighting',\n\t'feSpotLight',\n\t'feTile',\n\t'feTurbulence',\n\t'filter',\n\t'font-face',\n\t'font-face-format',\n\t'font-face-name',\n\t'font-face-src',\n\t'font-face-uri',\n\t'foreignObject',\n\t'g',\n\t'glyph',\n\t'glyphRef',\n\t'hkern',\n\t'image',\n\t'line',\n\t'linearGradient',\n\t'marker',\n\t'mask',\n\t'metadata',\n\t'missing-glyph',\n\t'mpath',\n\t'path',\n\t'pattern',\n\t'polygon',\n\t'polyline',\n\t'radialGradient',\n\t'rect',\n\t'script',\n\t'set',\n\t'stop',\n\t'style',\n\t'svg',\n\t'switch',\n\t'symbol',\n\t'text',\n\t'textPath',\n\t'title',\n\t'tref',\n\t'tspan',\n\t'use',\n\t'view',\n\t'vkern',\n]);\nconst MathMLTags = new Set([\n\t'maction',\n\t'math',\n\t'menclose',\n\t'merror',\n\t'mfenced',\n\t'mfrac',\n\t'mglyph',\n\t'mi',\n\t'mlabeledtr',\n\t'mmultiscripts',\n\t'mn',\n\t'mo',\n\t'mover',\n\t'mpadded',\n\t'mphantom',\n\t'mroot',\n\t'mrow',\n\t'ms',\n\t'mspace',\n\t'msqrt',\n\t'mstyle',\n\t'msub',\n\t'msubsup',\n\t'msup',\n\t'mtable',\n\t'mtd',\n\t'mtext',\n\t'mtr',\n\t'munder',\n\t'munderover',\n\t'semantics',\n])\nexport default function createElement(tagname: string, namespace?: string) {\n\tconst res = /^([a-z][a-z0-9-]*):([a-z0-9-]+)$/i.exec(tagname);\n\tconst tag = res ? res[2] : tagname;\n\tconst ns = (namespace || res?.[1]\n\t\t|| SVGTags.has(tag.toLowerCase()) && 'svg'\n\t\t|| MathMLTags.has(tag.toLowerCase()) && 'mathml' || '').toLowerCase();\n\tif (!ns) {\n\t\treturn document.createElement(tag);\n\t}\n\treturn document.createElementNS(\n\t\tns in xmlnsMap && xmlnsMap[ns] || ns,\n\t\ttag,\n\t);\n}","import {\n\tIRender,\n\tNativeNode,\n\tNativeText,\n\tNativePlaceholder,\n\tNativeComponent,\n\tNativeShadow,\n\tNativeContainer,\n\tNativeElement,\n} from '@neep/core';\nimport update from './update';\nimport nextFrame from './nextFrame';\nimport createElement from './createElement';\n\nconst render: IRender = {\n\ttype: 'web',\n\tnextFrame,\n\tisNode(v): v is NativeNode {\n\t\treturn v instanceof Node;\n\t},\n\tmount({target, class: className, style, tag}, isValue, parent) {\n\t\tif (!(\n\t\t\ttypeof tag === 'string' &&\n\t\t\t/^[a-z][a-z0-9]*(?:\\-[a-z0-9]+)?(?:\\:[a-z0-9]+(?:\\-[a-z0-9]+)?)?$/i.test(tag)\n\t\t)) {\n\t\t\ttag = 'div';\n\t\t}\n\t\tconst container = render.create(tag, { class: className, style }, isValue);\n\t\tif (typeof target === 'string') {\n\t\t\ttarget = document.querySelector(target);\n\t\t}\n\t\tif (target instanceof Element) {\n\t\t\ttarget.appendChild(container as any);\n\t\t\tif (parent) {\n\t\t\t\treturn [container, parent.placeholder] as any;\n\t\t\t}\n\t\t\treturn [container, container];\n\t\t}\n\t\tif (parent !== render) {\n\t\t\tdocument.body.appendChild(container as any);\n\t\t\treturn [container, container] as any;\n\t\t}\n\t\treturn [container, container] as any;\n\t},\n\tunmount(container, node, removed) {\n\t\tif (container === node && removed) { return; }\n\t\t(container as any as Element).remove();\n\t},\n\tdrawContainer(container, node, {target, class: className, style, tag}, isValue, parent) {\n\t\trender.update(container as NativeElement, { class: className, style }, isValue)\n\t\tif (typeof target === 'string') {\n\t\t\ttarget = document.querySelector(target);\n\t\t}\n\t\tif (parent !== render && !(target instanceof Element)) {\n\t\t\ttarget = document.body;\n\t\t}\n\t\tconst oldTarget = parent === render && container === node ? undefined : render.parent(node);\n\t\tif (oldTarget === target) {\n\t\t\treturn [container, node];\n\t\t}\n\t\tif (parent !== render) {\n\t\t\ttarget.appendChild(container);\n\t\t\treturn [container, node];\n\t\t}\n\t\tif (!oldTarget) {\n\t\t\tconst newNode = parent.placeholder();\n\t\t\tconst pNode = parent.parent(node);\n\t\t\tif (pNode) {\n\t\t\t\trender.insert(pNode, newNode as any, node);\n\t\t\t\trender.remove(node);\n\t\t\t}\n\t\t\treturn [container, newNode];\n\t\t}\n\t\tif (!target) {\n\t\t\tconst pNode = parent.parent(node);\n\t\t\tif (pNode) {\n\t\t\t\trender.insert(pNode, container, node);\n\t\t\t\trender.remove(node);\n\t\t\t}\n\t\t\treturn [container, container];\n\n\t\t}\n\t\ttarget.appendChild(node);\n\t\treturn [container, node];\n\t},\n\tdraw() {},\n\n\tcreate(tag, props, isValue) {\n\t\treturn update(createElement(tag), props, isValue) as any;\n\t},\n\ttext(text: string): NativeText {\n\t\treturn document.createTextNode(text) as any;\n\t},\n\tplaceholder(): NativePlaceholder {\n\t\treturn document.createComment('') as any;\n\t},\n\tcomponent(): [NativeComponent, NativeShadow] {\n\t\tconst node = createElement('neep-component');\n\t\treturn [node, node.attachShadow({ mode: 'open' })] as any;\n\t},\n\n\tparent(node: NativeNode): NativeContainer | null {\n\t\treturn (node as any).parentNode as NativeContainer | null;\n\t},\n\tnext(node: NativeNode): NativeNode | null {\n\t\treturn (node as any).nextSibling as NativeContainer | null;\n\t},\n\tupdate(node, props, isValue): void {\n\t\tupdate(node as any, props, isValue);\n\t},\n\tinsert(\n\t\tparent: NativeContainer,\n\t\tnode: NativeNode,\n\t\tnext: NativeNode | null = null,\n\t): void {\n\t\t(parent as any).insertBefore(node, next);\n\t},\n\tremove(node: NativeNode): void {\n\t\tconst p = render.parent(node);\n\t\tif (!p) { return; }\n\t\t(p as any).removeChild(node);\n\t},\n};\n\nexport default render;\n"],"names":["getClass","list","set","Set","v","recursive2iterable","Array","isArray","it","k","split","filter","Boolean","add","size","getStyle","style","css","Object","create","value","key","substr","replace","toLowerCase","stringify","data","isOn","String","Date","toISOString","RegExp","toString","JSON","getAttrs","props","hasStyle","isValue","attrs","test","name","undefined","getEvent","modelInfo","evt","addEvt","f","prop","t","e","updateAttrs","el","oAttrs","keys","removeAttribute","setAttribute","HTMLInputElement","type","checked","HTMLSelectElement","setAttrs","PropsMap","WeakMap","update","CSSStyleDeclaration","old","get","event","id","classes","class","className","getProps","currentTarget","getElementModel","oClasses","getAttribute","classList","forEach","c","delete","join","updateClass","oStyle","setProperty","removeProperty","cssText","updateStyle","oEvt","oSet","has","addEventListener","removeEventListener","updateEvent","xmlnsMap","svg","html","mathml","SVGTags","MathMLTags","createElement","tagname","namespace","res","exec","tag","ns","document","createElementNS","render","nextFrame","push","window","requestAnimationFrame","fs","isNode","Node","mount","target","parent","container","querySelector","Element","appendChild","placeholder","body","unmount","node","removed","remove","drawContainer","oldTarget","newNode","pNode","insert","draw","text","createTextNode","createComment","component","attachShadow","mode","parentNode","next","nextSibling","insertBefore","p","removeChild"],"mappings":"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UACA,gBACA,sBACA,cACA,mBACA,oBACA,oBACA,iBACA,UACA,UACA,UACA,UACA,UACA,iBACA,UACA,UACA,cACA,eACA,WACA,eACA,qBACA,cACA,SACA,eACA,SACA,YACA,mBACA,iBACA,gBACA,gBACA,gBACA,IACA,QACA,WACA,QACA,QACA,OACA,iBACA,SACA,OACA,WACA,gBACA,QACA,OACA,UACA,UACA,WACA,iBACA,OACA,SACA,MACA,OACA,QACA,MACA,SACA,SACA,OACA,WACA,QACA,OACA,QACA,MACA,OACA,UAEKgG,EAAa,IAAIhG,IAAI,CAC1B,UACA,OACA,WACA,SACA,UACA,QACA,SACA,KACA,aACA,gBACA,KACA,KACA,QACA,UACA,WACA,QACA,OACA,KACA,SACA,QACA,SACA,OACA,UACA,OACA,SACA,MACA,QACA,MACA,SACA,aACA,cAEc,SAASiG,EAAcC,EAAiBC,SAChDC,EAAM,oCAAoCC,KAAKH,GAC/CI,EAAMF,EAAMA,EAAI,GAAKF,EACrBK,GAAMJ,IAAaC,MAAAA,SAAAA,EAAM,KAC3BL,EAAQR,IAAIe,EAAIjF,gBAAkB,OAClC2E,EAAWT,IAAIe,EAAIjF,gBAAkB,UAAY,IAAIA,qBACpDkF,EAGEC,SAASC,gBACfF,KAAMZ,GAAYA,EAASY,IAAOA,EAClCD,GAJOE,SAASP,cAAcK,SC/G1BI,EAAkB,CACvBpD,KAAM,MACNqD,UFfc,SAAmBhE,GAC7B7C,EACHA,EAAK8G,KAAKjE,IAGX7C,EAAO,CAAC6C,GACRkE,OAAOC,sBAAsB,WACtBC,EAAKjH,EACXA,OAAOwC,EACFyE,GACLA,EAAGpC,QAAQhC,GAAKA,SEMjBqE,OAAO/G,GACCA,aAAagH,KAErBC,OAAMC,OAACA,EAAQhD,MAAOC,EAAhBvD,MAA2BA,EAA3ByF,IAAkCA,GAAMpE,EAASkF,GAEtC,iBAARd,GACP,oEAAoElE,KAAKkE,KAEzEA,EAAM,aAEDe,EAAYX,EAAO1F,OAAOsF,EAAK,CAAEnC,MAAOC,EAAWvD,MAAAA,GAASqB,SAC5C,iBAAXiF,IACVA,EAASX,SAASc,cAAcH,IAE7BA,aAAkBI,SACrBJ,EAAOK,YAAYH,GACfD,EACI,CAACC,EAAWD,EAAOK,aAEpB,CAACJ,EAAWA,IAEhBD,IAAWV,GACdF,SAASkB,KAAKF,YAAYH,GACnB,CAACA,EAAWA,IAEb,CAACA,EAAWA,IAEpBM,QAAQN,EAAWO,EAAMC,GACpBR,IAAcO,GAAQC,GACzBR,EAA6BS,UAE/BC,cAAcV,EAAWO,GAAMT,OAACA,EAAQhD,MAAOC,EAAhBvD,MAA2BA,EAA3ByF,IAAkCA,GAAMpE,EAASkF,GAC/EV,EAAO9C,OAAOyD,EAA4B,CAAElD,MAAOC,EAAWvD,MAAAA,GAASqB,GACjD,iBAAXiF,IACVA,EAASX,SAASc,cAAcH,IAE7BC,IAAWV,GAAYS,aAAkBI,UAC5CJ,EAASX,SAASkB,YAEbM,EAAYZ,IAAWV,GAAUW,IAAcO,OAAOtF,EAAYoE,EAAOU,OAAOQ,MAClFI,IAAcb,QACV,CAACE,EAAWO,MAEhBR,IAAWV,SACdS,EAAOK,YAAYH,GACZ,CAACA,EAAWO,OAEfI,EAAW,OACTC,EAAUb,EAAOK,cACjBS,EAAQd,EAAOA,OAAOQ,UACxBM,IACHxB,EAAOyB,OAAOD,EAAOD,EAAgBL,GACrClB,EAAOoB,OAAOF,IAER,CAACP,EAAWY,OAEfd,EAAQ,OACNe,EAAQd,EAAOA,OAAOQ,UACxBM,IACHxB,EAAOyB,OAAOD,EAAOb,EAAWO,GAChClB,EAAOoB,OAAOF,IAER,CAACP,EAAWA,UAGpBF,EAAOK,YAAYI,GACZ,CAACP,EAAWO,IAEpBQ,SAEApH,OAAM,CAACsF,EAAKtE,EAAOE,IACX0B,EAAOqC,EAAcK,GAAMtE,EAAOE,GAE1CmG,KAAKA,GACG7B,SAAS8B,eAAeD,GAEhCZ,YAAW,IACHjB,SAAS+B,cAAc,IAE/BC,kBACOZ,EAAO3B,EAAc,wBACpB,CAAC2B,EAAMA,EAAKa,aAAa,CAAEC,KAAM,WAGzCtB,OAAOQ,GACEA,EAAae,WAEtBC,KAAKhB,GACIA,EAAaiB,YAEtBjF,OAAOgE,EAAM5F,EAAOE,GACnB0B,EAAOgE,EAAa5F,EAAOE,IAE5BiG,OACCf,EACAQ,EACAgB,EAA0B,MAEzBxB,EAAe0B,aAAalB,EAAMgB,IAEpCd,OAAOF,SACAmB,EAAIrC,EAAOU,OAAOQ,GACnBmB,GACJA,EAAUC,YAAYpB"}