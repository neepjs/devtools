{"version":3,"file":"neep.web.render.esm.js","sources":["../../core/src/render/recursive.ts","../src/props.ts","../src/update.ts","../src/nextFrame.ts","../src/createElement.ts","../src/index.ts"],"sourcesContent":["export interface RecursiveArray<T> extends Array<RecursiveItem<T>>{};\nexport type RecursiveItem<T> = T | RecursiveArray<T>;\n\nexport function *recursive2iterable<T>(\n\tlist: RecursiveItem<T>,\n): Iterable<T> {\n\tif (!Array.isArray(list)) {\n\t\tyield list;\n\t\treturn;\n\t}\n\tfor (const it of list) {\n\t\tyield* recursive2iterable(it);\n\t}\n}\n","export type ModelInfo = [string, string, (e: any) => any];\nexport function getElementModel(el: Element): ModelInfo | undefined {\n\tif (el instanceof HTMLInputElement) {\n\t\tswitch(el.type.toLowerCase()) {\n\t\t\tcase 'checkbox':\n\t\t\tcase 'radio':\n\t\t\treturn [\n\t\t\t\t'checked', 'change',\n\t\t\t\t(e: any) => (e.currentTarget as HTMLInputElement).checked\n\t\t\t];\n\t\t}\n\t\treturn [\n\t\t\t'value', 'input',\n\t\t\t(e: any) => (e.currentTarget as HTMLInputElement).value\n\t\t];\n\t}\n\tif (el instanceof HTMLSelectElement) {\n\t\treturn [\n\t\t\t'value', 'select',\n\t\t\t(e: any) => (e.currentTarget as HTMLSelectElement).value\n\t\t];\n\t}\n\treturn ;\n}\n\nexport function setAttrs(el: Element, attrs: Record<string, string | null>) {\n\tif (el instanceof HTMLInputElement && 'checked' in attrs) {\n\n\t\tswitch(el.type.toLowerCase()) {\n\t\t\tcase 'checkbox':\n\t\t\tcase 'radio':\n\t\t\t\tif ((attrs.checked !== null) !== el.checked) {\n\t\t\t\t\tel.checked = attrs.checked !== null;\n\t\t\t\t}\n\t\t}\n\t}\n\n\tif ((el instanceof HTMLSelectElement || el instanceof HTMLInputElement) && 'value' in attrs) {\n\t\tconst value = attrs.value || '';\n\t\tif (el.value !== value) {\n\t\t\tel.value = value;\n\t\t}\n\t}\n\n}","import {\n\trecursive2iterable, RecursiveItem,\n} from '../../core/src/render/recursive';\nimport * as monitorable from 'monitorable';\nimport { getElementModel, ModelInfo, setAttrs } from './props';\n\nfunction getId(v: any): string | undefined {\n\tif (typeof v === 'string') { return v; }\n\tif (typeof v === 'number') { return String(v); }\n\treturn undefined;\n}\nfunction getClass(\n\tlist: RecursiveItem<(string | {[k: string]: any})>\n): Set<string> | undefined {\n\tconst set = new Set<string>();\n\tfor (const v of recursive2iterable(list)) {\n\t\tif (!v) { continue; }\n\t\tif (typeof v === 'string') {\n\t\t\tfor (let k of v.split(' ').filter(Boolean)) {\n\t\t\t\tset.add(k);\n\t\t\t}\n\t\t} else if (typeof v === 'object') {\n\t\t\tfor (const k in v) {\n\t\t\t\tconst add = v[k];\n\t\t\t\tfor (let it of k.split(' ').filter(Boolean)) {\n\t\t\t\t\tset[add ? 'add' : 'delete'](it);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (!set.size) { return undefined; }\n\treturn set;\n}\n\nfunction getStyle(\n\tstyle: any\n): string | Record<string, [string, 'important' | null]> | undefined {\n\tif (typeof style === 'string') { return style; }\n\tif (!style) { return undefined; }\n\tif (typeof style !== 'object') { return undefined; }\n\tconst css: Record<string, [string, 'important' | null]> =\n\t\tObject.create(null);\n\tfor (let k in style) {\n\t\tlet value = style[k];\n\t\tconst key = k.substr(0, 2) === '--' ? k\n\t\t\t: k.replace(/[A-Z]/g, '-$1')\n\t\t\t\t.replace(/-+/g, '-')\n\t\t\t\t.toLowerCase();\n\t\tif (typeof value === 'number') {\n\t\t\tcss[key] = [value === 0 ? '0' : `${value}px`, null];\n\t\t} else if (value && typeof value === 'string') {\n\t\t\tconst v = value.replace(/\\!important\\s*$/, '');\n\t\t\tcss[key] = [v, v === value ? null : 'important'];\n\t\t}\n\t}\n\treturn css;\n}\n\nfunction stringify(\n\tdata: any,\n\tisOn = false,\n): string | null | undefined {\n\tif (data === undefined || data === null) { return data; }\n\tif (isOn && typeof data === 'function') { return undefined; }\n\tif (typeof data === 'boolean') { return data ? '' : null; }\n\tif (typeof data !== 'object') { return String(data); }\n\tif (data instanceof Date) {\n\t\treturn data.toISOString();\n\t}\n\tif (data instanceof RegExp) {\n\t\treturn data.toString();\n\t}\n\treturn JSON.stringify(data);\n}\nfunction getAttrs(\n\tprops: {[k: string]: any},\n\thasStyle: boolean,\n\tisValue: typeof monitorable.isValue,\n) {\n\tconst attrs: Record<string, string | null> = Object.create(null);\n\tfor (const k in props) {\n\t\tif (!/^[a-zA-Z0-9_-]/.test(k[0])) { continue; }\n\t\tconst name = k\n\t\t\t.replace(/([A-Z])/g, '-$1')\n\t\t\t.replace(/(\\-)\\-+/g, '$1')\n\t\t\t.toLowerCase();\n\t\tswitch(name) {\n\t\t\tcase 'style':\n\t\t\t\tif (!hasStyle) { break; }\n\t\t\tcase 'ref':\n\t\t\tcase 'is':\n\t\t\tcase 'id':\n\t\t\tcase 'class':\n\t\t\t\tcontinue;\n\t\t}\n\t\tlet data = props[k];\n\t\tif (isValue(data)) { data = data(); }\n\t\tconst value = stringify(data, name.substr(0, 2) === 'on');\n\t\tif (value !== undefined) { attrs[name] = value; }\n\t}\n\treturn attrs;\n}\nfunction getEvent(\n\tprops: {[k: string]: any},\n\tisValue: typeof monitorable.isValue,\n\tmodelInfo?: ModelInfo,\n) {\n\tconst evt: Record<string, Set<EventListener>> = Object.create(null);\n\tfunction addEvt(name: string, f: EventListener) {\n\t\tlet set = evt[name];\n\t\tif (!set) {\n\t\t\tset = new Set();\n\t\t\tevt[name] = set;\n\t\t}\n\t\tset.add(f);\n\t}\n\tfor (const k in props) {\n\t\tconst f = props[k];\n\t\tif (typeof f !== 'function') { continue; }\n\t\tif (k[0] !== '@' && k.substr(0, 2) !== 'on') { continue; }\n\t\tconst name = k.substr(k[0] === '@' ? 1 : 2).toLowerCase();\n\t\taddEvt(name, f);\n\t}\n\tif (modelInfo) {\n\t\tconst [prop, name , t] = modelInfo;\n\t\tconst value = props[prop];\n\t\tif (isValue(value)) {\n\t\t\taddEvt(name, e => value(t(e)));\n\t\t}\n\t}\n\treturn evt;\n}\ninterface Props {\n\tid?: string;\n\tclasses?: Set<string>;\n\tstyle?: string | Record<string, [string, 'important' | null]>;\n\tattrs: Record<string, string | null>;\n\tevent: Record<string, Set<EventListener>>;\n}\nfunction updateClass(\n\tel: Element,\n\tclasses?: Set<string>,\n\toClasses?: Set<string>,\n) {\n\tif (classes && oClasses) {\n\t\tconst list = el.getAttribute('class') || '';\n\t\tconst classList = new Set(list.split(' ').filter(Boolean));\n\t\toClasses.forEach(c => classList.delete(c));\n\t\tclasses.forEach(c => classList.add(c));\n\t\tel.setAttribute('class', [...classList].join(' '));\n\t} else if (classes) {\n\t\tel.setAttribute('class', [...classes].join(' '));\n\t} else if (oClasses) {\n\t\tel.removeAttribute('class');\n\t}\n}\nfunction updateStyle(\n\tcss: CSSStyleDeclaration,\n\tstyle?: string | Record<string, [string, 'important' | null]>,\n\toStyle?: string | Record<string, [string, 'important' | null]>,\n) {\n\tif (!style) {\n\t\tif (!oStyle) { return; }\n\t\tif (typeof oStyle === 'string') {\n\t\t\tcss.cssText = '';\n\t\t\treturn;\n\t\t}\n\t\tfor (const k of Object.keys(oStyle)) {\n\t\t\tcss.removeProperty(k);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (typeof style === 'string') {\n\t\tif (style !== typeof oStyle) {\n\t\t\tcss.cssText = style;\n\t\t}\n\t\treturn;\n\t}\n\tif (!oStyle || typeof oStyle === 'string') {\n\t\tif (typeof oStyle === 'string') {\n\t\t\tcss.cssText = '';\n\t\t}\n\t\tfor (const k of Object.keys(style)) {\n\t\t\tcss.setProperty(k, ...style[k]);\n\t\t}\n\t\treturn;\n\t}\n\n\tfor (const k of Object.keys(style)) {\n\t\tconst v = style[k];\n\t\tif (\n\t\t\t!oStyle[k]\n\t\t\t|| oStyle[k][0] !== v[0]\n\t\t\t|| oStyle[k][1] !== v[1]\n\t\t) {\n\t\t\tcss.setProperty(k, ...v);\n\t\t}\n\t}\n\tfor (const k of Object.keys(oStyle)) {\n\t\tif (!style[k]) {\n\t\t\tcss.removeProperty(k);\n\t\t}\n\t}\n}\nfunction updateAttrs(\n\tel: Element,\n\tattrs: Record<string, string | null>,\n\toAttrs: Record<string, string | null>,\n) {\n\tfor (const k of Object.keys(attrs)) {\n\t\tconst v = attrs[k];\n\t\tif (!(k in oAttrs) || oAttrs[k] !== v) {\n\t\t\tif (v === null) {\n\t\t\t\tel.removeAttribute(k);\n\t\t\t} else {\n\t\t\t\tel.setAttribute(k, v);\n\t\t\t}\n\t\t}\n\t}\n\tfor (const k of Object.keys(oAttrs)) {\n\t\tif (!(k in attrs)) {\n\t\t\tel.removeAttribute(k);\n\t\t}\n\t}\n\tsetAttrs(el, attrs);\n}\n\nfunction updateEvent(\n\tel: Element,\n\tevt: Record<string, Set<EventListener>>,\n\toEvt: Record<string, Set<EventListener>>,\n) {\n\n\tfor (const k of Object.keys(evt)) {\n\t\tconst set = evt[k];\n\t\tif (k in oEvt) {\n\t\t\tconst oSet = oEvt[k];\n\t\t\tfor (const f of set) {\n\t\t\t\tif (!oSet.has(f)) { el.addEventListener(k, f); }\n\t\t\t}\n\t\t\tfor (const f of oSet) {\n\t\t\t\tif (!set.has(f)) { el.removeEventListener(k, f); }\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const f of set) {\n\t\t\t\tel.addEventListener(k, f);\n\t\t\t}\n\t\t}\n\t}\n\tfor (const k of Object.keys(oEvt)) {\n\t\tif (k in evt) { continue; }\n\t\tfor (const f of oEvt[k]) {\n\t\t\tel.removeEventListener(k, f);\n\t\t}\n\t}\n}\n\nconst PropsMap = new WeakMap<Element, Props>();\nexport default function update(\n\tel: Element,\n\tprops: {[k: string]: any},\n\tisValue: typeof monitorable.isValue,\n) {\n\tconst css = (el as any).style;\n\tconst hasStyle = css instanceof CSSStyleDeclaration;\n\tconst old = PropsMap.get(el) || { attrs: {}, event: {} };\n\n\tconst id = getId(isValue(props.id) ? props.id() : props.id);\n\tif (id !== old.id) {\n\t\tif (typeof id === 'string') {\n\t\t\tel.id = props.id;\n\t\t} else {\n\t\t\tel.removeAttribute('id');\n\t\t}\n\t}\n\tconst classes = getClass(isValue(props.className) ? props.className() : props.className);\n\tupdateClass(el, classes, old.classes);\n\tconst style = hasStyle ? getStyle(isValue(props.style) ? props.style() : props.style) : undefined;\n\tif (hasStyle) { updateStyle(css, style, old.style); }\n\tconst attrs = getAttrs(props, hasStyle, isValue);\n\tupdateAttrs(el, attrs, old.attrs);\n\tconst event = getEvent(props, isValue, getElementModel(el));\n\tupdateEvent(el, event, old.event);\n\tPropsMap.set(el, { id, classes, style, attrs, event });\n\treturn el;\n}\n","let list: (() => void)[] | undefined;\nexport default function nextFrame(f: () => void) {\n\tif (list) {\n\t\tlist.push(f);\n\t\treturn;\n\t}\n\tlist = [f];\n\twindow.requestAnimationFrame(() => {\n\t\tconst fs = list;\n\t\tlist = undefined;\n\t\tif (!fs) { return; }\n\t\tfs.forEach(f => f());\n\t});\n}","const xmlnsMap: Record<string, string> = {\n\tsvg: 'http://www.w3.org/2000/svg',\n\thtml: 'http://www.w3.org/1999/xhtml',\n\tmathml: 'http://www.w3.org/1998/Math/MathML'\n};\nconst SVGTags = new Set([\n\t'altGlyph',\n\t'altGlyphDef',\n\t'altGlyphItem',\n\t'animate',\n\t'animateColor',\n\t'animateMotion',\n\t'animateTransform',\n\t'circle',\n\t'clipPath',\n\t'color-profile',\n\t'cursor',\n\t'defs',\n\t'desc',\n\t'ellipse',\n\t'feBlend',\n\t'feColorMatrix',\n\t'feComponentTransfer',\n\t'feComposite',\n\t'feConvolveMatrix',\n\t'feDiffuseLighting',\n\t'feDisplacementMap',\n\t'feDistantLight',\n\t'feFlood',\n\t'feFuncA',\n\t'feFuncB',\n\t'feFuncG',\n\t'feFuncR',\n\t'feGaussianBlur',\n\t'feImage',\n\t'feMerge',\n\t'feMergeNode',\n\t'feMorphology',\n\t'feOffset',\n\t'fePointLight',\n\t'feSpecularLighting',\n\t'feSpotLight',\n\t'feTile',\n\t'feTurbulence',\n\t'filter',\n\t'font-face',\n\t'font-face-format',\n\t'font-face-name',\n\t'font-face-src',\n\t'font-face-uri',\n\t'foreignObject',\n\t'g',\n\t'glyph',\n\t'glyphRef',\n\t'hkern',\n\t'image',\n\t'line',\n\t'linearGradient',\n\t'marker',\n\t'mask',\n\t'metadata',\n\t'missing-glyph',\n\t'mpath',\n\t'path',\n\t'pattern',\n\t'polygon',\n\t'polyline',\n\t'radialGradient',\n\t'rect',\n\t'script',\n\t'set',\n\t'stop',\n\t'style',\n\t'svg',\n\t'switch',\n\t'symbol',\n\t'text',\n\t'textPath',\n\t'title',\n\t'tref',\n\t'tspan',\n\t'use',\n\t'view',\n\t'vkern',\n]);\nconst MathMLTags = new Set([\n\t'maction',\n\t'math',\n\t'menclose',\n\t'merror',\n\t'mfenced',\n\t'mfrac',\n\t'mglyph',\n\t'mi',\n\t'mlabeledtr',\n\t'mmultiscripts',\n\t'mn',\n\t'mo',\n\t'mover',\n\t'mpadded',\n\t'mphantom',\n\t'mroot',\n\t'mrow',\n\t'ms',\n\t'mspace',\n\t'msqrt',\n\t'mstyle',\n\t'msub',\n\t'msubsup',\n\t'msup',\n\t'mtable',\n\t'mtd',\n\t'mtext',\n\t'mtr',\n\t'munder',\n\t'munderover',\n\t'semantics',\n])\nexport default function createElement(tagname: string, namespace?: string) {\n\tconst res = /^([a-z][a-z0-9-]*):([a-z0-9-]+)$/i.exec(tagname);\n\tconst tag = res ? res[2] : tagname;\n\tconst ns = (namespace || res?.[1]\n\t\t|| SVGTags.has(tag.toLowerCase()) && 'svg'\n\t\t|| MathMLTags.has(tag.toLowerCase()) && 'mathml' || '').toLowerCase();\n\tif (!ns) {\n\t\treturn document.createElement(tag);\n\t}\n\treturn document.createElementNS(\n\t\tns in xmlnsMap && xmlnsMap[ns] || ns,\n\t\ttag,\n\t);\n}","import {\n\tIRender,\n\tNativeNode,\n\tNativeText,\n\tNativePlaceholder,\n\tNativeComponent,\n\tNativeShadow,\n\tNativeContainer,\n\tNativeElement,\n} from '@neep/core';\nimport update from './update';\nimport nextFrame from './nextFrame';\nimport createElement from './createElement';\n\nconst render: IRender = {\n\ttype: 'web',\n\tnextFrame,\n\tisNode(v): v is NativeNode {\n\t\treturn v instanceof Node;\n\t},\n\tmount({target, class: className, style, tag}, isValue, parent) {\n\t\tif (!(\n\t\t\ttypeof tag === 'string' &&\n\t\t\t/^[a-z][a-z0-9]*(?:\\-[a-z0-9]+)?(?:\\:[a-z0-9]+(?:\\-[a-z0-9]+)?)?$/i.test(tag)\n\t\t)) {\n\t\t\ttag = 'div';\n\t\t}\n\t\tconst container = render.create(tag, { class: className, style }, isValue);\n\t\tif (typeof target === 'string') {\n\t\t\ttarget = document.querySelector(target);\n\t\t}\n\t\tif (target instanceof Element) {\n\t\t\ttarget.appendChild(container as any);\n\t\t\tif (parent) {\n\t\t\t\treturn [container, parent.placeholder] as any;\n\t\t\t}\n\t\t\treturn [container, container];\n\t\t}\n\t\tif (parent !== render) {\n\t\t\tdocument.body.appendChild(container as any);\n\t\t\treturn [container, container] as any;\n\t\t}\n\t\treturn [container, container] as any;\n\t},\n\tunmount(container, node, removed) {\n\t\tif (container === node && removed) { return; }\n\t\t(container as any as Element).remove();\n\t},\n\tdrawContainer(container, node, {target, class: className, style, tag}, isValue, parent) {\n\t\trender.update(container as NativeElement, { class: className, style }, isValue)\n\t\tif (typeof target === 'string') {\n\t\t\ttarget = document.querySelector(target);\n\t\t}\n\t\tif (parent !== render && !(target instanceof Element)) {\n\t\t\ttarget = document.body;\n\t\t}\n\t\tconst oldTarget = parent === render && container === node ? undefined : render.parent(node);\n\t\tif (oldTarget === target) {\n\t\t\treturn [container, node];\n\t\t}\n\t\tif (parent !== render) {\n\t\t\ttarget.appendChild(container);\n\t\t\treturn [container, node];\n\t\t}\n\t\tif (!oldTarget) {\n\t\t\tconst newNode = parent.placeholder();\n\t\t\tconst pNode = parent.parent(node);\n\t\t\tif (pNode) {\n\t\t\t\trender.insert(pNode, newNode as any, node);\n\t\t\t\trender.remove(node);\n\t\t\t}\n\t\t\treturn [container, newNode];\n\t\t}\n\t\tif (!target) {\n\t\t\tconst pNode = parent.parent(node);\n\t\t\tif (pNode) {\n\t\t\t\trender.insert(pNode, container, node);\n\t\t\t\trender.remove(node);\n\t\t\t}\n\t\t\treturn [container, container];\n\n\t\t}\n\t\ttarget.appendChild(node);\n\t\treturn [container, node];\n\t},\n\tdraw() {},\n\n\tcreate(tag, props, isValue) {\n\t\treturn update(createElement(tag), props, isValue) as any;\n\t},\n\ttext(text: string): NativeText {\n\t\treturn document.createTextNode(text) as any;\n\t},\n\tplaceholder(): NativePlaceholder {\n\t\treturn document.createComment('') as any;\n\t},\n\tcomponent(): [NativeComponent, NativeShadow] {\n\t\tconst node = createElement('neep-component');\n\t\treturn [node, node.attachShadow({ mode: 'open' })] as any;\n\t},\n\n\tparent(node: NativeNode): NativeContainer | null {\n\t\treturn (node as any).parentNode as NativeContainer | null;\n\t},\n\tnext(node: NativeNode): NativeNode | null {\n\t\treturn (node as any).nextSibling as NativeContainer | null;\n\t},\n\tupdate(node, props, isValue): void {\n\t\tupdate(node as any, props, isValue);\n\t},\n\tinsert(\n\t\tparent: NativeContainer,\n\t\tnode: NativeNode,\n\t\tnext: NativeNode | null = null,\n\t): void {\n\t\t(parent as any).insertBefore(node, next);\n\t},\n\tremove(node: NativeNode): void {\n\t\tconst p = render.parent(node);\n\t\tif (!p) { return; }\n\t\t(p as any).removeChild(node);\n\t},\n};\n\nexport default render;\n"],"names":["recursive2iterable","list","Array","isArray","it","getElementModel","el","HTMLInputElement","type","toLowerCase","e","currentTarget","checked","value","HTMLSelectElement","setAttrs","attrs","getId","v","String","undefined","getClass","set","Set","k","split","filter","Boolean","add","size","getStyle","style","css","Object","create","key","substr","replace","stringify","data","isOn","Date","toISOString","RegExp","toString","JSON","getAttrs","props","hasStyle","isValue","test","name","getEvent","modelInfo","evt","addEvt","f","prop","t","updateClass","classes","oClasses","getAttribute","classList","forEach","c","delete","setAttribute","join","removeAttribute","updateStyle","oStyle","cssText","keys","removeProperty","setProperty","updateAttrs","oAttrs","updateEvent","oEvt","oSet","has","addEventListener","removeEventListener","PropsMap","WeakMap","update","CSSStyleDeclaration","old","get","event","id","className","nextFrame","push","window","requestAnimationFrame","fs","xmlnsMap","svg","html","mathml","SVGTags","MathMLTags","createElement","tagname","namespace","res","exec","tag","ns","document","createElementNS","render","isNode","Node","mount","target","class","parent","container","querySelector","Element","appendChild","placeholder","body","unmount","node","removed","remove","drawContainer","oldTarget","newNode","pNode","insert","draw","text","createTextNode","createComment","component","attachShadow","mode","parentNode","next","nextSibling","insertBefore","p","removeChild"],"mappings":"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"}