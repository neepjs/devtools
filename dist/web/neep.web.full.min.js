/*!
 * neep v0.1.0-alpha.1
 * (c) 2019-2020 Fierflame
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Neep={})}(this,(function(e){"use strict";const t="production";var n=Object.freeze({__proto__:null,version:"0.1.0-alpha.1",mode:t,isProduction:!0});let r;const o=Object.create(null);function i(e=""){return"object"==typeof e?e:o[e]||o.default}function s(e){e.monitorable&&(r=e.monitorable),function({render:e,renders:t}){if(e&&(o[e.type]=e,o.default||(o.default=e)),Array.isArray(t)){for(const e of t)o[e.type]=e;if(!o.default){const[e]=t;e&&(o.default=e)}}}(e)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class l extends Error{constructor(e,t=""){super(t?`[${t}] ${e}`:e),c(this,"tag",void 0),this.tag=t}}const a="Neep:ScopeSlot",u="Neep:SlotRender",f="Neep:Slot",d="Neep:Value",h="Neep:Container",p="Neep:Deliver",y="template",m=y;var g=Object.freeze({__proto__:null,ScopeSlot:a,SlotRender:u,Slot:f,Value:d,Container:h,Deliver:p,Template:y,Fragment:m});function v(...e){return r.value(...e)}function _(...e){return r.computed(...e)}function b(...e){return r.isValue(...e)}function w(...e){return r.encase(...e)}function R(...e){return r.recover(...e)}var x=Object.freeze({__proto__:null,value:v,computed:_,isValue:b,encase:w,recover:R});function A(t,n){const r=e.current;e.current=n;try{e.current.$_valueIndex=0;const n=t();if(e.current.$_valueIndex!==e.current.$_values.length)throw new l("Inconsistent number of useValue executions","life");return n}finally{e.current=r}}function k(t,n=!1){if(!e.current)throw new l(`Function \`${t}\` can only be called within a cycle.`,"life");if(!n)return e.current;if(!e.current.created)return e.current;throw new l(`Function \`${t}\` can only be called at initialization time.`,"life")}const S=[];function C(e,t){for(const n of S)n(e,t);return e}const O=Object.create(null);function j(e,t,n){let o=(null==n?void 0:n.$_hooks)||O;if(!o)return()=>{};t=r.safeify(t);let i=o[e];return i||(i=new Set,o[e]=i),i.add(t),()=>i.delete(t)}function P(e,t){if(t){for(const n of t.$_hooks[e]||[])n(t);for(const n of O[e]||[])n(t)}}function $(e,t){const n=k("watch");if("function"!=typeof e)return()=>{};const o=b(e)?e.watch(t):r.computed(e).watch((e,n)=>t(e(),n));return j("beforeDestroy",()=>o(),n),o}function D(e,t="useValue"){const n=k(t),r=n.$_valueIndex++,o=n.$_values;if(!n.created)return o[r]=void 0,o[r]=e();if(r>=o.length)throw new l("Inconsistent number of useValue executions","life");return o[r]}function N(e,t,n){const r=k("setHook");if(!n||!r.created)return j(e,()=>t(),r)}function E(e,t,n,r){"string"==typeof t&&["$","_"].includes(t[0])||(b(n)&&r?Reflect.defineProperty(e,t,{get:()=>n(),set(e){n(e)},configurable:!0,enumerable:!0}):"function"==typeof n&&r?Reflect.defineProperty(e,t,{get:n,set:"function"==typeof r?r:void 0,configurable:!0,enumerable:!0}):Reflect.defineProperty(e,t,{get:()=>n,configurable:!0,enumerable:!0}))}function z(e,t,n){E(k("expose",!0).exposed,e,t,n)}function H(e,t,n){E(k("deliver",!0).delivered,e,t,n)}var M=Object.freeze({__proto__:null,watch:$,useValue:D,hook:N,setValue:E,expose:z,deliver:H});const I=Symbol.for("isNeepElement"),L=Symbol.for("type"),V=Symbol.for("name"),B=Symbol.for("render");function T(e){return!!e&&("object"==typeof e&&!0===e[I])}function F(e,t,...n){t=t?{...t}:{};const r={[I]:!0,tag:e,children:[]};if("key"in t&&(r.key=t.key),"slot"in t&&(r.slot=t.slot),"function"==typeof t.ref&&(r.ref=t.ref),e===d)return r.value=t.value,r;if(r.children=n,e===y)return r;if(e===u)return r.render=t.render,r;if(e===a||e===f){const{render:n,argv:o,args:i,name:s}=t;if(r.render=n,r.args=o&&[o]||Array.isArray(i)&&i.length&&i||[{}],e===a)return r.props={name:s},r}r.on={},r.props={};for(let e in t){const n=/^(::|@|on:)([a-zA-Z0-9].*)$/.exec(e);n?r.on[n[2]]=t[e]:/^n([:-])([a-zA-Z0-9]+(?:\.[a-zA-Z0-9]+)*)$/i.exec(e)||(r.props[e]=t[e])}return r}function K(e,t={}){if(Array.isArray(e)){const n=[];for(let r of e)n.push(K(r,t));return[].concat(...n)}if(!T(e))return[e];let{tag:n}=e;if(!n)return[];if([y,a].includes(n))return K(e.children,t);if("function"!=typeof n)return[e];if("simple"!==n[L])return[e];const{simple:r}=t;if(!r)return[e];if(Array.isArray(r)){if(r.includes(n))return[e]}else if("function"==typeof r&&!r(n))return[e];return K(e.children,t)}var G=Object.freeze({__proto__:null,isElement:T,createElement:F,elements:K});function q(e,t=""){}var Z=Object.freeze({__proto__:null,label:q});const U={...g,...x,...M,...G,...Z,...n};function W(e,t){return{...e,id:0}}function*J(e){if(Array.isArray(e))for(const t of e)yield*J(t);else yield e}function Q(e){if(Array.isArray(e))return Q(e[e.length-1]);const{component:t,children:n,node:r}=e;return r||Q(t?t.tree:n)}function X(e){if(Array.isArray(e))return X(e[0]);const{component:t,children:n,node:r}=e;return r||X(t?t.tree:n[0])}function*Y(e){if(Array.isArray(e)){for(const t of e)yield*Y(t);return}const{children:t,node:n,component:r}=e;n?yield n:r?yield*Y(r.tree):yield*Y(t)}function ee(e,t){if(Array.isArray(t))return void t.forEach(t=>ee(e,t));const{component:n,children:r,node:o,ref:i}=t;return o?(i&&i(o,!0),void e.remove(o)):n?(i&&i(n.exposed,!0),void n.unmount()):void ee(e,r)}function te(e,t,n){const r=X(n);if(!r)return t;const o=e.parent(r);if(!o)return t;for(const n of Y(t))e.insert(o,n,r);return ee(e,n),t}function ne(e,t,n){if(!t.length){return[te(e,le(e,{tag:null,children:[]}),n)]}Array.isArray(n)||(n=[n]);const r=[],o=[...n],i=new Map;for(const n of t){const t=o.findIndex(e=>e.tag===n.tag&&e.key===n.key);if(t>=0){const s=o[t],c=oe(e,n,s);i.set(s,c),r.push(c),o.splice(t,1)}else{const t=le(e,n);r.push(t)}}if(!i.size)return te(e,r,o);ee(e,o);const s=Q((n=n.filter(e=>i.has(e)))[n.length-1]),c=e.parent(s);if(!c)return r;let l=e.next(s);for(let t=r.length-1;t>=0;t--){const o=r[t],s=n.findIndex(e=>i.get(e)===o);if(s>=0)for(const e of n.splice(s))i.delete(e);else for(const t of Y(o))e.insert(c,t,l);l=X(o)||l}return r}function re(e,t,n){let r=0,o=Math.min(t.length,t.length||1);const i=[];for(;r<o;r++){const o=t[r];Array.isArray(o)?i.push(ne(e,o,n[r])):i.push(oe(e,o,n[r]))}if(o=Math.max(t.length,n.length),n.length>o)for(;r<o;r++)ee(e,n[r]);if(t.length>o){const n=Q(i[i.length-1]),s=e.parent(n),c=e.next(n);for(;r<o;r++){const n=t[r],o=Array.isArray(n)?ce(e,n):le(e,n);if(i.push(o),s)for(const t of Y(o))e.insert(s,t,c)}}return i}function oe(e,t,n){if(Array.isArray(n)){const r=n.findIndex(e=>e.tag===t.tag&&e.component===t.component);if(r<0)return te(e,le(e,t),n);const o=n;[n]=n.splice(r,1),ee(e,o)}const{tag:r,component:o}=t,i=t.ref!==n.ref&&t.ref;if(r!==n.tag||o!==n.component)return te(e,le(e,t),n);if(!r)return n;if("string"!=typeof r||r===h)return o?(i&&i(o.exposed),W({...t,node:void 0,component:o,children:[]},n.id)):W({...t,node:void 0,component:void 0,children:ae(e,t.children,n.children)},n.id);if(r===d)return n.value===t.value?(i&&n.node&&i(n.node),W({...n,...t,children:[]},n.id)):te(e,ie(e,t),n);if(r===y||"Neep:"===r.substr(0,5))return W({...t,node:void 0,component:void 0,children:re(e,t.children,n.children)},n.id);const{node:s}=n;if(e.update(s,t.props||{}),i&&i(s),!t.children.length&&!n.children.length)return W({...n,...t,children:[]},n.id);if(!t.children.length&&n.children.length&&ee(e,n.children),t.children.length&&!n.children.length){const r=se(e,t.children);for(const t of Y(r))e.insert(s,t);return W({...n,...t,children:r},n.id)}return W({...n,...t,children:re(e,t.children,n.children)},n.id)}function ie(e,t){const{value:n,ref:r}=t;if(e.isNode(t.value))return r&&r(n),W({...t,node:n,children:[],component:void 0});const o=typeof n;let i;return"bigint"===o||"boolean"===o||"number"===o||"string"===o||"symbol"===o||n instanceof RegExp?i=e.text(String(n)):n instanceof Date?i=e.text(n.toISOString()):"object"===o&&n&&(i=e.text(String(n))),i||(i=e.placeholder()),r&&r(i),W({...t,node:i,component:void 0,children:[]})}function se(e,t){return t.length?t.map(t=>Array.isArray(t)?ce(e,t):le(e,t)):[W({tag:null,node:e.placeholder(),component:void 0,children:[]})]}function ce(e,t){return t.length?t.map(t=>le(e,t)):[W({tag:null,node:e.placeholder(),component:void 0,children:[]})]}function le(e,t){const{tag:n,ref:r,component:o}=t;if(!n){const t=e.placeholder();return r&&r(t),W({tag:null,node:t,component:void 0,children:[]})}if("string"!=typeof n||n===h)return o?(o.mount(),r&&r(o.exposed),W({...t,node:void 0,component:o,children:[]})):W({...t,node:void 0,component:void 0,children:ae(e,t.children)});if(n===d)return ie(e,t);if(n===y||"Neep:"===n.substr(0,5))return W({...t,node:void 0,component:void 0,children:se(e,t.children)});const i=e.create(n,t.props||{});r&&r(i);let s=[];if(t.children){s=se(e,t.children);for(const t of Y(s))e.insert(i,t)}return W({...t,node:i,component:void 0,children:s})}function ae(e,t,n){return n?re(e,t,n):se(e,t)}function ue(e,t,n,r=!1){const o=[];for(const i of t){if(Array.isArray(i)){const t=Object.create(null);o.push(ue(e,i,t,r));for(const e of Reflect.ownKeys(t))e in n?n[e].push(t[e]):n[e]=[t[e]];continue}if(r){if(e.isNode(i)){o.push(i);continue}if(!T(i)){o.push(i);continue}if(i.tag!==u){o.push(i);continue}}const t=T(i)&&i.slot||"default",s=T(i)?{...i,slot:void 0,props:{...i.props,slot:void 0}}:i;t in n?n[t].push(s):n[t]=[s]}return o}function fe(e,...t){return e.map(e=>Array.isArray(e)?fe(e,...t):T(e)?e.tag!==u?{...e,slot:void 0}:"function"==typeof e.render?e.render(...t):e.children:e)}function de(e,t){const n=(...e)=>({[I]:!0,tag:a,children:fe(t,...e),inserted:!0,label:void 0});return n.children=t,n}function he(e,t=Object.create(null)){for(const n of Reflect.ownKeys(t))n in e||delete t[n];for(const n of Reflect.ownKeys(e))t[n]=de(0,e[n]);return t}function pe(e,t,n={},r=!1){const o=new Set(Reflect.ownKeys(t));for(const t of Reflect.ownKeys(e))o.has(t)||delete e[t];if(!r){for(const n of o)e[n]=t[n];return e}for(const r of o){const o=t[r];r in n&&n[r]===o||(b(o)?Reflect.defineProperty(e,r,{configurable:!0,enumerable:!0,get:()=>o(),set(e){o(e)}}):Reflect.defineProperty(e,r,{configurable:!0,enumerable:!0,value:o}))}return e}function ye(e,t,n,r,o=!1){if(Array.isArray(n))return n.map(n=>ye(e,t,n,r,o));if(!T(n))return n;let{tag:i,inserted:s,args:c=[{}]}=n;if(i===p){const s={...n.props};delete s.ref,delete s.slot,delete s.key;const c=Object.create(t);return pe(c,s||{},{},!0),{...n,tag:i,$__neep__delivered:c,children:n.children.map(t=>ye(e,c,t,r,o))}}const l=n.children.map(n=>ye(e,t,n,r,o));return"function"==typeof i?"simple"===i[L]?function(e,t,n,r,o){const{iRender:i}=e.container,s=Object.create(null);ue(i,o,s);const c=he(s),l=C({slots:c,created:!1,parent:e.exposed,delivered:t,children:new Set,childNodes:o,refresh(t){e.refresh(t)}}),a=r({...n.props},l,U),u=ye(e,t,me(i,a,l,r[B]),c);return{...n,children:Array.isArray(u)?u:[u],label:void 0}}(e,t,n,i,l):{...n,$__neep__delivered:t,children:l,tag:i}:(i===f&&(i=o?"slot":a),i!==a||s?{...n,children:l,tag:i}:function(e,t,n,r=[{}]){var o;const i=t[(null===(o=e.props)||void 0===o?void 0:o.name)||"default"];if("function"==typeof i)return{...e,...i(...r)};const{render:s}=e;return{...e,tag:a,label:void 0,children:"function"!=typeof s?n:s(...r)}}(n,r,l,c))}function me(e,t,n,r){return Array.isArray(t)?t:T(t)?[t]:null==t?[{[I]:!0,tag:null,children:[]}]:(!e.isNode(t)&&"object"==typeof t&&r&&(t=r(t,n,U)),T(t)?[t]:null==t?[{[I]:!0,tag:null,children:[]}]:[{[I]:!0,tag:d,value:t,children:[]}])}function ge(e,t){return ye(e,e.delivered,me(e.iRender,t,e.context,e.component[B]),e.context.slots,Boolean(e.native))}class ve{constructor(e,t,n=(null==t?void 0:t.delivered)||Object.create(null),r){c(this,"iRender",void 0),c(this,"parentDelivered",void 0),c(this,"delivered",void 0),c(this,"exposed",function(e){const t={$parent:{configurable:!0,get:()=>{var t;return null===(t=e.parent)||void 0===t?void 0:t.exposed}},$component:{configurable:!0,value:null},$isContainer:{configurable:!0,value:!1},$created:{configurable:!0,get:()=>e.created},$destroyed:{configurable:!0,get:()=>e.destroyed},$mounted:{configurable:!0,get:()=>e.mounted},$unmounted:{configurable:!0,get:()=>e.unmounted}};return Object.create(null,t)}(this)),c(this,"entity",function(e){const t={exposed:{configurable:!0,get:()=>e.exposed},delivered:{configurable:!0,get:()=>e.delivered},parent:{configurable:!0,get:()=>{var t;return null===(t=e.parent)||void 0===t?void 0:t.entity}},component:{configurable:!0,value:null},isContainer:{configurable:!0,value:!1},created:{configurable:!0,get:()=>e.created},destroyed:{configurable:!0,get:()=>e.destroyed},mounted:{configurable:!0,get:()=>e.mounted},unmounted:{configurable:!0,get:()=>e.unmounted},$_hooks:{configurable:!0,value:Object.create(null)},$_valueIndex:{configurable:!0,value:0,writable:!0},$_values:{configurable:!0,value:[]},callHook:{configurable:!0,value(e){P(e,n)}},setHook:{configurable:!0,value:(e,t)=>j(e,t,n)},refresh:{configurable:!0,value(t){e.refresh(t)}}},n=Object.create(null,t);return n}(this)),c(this,"parent",void 0),c(this,"native",null),c(this,"created",!1),c(this,"destroyed",!1),c(this,"mounted",!1),c(this,"unmounted",!1),c(this,"children",new Set),c(this,"tree",[]),c(this,"container",void 0),c(this,"_render",()=>[]),c(this,"_needRefresh",!1),c(this,"_delayedRefresh",0),c(this,"_refreshing",!1),c(this,"_nodes",[]),c(this,"childNodes",[]),c(this,"__executed_destroy",!1),c(this,"__executed_mount",!1),c(this,"__executed_mounted",!1),this.iRender=e,this.parentDelivered=n,this.delivered=Object.create(n),t&&(this.parent=t),this.container=r||this}get canRefresh(){return!this._delayedRefresh}get needRefresh(){if(this._delayedRefresh)return!1;const e=this._needRefresh;return this._needRefresh=!1,e}_refresh(){}refresh(e){if("function"==typeof e){try{this._delayedRefresh++,e()}finally{this._delayedRefresh--,this._delayedRefresh<=0&&this.refresh()}return}if(this.destroyed)return;if(!this.created)return;if(this._needRefresh=!0,this._refreshing)return;let t;for(this._refreshing=!0;this.needRefresh;)if(t=this._render(),this.destroyed)return;this._refreshing=!1,this.canRefresh&&t&&(this._nodes=Ce(this,t,this._nodes),this.mounted&&(this.destroyed||this.unmounted||this._refresh()))}callHook(e){P(e,this.entity)}_update(e,t){this.childNodes=t}update(e,t){this._update(e,t)}_destroy(){}destroy(){this.__executed_destroy||(this.__executed_destroy=!0,this.callHook("beforeDestroy"),this._destroy(),this.callHook("destroyed"),this.destroyed=!0)}_mount(){}mount(){this.__executed_destroy||this.__executed_mount||(this.__executed_mount=!0,this.callHook("beforeMount"),this._mount(),this.callHook("mounted"),this.mounted=!0)}_unmount(){}unmount(){this.mounted&&(this.__executed_mounted||(this.__executed_mounted=!0,this.callHook("beforeUnmount"),this._unmount(),this.callHook("unmounted"),this.unmounted=!0))}_draw(){}draw(){this.__executed_destroy||(this.callHook("beforeUpdate"),this._draw(),this.callHook("updated"))}}function _e(e,t,n){pe(e.props,t);const r=Object.create(null),{native:o,container:{iRender:i}}=e,s=ue(i,n,r,Boolean(o));he(r,e.slots),o&&(e.nativeNodes=Ce(e,s,e.nativeNodes))}class be extends ve{constructor(e,t,n,o,i){super(o.iRender,o,i,o.container),c(this,"component",void 0),c(this,"props",r.encase(Object.create(null))),c(this,"slots",r.encase(Object.create(null))),c(this,"_stopRender",void 0),c(this,"nativeNodes",void 0),c(this,"nativeTree",[]),c(this,"context",void 0),c(this,"parent",void 0),this.component=e,Reflect.defineProperty(this.exposed,"$component",{value:e,enumerable:!0,configurable:!0}),this.parent=o,o.children.add(this.exposed);const s=C({slots:(l=this).slots,get created(){return l.created},get parent(){return l.parent.exposed},get delivered(){return l.parentDelivered},get children(){return l.children},get childNodes(){return l.childNodes},refresh(e){l.refresh(e)}},l.exposed);var l;this.context=s,this.callHook("beforeCreate"),this.childNodes=n,_e(this,t,n);const{render:a,nodes:u,stopRender:f}=function(e){const{component:t,props:n,context:o,entity:i}=e,s=t=>t&&e.refresh(),c=r.exec(()=>A(()=>t(n,o,U),i),s,!0);if("function"==typeof c){const t=r.createExecutable(()=>ge(e,c()),s);return{nodes:t(),render:t,stopRender:()=>t.stop()}}const l=r.createExecutable(()=>ge(e,A(()=>t(n,o,U),i)),s);return{nodes:r.exec(()=>ge(e,c),s,!0),render:l,stopRender:()=>l.stop()}}(this);this._render=a,this._stopRender=f,this._nodes=Ce(this,u),this.callHook("created"),this.created=!0,this._needRefresh&&this.refresh()}_update(e,t){this.destroyed||(this.childNodes=t,_e(this,e,t))}_destroy(){this._stopRender&&this._stopRender(),this.parent.children.delete(this.exposed),Re(this._nodes)}_refresh(){this.container.markDraw(this)}_draw(){this.tree=ae(this.container.iRender,this._nodes,this.tree)}_mount(){this.tree=ae(this.container.iRender,this._nodes)}_unmount(){ee(this.container.iRender,this.tree)}}function we(e){return!1===e||null==e?null:T(e)?e:{[I]:!0,tag:d,key:e,value:e,children:[]}}function Re(e){if(Array.isArray(e))return void e.forEach(e=>Re(e));const{component:t}=e;t&&t.destroy()}function xe(e,t){if(!t)return{tag:null,children:[]};const{tag:n}=t;if(!n)return{tag:null,children:[]};if("string"!=typeof n)return"simple"===n[L]?{...t,children:Ce(e,t.children),component:void 0}:{...t,children:[],component:new be(n,t.props||{},t.children,e,t.$__neep__delivered)};if(n===h){var r;const n=null==t||null===(r=t.props)||void 0===r?void 0:r.type,o=n?i(n):e.iRender;return{...t,children:[],component:new Pe(o,t.props||{},t.children,e,t.$__neep__delivered)}}return n===d?{...t,children:[]}:(n===y||n.substr(0,5),{...t,children:Ce(e,t.children)})}function Ae(e,t,n){Array.isArray(n)||(n=[n]);const r=[];for(const o of J(t)){const t=we(o);if(!t)continue;const i=n.findIndex(e=>e.tag===t.tag&&e.key===t.key);i>=0?(r.push(ke(e,t,n[i])),n.splice(i,1)):r.push(xe(e,t))}return Re(n),r}function ke(e,t,n){if(!n)return xe(e,t);if(!t)return Re(n),{tag:null,children:[]};if(Array.isArray(n)){if(!n.length)return xe(e,t);const r=n.findIndex(e=>e.tag===t.tag);if(r<0)return Re(n),xe(e,t);const o=n;[n]=n.splice(r,1),Re(o)}const{tag:r}=t;if(r!==n.tag)return Re(n),xe(e,t);if(!r)return{tag:null,children:[]};if("string"!=typeof r){if("simple"===r[L])return{...t,children:Ce(e,t.children,n.children),component:void 0};const{component:o}=n;return o?(o.update(t.props||{},t.children),{...t,children:[],component:o}):xe(e,t)}if(r===h){var o;const{component:r}=n;if(!r)return xe(e,t);const s=null==t||null===(o=t.props)||void 0===o?void 0:o.type;return(s?i(s):e.iRender)!==r.iRender?xe(e,t):(r.update(t.props||{},t.children),{...t,children:[],component:r})}if(r===d)return{...t,children:[]};if(r===y||"Neep:"===r.substr(0,5)){let o;if(p===r){const e={...t.props};delete e.ref,delete e.slot,delete e.key,o=pe(n.$__neep__delivered,e,n.props,!0)}return{...t,$__neep__delivered:o,children:Ce(e,t.children,n.children)}}return{...t,children:Ce(e,t.children,n.children)}}function*Se(e,t,n){let r=0,o=Math.min(t.length,t.length);for(;r<o;r++){const o=t[r];Array.isArray(o)?yield Ae(e,o,n[r]):yield ke(e,we(o),n[r])}if(o=Math.max(t.length,t.length),n.length>o)for(;r<o;r++)Re(n[r]);if(t.length>o)for(;r<o;r++){const n=t[r];Array.isArray(n)?yield[...J(n)].map(t=>xe(e,t)):yield xe(e,n)}}function Ce(e,t,n){return Array.isArray(t)||(t=[]),n?[...Se(e,t,n)]:function(e,t){return t.length?t.map(t=>Array.isArray(t)?[...J(t)].map(t=>xe(e,we(t))):xe(e,we(t))):[]}(e,t)}let Oe=new Set,je=!1;class Pe extends ve{constructor(e,t,n,r,o){super(e,r,o),c(this,"props",void 0),c(this,"content",[]),c(this,"_node",null),c(this,"_container",null),c(this,"rootContainer",this),c(this,"_drawChildren",!1),c(this,"_drawContainer",!1),c(this,"_awaitDraw",new Set),c(this,"_needDraw",!1),c(this,"_containers",new Set),this.props=t,this.parent=r,r&&(this.rootContainer=r.container.rootContainer),this.callHook("beforeCreate"),this._render=()=>n,this._nodes=Ce(this,n),this.callHook("created"),this.created=!0}setChildren(e){this.destroyed||(this.childNodes=e,this._render=()=>e,this._drawChildren=!0,this.refresh())}setProps(e){this.destroyed||(this.props=e,this._drawContainer=!0,this.refresh())}update(e,t){this.refresh(()=>{this.setProps(e),this.setChildren(t)})}_refresh(){this.markDraw(this)}_mount(){const{props:e,parent:t,iRender:n}=this,r=ae(this.container.iRender,this._nodes);this.content=r;const[o,i]=n.mount(e,null==t?void 0:t.iRender);for(const e of Y(r))n.insert(o,e);this.tree=[W({tag:d,component:void 0,node:i,value:i,children:[]})],this._node=i,this._container=o}_destroy(){Re(this.content)}_unmount(){const{parent:e,iRender:t}=this;e&&ee(e.iRender,this.tree),t.unmount(this._container,this._node,Boolean(e)),ee(this.iRender,this.content)}_draw(){}drawSelf(){if(!this.mounted)return;if(this.destroyed)return;const{_drawChildren:e,_drawContainer:t}=this;var n;(this._needDraw=!1,this._drawChildren=!1,this._drawContainer=!1,this.callHook("beforeUpdate"),t)&&this.iRender.drawContainer(this._container,this._node,this.props,null===(n=this.parent)||void 0===n?void 0:n.iRender);e&&(this.content=ae(this.iRender,this._nodes,this.content)),this.callHook("updated")}markDraw(e,t=!1){e===this?this._needDraw=!t:t?this._awaitDraw.delete(e):this._awaitDraw.add(e),this.rootContainer.markDrawContainer(this,!this._needDraw&&!this._awaitDraw.size||this.destroyed)}drawContainer(){const{_node:e,_container:t,_awaitDraw:n}=this;if(!e||!t)return;this.callHook("beforeDraw");const r=this._needDraw;this._needDraw=!1;const o=[...n];n.clear(),r&&this.drawSelf(),o.map(e=>e.draw()),this.iRender.draw(t,e),this.callHook("drawn")}markDrawContainer(e,t=!1){var n;t?this._containers.delete(e):this._containers.add(e),n=this,Oe.add(n),je||(je=!0,window.requestAnimationFrame(()=>{je=!1;const e=[...Oe];Oe.clear(),e.map(e=>e.drawAll())}))}drawAll(){const e=this._containers;e.size&&(this.callHook("beforeDrawAll"),[...e].map(e=>e.drawContainer()),this.callHook("drawnAll"))}}function $e(e,t){return n=>(n[e]=t,n)}function De(e){const t=new Set;for(const n of J(e))if(n)if("string"==typeof n)for(let e of n.split(" ").filter(Boolean))t.add(e);else if("object"==typeof n)for(const e in n){const r=n[e];for(let n of e.split(" ").filter(Boolean))t[r?"add":"delete"](n)}if(t.size)return t}function Ne(e){if("string"==typeof e)return e;if(!e)return;if("object"!=typeof e)return;const t=Object.create(null);for(let n in e){let r=e[n];const o="--"===n.substr(0,2)?n:n.replace(/[A-Z]/g,"-$1").replace(/-+/g,"-").toLowerCase();if("number"==typeof r)t[o]=[0===r?"0":`${r}px`,null];else if(r&&"string"==typeof r){const e=r.replace(/\!important\s*$/,"");t[o]=[e,e===r?null:"important"]}}return t}function Ee(e,t=!1){return null==e||t&&"function"==typeof e?null:"boolean"==typeof e?e?"":null:"object"!=typeof e?String(e):e instanceof Date?e.toISOString():e instanceof RegExp?e.toString():JSON.stringify(e)}function ze(e,t){const n=Object.create(null);for(const r in e){const o=r.replace(/([A-Z])/g,"-$1").replace(/(\-)\-+/g,"$1").toLowerCase();switch(o){case"style":if(!t)break;case"is":case"id":case"class":continue}const i=Ee(e[r],"on"===o.substr(0,2));null!==i&&(n[o]=i)}return n}function He(e){const t=Object.create(null);for(const n in e){const r=e[n];"function"==typeof r&&("on"===n.substr(0,2)&&(t[n.substr(2).toLowerCase()]=new Set([r])))}return t}const Me=new WeakMap;function Ie(e,t){const n=e.style,r=n instanceof CSSStyleDeclaration,o=Me.get(e)||{attrs:{},event:{}},{id:i,classes:s,style:c,attrs:l,event:a}=function({id:e,class:t,style:n,...r},o){return{id:(i=e,"string"==typeof i?i:"number"==typeof i?String(i):void 0),classes:De(t),style:o?Ne(n):void 0,attrs:ze(r,o),event:He(r)};var i}(t,r);return Me.set(e,{id:i,classes:s,style:c,attrs:l,event:a}),i!==o.id&&("string"==typeof i?e.id=t.id:e.removeAttribute("id")),function(e,t,n){if(t&&n){const r=e.getAttribute("class")||"",o=new Set(r.split(" ").filter(Boolean));n.forEach(e=>o.delete(e)),t.forEach(e=>o.add(e)),e.setAttribute("class",[...o].join(" "))}else t?e.setAttribute("class",[...t].join(" ")):n&&e.removeAttribute("class")}(e,s,o.classes),r&&function(e,t,n){if(t)if("string"!=typeof t)if(n&&"string"!=typeof n){for(const r of Object.keys(t)){const o=t[r];n[r]&&n[r][0]===o[0]&&n[r][1]===o[1]||e.setProperty(r,...o)}for(const r of Object.keys(n))t[r]||e.removeProperty(r)}else{"string"==typeof n&&(e.cssText="");for(const n of Object.keys(t))e.setProperty(n,...t[n])}else t!==typeof n&&(e.cssText=t);else{if(!n)return;if("string"==typeof n)return void(e.cssText="");for(const t of Object.keys(n))e.removeProperty(t)}}(n,c,o.style),function(e,t,n){for(const r of Object.keys(t)){const o=t[r];r in n&&n[r]===o||e.setAttribute(r,o)}for(const r of Object.keys(n))r in t||e.removeAttribute(r)}(e,l,o.attrs),function(e,t,n){for(const r of Object.keys(t)){const o=t[r];if(r in n){const t=n[r];for(const n of o)t.has(n)||e.addEventListener(r,n);for(const n of t)o.has(n)||e.removeEventListener(r,n)}else for(const t of o)e.addEventListener(r,t)}for(const r of Object.keys(n))if(!(r in t))for(const t of n[r])e.removeEventListener(r,t)}(e,a,o.event),e}const Le={svg:"http://www.w3.org/2000/svg",html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML"},Ve=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"]),Be=new Set(["maction","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msubsup","msup","mtable","mtd","mtext","mtr","munder","munderover","semantics"]);function Te(e,t){const n=/^([a-z][a-z0-9-]*):([a-z0-9-]+)$/i.exec(e),r=n?n[2]:e,o=(t||(null==n?void 0:n[1])||Ve.has(r.toLowerCase())&&"svg"||Be.has(r.toLowerCase())&&"mathml"||"").toLowerCase();return o?document.createElementNS(o in Le&&Le[o]||o,r):document.createElement(r)}const Fe={type:"html",isNode:e=>e instanceof Node,mount({target:e,class:t,style:n,tag:r},o){"string"==typeof r&&/^[a-z][a-z0-9]*(?:\-[a-z0-9]+)?(?:\:[a-z0-9]+(?:\-[a-z0-9]+)?)?$/i.test(r)||(r="div");const i=Fe.create(r,{class:t,style:n});return"string"==typeof e&&(e=document.querySelector(e)),e instanceof Element?(e.appendChild(i),o?[i,o.placeholder]:[i,i]):o!==Fe?(document.body.appendChild(i),[i,i]):[i,i]},unmount(e,t,n){e===t&&n||e.remove()},drawContainer(e,t,{target:n,class:r,style:o,tag:i},s){Fe.update(e,{class:r,style:o}),"string"==typeof n&&(n=document.querySelector(n)),s===Fe||n instanceof Element||(n=document.body);const c=s===Fe&&e===t?void 0:Fe.parent(t);if(c===n)return[e,t];if(s!==Fe)return n.appendChild(e),[e,t];if(!c){const n=s.placeholder(),r=s.parent(t);return r&&(Fe.insert(r,n,t),Fe.remove(t)),[e,n]}if(!n){const n=s.parent(t);return n&&(Fe.insert(n,e,t),Fe.remove(t)),[e,e]}return n.appendChild(t),[e,t]},draw(){},create:(e,t)=>Ie(Te(e),t),text:e=>document.createTextNode(e),placeholder:()=>document.createComment(""),component(){const e=Te("neep-component");return e.attachShadow({mode:"open"}),[e,e.attachShadow({mode:"open"})]},parent:e=>e.parentNode,next:e=>e.nextSibling,update(e,t){Ie(e,t)},insert(e,t,n=null){e.insertBefore(t,n)},remove(e){const t=Fe.parent(e);t&&t.removeChild(e)}};
/*!
	 * monitorable v0.1.0-alpha.3
	 * (c) 2020 Fierflame
	 * @license MIT
	 */let Ke,Ge;function qe(e,t=!1){t||"function"!=typeof e&&void 0!==e?"function"!=typeof Ke?console.error(e):Ke(e):Ke=e}function Ze(e){return Boolean(e&&["object","function"].includes(typeof e))}function Ue(e){return(...t)=>{try{e(...t)}catch(e){qe(e,!0)}}}function We(e,t,n){if(e.has(t))return e.get(t);const r=n();return e.set(t,r),r}function Je(e,t){if(!Ge)return;const n=We(Ge,e,()=>new Set);"number"==typeof t&&(t=String(t)),n.add(t)}function Qe(e,t){const n=Ge;Ge=t;try{return e()}finally{Ge=n}}const Xe=new WeakMap;function Ye(e,t){var n,r;if(!e)return;if(!Ze(e))return;if("number"==typeof t)t=String(t);else if("symbol"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t)return;const o=null===(n=Xe.get(e))||void 0===n||null===(r=n.get)||void 0===r?void 0:r.call(n,t);if(o)for(const e of[...o])e()}function et(e,t,n){if(!e)return()=>{};if("object"!=typeof e&&"function"!=typeof e)return()=>{};if("function"!=typeof n)return()=>{};if("number"==typeof t&&(t=String(t)),"symbol"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t)return()=>{};const r=t;let o=Xe.get(e);o||(o=new Map,Xe.set(e,o));const i=We(o,r,()=>new Set);n=Ue(n),i.add(n);let s=!1;return()=>{s||(s=!0,i.delete(n),i.size||o&&(o.delete(r),o.size||Xe.delete(e)))}}function tt(e){return Boolean(e&&["object","function"].includes(typeof e))}let nt;function rt(e,t=0){if(!tt(e))return e;const n=ot(e),r=!0===t?1/0:t||0,o=new Proxy(n,{set(e,n,r,o){if(!1===t)return Reflect.set(e,n,r,o);const i=Reflect.has(e,n),s=Reflect.set(e,n,r,rt(o));return s?(i!==Reflect.has(e,n)&&Ye(e,!0),s):s},get(e,i,s){if(nt===o&&"__monitorable__recover__"===i)return void(nt=n);if(!1===t)return Reflect.get(e,i,s);Je(e,i);const c=Reflect.get(e,i,rt(s));return r>0?rt(c,r-1):c},setPrototypeOf(e,n){if(!1===t)return Reflect.setPrototypeOf(e,n);const r=Reflect.getPrototypeOf(e),o=Reflect.setPrototypeOf(e,n);return o&&r!==n&&Ye(e,!1),o},getPrototypeOf(e){if(!1===t)return Reflect.getPrototypeOf(e);Je(e,!1);const n=Reflect.getPrototypeOf(e);return r>0?rt(n,r-1):n},defineProperty(e,n,r){if(!1===t)return Reflect.defineProperty(e,n,r);let o=!0;if("value"in r){const t=Reflect.getOwnPropertyDescriptor(e,n);t&&"value"in t&&ot(r.value)===ot(t.value)&&(o=!1)}const i=Reflect.defineProperty(e,n,r);return o&&i&&Ye(e,n),i},getOwnPropertyDescriptor:(e,n)=>(!1===t||Je(e,n),Reflect.getOwnPropertyDescriptor(e,n)),deleteProperty(e,n){if(!1===t)return Reflect.deleteProperty(e,n);const r=Reflect.has(e,n),o=Reflect.deleteProperty(e,n);return r&&!Reflect.has(e,n)&&(Ye(e,n),Ye(e,!0)),o},ownKeys:e=>(!1===t||Je(e,!0),Reflect.ownKeys(e)),has:(e,n)=>(!1===t||Je(e,!0),Reflect.has(e,n))});return o}function ot(e){if(!e)return e;if(!tt(e))return e;let t=e;try{nt=e,t=e.__monitorable__recover__}catch(e){}return t=nt,nt=!1,t&&("object"==typeof t||"function"==typeof t)?t:e}function it(e,t){let n;function r(){if(!n)return!1;const e=n;return n=void 0,e.forEach(e=>e()),!0}function o(){r()&&t(!0)}function i(){r();const i=new Map;try{return Qe(e,i)}catch(e){throw i.clear(),e}finally{if(i.size){n=[];for(let[e,t]of i)for(const r of t)n.push(et(ot(e),r,o))}else t(!1)}}return t=Ue(t),i.stop=()=>{r()&&t(!1)},i}const st=new WeakSet;function ct(e){return st.has(e)}function lt(e,t,n=(()=>{}),r=(()=>{})){function o(e,n=!1){if(t)try{t(e,()=>{n=!0})}finally{n&&a()}}function i(){return Je(s,"value"),e()}const s=(...e)=>e.length?(o(e[0],e[1]),e[0]):i();function c(e){if(!l)return()=>{};e=Ue(e),l.push(e),r();let t=!1;return()=>{if(t)return;if(t=!0,!l)return;const n=l.findIndex(t=>t===e);n<0||(l.splice(n,1),r())}}Reflect.defineProperty(s,"value",{get:i,set:o,enumerable:!0,configurable:!0});let l=[];Reflect.defineProperty(s,"watch",{get:()=>c,set(){},configurable:!0});const a=()=>{if(l){Ye(s,"value");for(const e of[...l])e(s,!1)}};a.has=()=>{var e;return Boolean(null===(e=l)||void 0===e?void 0:e.length)},a.stop=()=>{if(!l)return;const e=l;l=void 0;for(const t of[...e])t(s,!0)},st.add(s);let u=!1;return s.stop=()=>{u||(u=!0,n(),a.stop())},{value:s,trigger:a}}s({render:Fe,monitorable:Object.freeze({__proto__:null,computed:function(e,t,n){"function"!=typeof t&&(n=t,t=void 0);const r=t,o=!0===n||n&&n.proxy;let i,s,c,l=!1,a=!1;const u=it(e,e=>{a=!e,e&&c&&c()});function f(){a=!0;try{return i=u(),o&&(i=ot(i)),s=o?rt(i):i,s}catch(e){throw l||(a=!1),e}}let d;return({value:d,trigger:c}=lt(()=>a||l?s:f(),r&&(e=>r(o?ot(e):e)),()=>{l||(l=!0,a||f())})),d},createExecutable:it,encase:rt,encashable:Ze,equal:function(e,t){return ot(e)===ot(t)},exec:function(e,t,n){let r;function o(){if(!r)return!1;const e=r;return r=void 0,e.forEach(e=>e()),!0}function i(){o()&&t(!0)}t=Ue(t);const s=new Map,c=Qe(e,s);if(!s.size)return t(!1),n?c:{result:c,stop(){}};r=[];for(let[e,t]of s)for(const n of t)r.push(et(ot(e),n,i));return n?c:{result:c,stop(){o()&&t(!1)}}},getMapValue:We,isValue:ct,markChange:Ye,markRead:Je,merge:function(e){let t,n=!1;return(r,o)=>{if(o)return e(r,o);const i=ot(r());i===t&&n||(n=!0,t=i,e(r,o))}},mix:function(e){for(const t of Reflect.ownKeys(e)){const n=Reflect.getOwnPropertyDescriptor(e,t);if(!n)continue;if(!("value"in n)||"get"in n||"set"in n)continue;const r=n.value;ct(r)&&(n.get=()=>r.value,n.writable&&(n.set=e=>r.value=e),delete n.value,delete n.writable,Reflect.defineProperty(e,t,n))}return e},observe:Qe,printError:qe,recover:ot,safeify:Ue,value:function(e,t){const n=!0===t||t&&t.proxy;let r,o;const{value:i}=lt(()=>o,(e,t)=>{n&&(e=ot(e)),e!==r&&(r=e,o=n?rt(r):r,t())});return i(e),i},watchProp:et})}),e.Container=h,e.Deliver=p,e.Error=l,e.Fragment=m,e.ScopeSlot=a,e.Slot=f,e.SlotRender=u,e.Tags=g,e.Template=y,e.Value=d,e.addContextConstructor=function(e){S.push(r.safeify(e))},e.callHook=P,e.checkCurrent=k,e.computed=_,e.create=function(e,t){return"function"==typeof t&&(e[B]=t),e},e.createElement=F,e.defineAuxiliary=function(e,t){Reflect.defineProperty(U,e,{get:t,enumerable:!0,configurable:!0})},e.deliver=H,e.elements=K,e.encase=w,e.expose=z,e.hook=N,e.install=s,e.isElement=T,e.isElementSymbol=I,e.isProduction=!0,e.isValue=b,e.label=q,e.mName=function(e,t){return t?(t[V]=e,t):$e(V,e)},e.mNative=function(e){return e?(e[L]="native",e):$e(L,"native")},e.mRender=function(e,t){return t?(t[B]=e,t):$e(B,e)},e.mSimple=function(e){return e?(e[L]="simple",e):$e(L,"simple")},e.mType=function(e,t){return t?(t[L]=e,t):$e(L,e)},e.mark=function(e,...t){for(const n of t)n(e);return e},e.mode=t,e.nameSymbol=V,e.recover=R,e.render=function(e,t={}){let n={...t};const r=new Pe(i(t.type),n,void 0===e?[]:T(e)?[e]:[F(e)]),{exposed:o}=r;return Reflect.defineProperty(o,"$update",{value:e=>(r.setChildren(void 0===e?[]:T(e)?[e]:[F(e)]),o),configurable:!0}),Reflect.defineProperty(o,"$mount",{value:e=>(o.$mounted||(e&&(n.target=e,r.setProps(n)),r.mount()),o),configurable:!0}),Reflect.defineProperty(o,"$unmount",{value(){if(o.$mounted&&!o.$unmounted)return o.$destroyed?r.destroy():void r.unmount()},configurable:!0}),n.target&&r.mount(),o},e.renderSymbol=B,e.setAuxiliary=function(e,t){Reflect.defineProperty(U,e,{value:t,enumerable:!0,configurable:!0})},e.setHook=j,e.setValue=E,e.typeSymbol=L,e.useValue=D,e.value=v,e.version="0.1.0-alpha.1",e.watch=$,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=neep.web.full.min.js.map
